var infinityDrag={dragSlideLock:!1,dragShadow:document.createElement("div"),dragShadowHide:document.createElement("div"),init:function(){this.ondrag(),this.dragShadow.className="home-drag-shadow",this.dragShadow.id="home-drag-shadow-one",$(this.dragShadow).html('<div class="home-drag-img" id="home-drag-img"></div>'),this.dragShadowHide.className="home-drag-shadow home-drag-shadow-hide",$(this.dragShadowHide).html('<div class="home-drag-img" id="home-drag-img"></div>')},start:{},end:{},setDropPosition:function(e,i,t){function n(){if(o+=1,!e[o]){a=e[o-1][t];return e[o]=[],e[o].unshift(a),e[i].splice(t-1,1),e}if(!(e[o].length>t)){a=e[o-1][t];return e[o].unshift(a),e[i].splice(t,1),e}var a=e[o-1][t];e[o].unshift(a),e[i].splice(t,1),n()}var o=i;return e[i].length<=t?e:n()},ondrag:function(){var self=this;$(document).on("dragstart",".home-icon",function(event){try{_edit.end()}catch(e){}var icons=infinity.get("infinity-icons"),iconsLength=icons.length,startPage=$(event.target).parents(".home-page").index()-1,startPosition=$(event.target).index();self.start={page:startPage,position:startPosition},$(event.target).on("drag",function(e){if($(e.target).before(self.dragShadow),$(self.dragShadow).show(),$(e.target).remove(),0===startPage||startPage===iconsLength-1){if(0===startPage)i=$($(".home-icon-first").children()[self.start.position]);else var i=$($(".home-icon-last").children()[self.start.position]);i.remove()}}),$(".home-drag-hover").css("display","flex"),eval("console.log(event.target)"),event.target.ondragend=function(){var e=$(self.dragShadow).index(),i=$(self.dragShadow).parents(".home-page").index()-1;$(self.dragShadow).before(event.target),$(self.dragShadow).hide(),self.end={page:i,position:e};var t=infinity.setting("row")*infinity.setting("column"),n=infinity.get("infinity-icons"),o=n[self.end.page].length,a=n[self.start.page][self.start.position];if(self.start.page==self.end.page)n[self.start.page].splice(self.start.position,1),n[self.end.page].splice(self.end.position,0,a);else if(o>=t);else{n[self.end.page].splice(self.end.position,0,a),self.setDropPosition(n,self.end.page,t);var s=n[self.start.page].indexOf(a);n[self.start.page].splice(s,1)}0===n[self.start.page].length&&(n.splice(self.start.page,1),infinityView.desktop-=1),infinity.set("infinity-icons",n),infinity.broadcast("moveDone"),$(".home-drag-hover").css("display","none"),$(".home-drag-hover").removeClass("home-drag-hover-show"),loadIcons(),infinityView.setPoint(),$(event.target).off("dragend"),infinity.sendMessage("autoBackup",{type:"icon"})}}),$(".home-drag-hover").on("dragenter",function(e){$(this).addClass("home-drag-hover-show");var i=parseInt($(this).attr("data-direction"));self.dragSlideLock||(self.dragSlideLock=!0,i?infinityView.slideToleft(function(){infinity.with("info",function(e){e.hide()}),infinityView.lock=!1;var e=$(".home-page")[infinityView.desktop-1],i=$(e).children(".home-icon"),t=i[i.length-1];$(self.dragShadow).insertAfter(t),self.dragSlideLock=!1}):infinityView.slideToRight(function(){infinity.with("info",function(e){e.hide()}),infinityView.lock=!1;var e=$(".home-page")[infinityView.desktop-1],i=$(e).children(".home-icon"),t=i.length-1,n=i[t];$(self.dragShadow).insertAfter(n);var e=$(".home-page")[infinityView.desktop-1],n=(i=$(e).children(".home-icon"))[t=i.length-1];$(self.dragShadow).insertAfter(n),self.dragSlideLock=!1}))}),$(".home-drag-hover").on("dragleave",function(e){$(".home-drag-hover").removeClass("home-drag-hover-show")}),$(document).on("dragover",".home-icon-img",function(e){var i=infinity.desktop-1;if(void 0,void 0,self.start.page!=i){var t=infinity.setting("row")*infinity.setting("column");if($(e.target.parentNode.parentNode).children(".home-icon").length>=t)return void infinity.with("info",function(e){e.show(infinity.i18n("no_more_space"),!0)})}$(self.dragShadow).index()<$(e.target.parentNode).index()?$(self.dragShadow).insertAfter(e.target.parentNode):$(self.dragShadow).insertBefore(e.target.parentNode)})}};infinityDrag.init();