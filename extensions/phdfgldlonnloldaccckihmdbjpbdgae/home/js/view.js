infinity.slideSpeed=620,infinity.lockKeyupSlide=!1,infinity.open=function(i,n,t,e){var o=infinity.setting(i)?"_blank":"_self";if(n.indexOf("chrome://")>=0)chrome.tabs.create({url:n});else if(!(n.indexOf("infinity://")>=0))return e?void window.open(n,"_blank"):infinity.isMac&&t.metaKey||t.ctrlKey?void window.open(n,"_blank"):void window.open(n,o)};var infinityView={desktop:1,lock:!1,isSliding:!1,init:function(){var i=this;i.setSlideLock=$.debounce(50,!1,i.lockSlide),i.reLayout(),i.mouseWheel(),i.loadScript(),i.onOpenSite(),i.operate(),infinity.onBroadcast("deleteDone",function(n){i.reloadIconOnChange()}),infinity.onBroadcast("moveDone",function(n){i.reloadIconOnChange()}),infinity.onMessage("editDone",function(n){n.name;i.reloadIconOnChange(n.tabId)}),infinity.onBroadcast("addDone",function(n){i.reloadIconOnChange()}),$(document).on("focus","[type=search],.notes-content",function(){infinity.lockKeyupSlide=!0}),$(document).on("blur","[type=search],.notes-content",function(){infinity.lockKeyupSlide=!1})},reloadIconOnChange:function(i){chrome.tabs.getCurrent(function(n){n.id!=i&&(loadIcons(),infinityView.setPoint())})},launchChromeApp:function(i){var n=this;chrome.management.get(i,function(i){i?i.enabled?chrome.management.launchApp(i.id,function(){}):infinity.with("confirm",function(t){t.show(infinity.i18n("app_disabled_enable_first"),function(t){t&&chrome.management.setEnabled(i.id,!0,function(){n.init(),chrome.management.launchApp(i.id,function(){})})})}):infinity.with("confirm",function(i){i.show(infinity.i18n("no_this_app_go_chrome_store_download"),function(i){i&&window.open("https://chrome.google.com/webstore/detail/"+id)})})})},setToDonumbers:function(){var i=infinity.get("infinity-settings"),n=$("[data-url='infinity://todos']"),t=n.hasClass("show"),e=i.toDoNumber;i.isShowToDoNumbersInIco?0===e?t&&n.removeClass("show"):t?n.attr("data-before",e):n.addClass("show").attr("data-before",e):t&&n.removeClass("show")},lockSlide:function(){this.lock=!1},setIconAddingStatus:function(){$(".home-icon-box").addClass("home-icon-box-onadding")},setIconUnAddingStatus:function(){$(".home-icon-box").removeClass("home-icon-box-onadding")},reLayout:function(){var i=this;infinity.onMessage("reLayout",function(n){var t=infinity.get("infinity-settings"),e=t.row,o=t.column,s=t.settingMainZoom;$(".home-box").attr("class","home-box"),loadIcons();var e=(t=infinity.get("infinity-settings")).row,o=t.column;$(".home-box").attr("class","home-box home-y-"+o+" home-x-"+e),$(".home-main-box").css({"-webkit-transform":"translate(0px,0px)",transform:"translate(0px,0px)"}),i.desktop=1,infinity.zoom(s)})},mouseWheel:function(){var i=this;$(document).on("keyup",function(n){window.isMinimalistModeAndScroll&&!infinity.lockKeyupSlide&&(i.setSlideLock(),37!=n.which||i.isSliding||i.slideToleft(),39!=n.which||i.isSliding||i.slideToRight())}),$(document).on("mousewheel",".home-content",function(n,t){if(window.isMinimalistModeAndScroll){if(i.setSlideLock(),infinity.isMac&&i.lock)return!1;t<0&&!i.isSliding?i.slideToleft():t>0&&!i.isSliding&&i.slideToRight()}})},setPoint:function(){var i=this;$(".home-point").removeClass("home-point-selected"),$(".home-point:nth-child("+i.desktop+")").addClass("home-point-selected")},slideToPage:function(i,n,t){var e=this,o=n?550:0;if(i==infinityView.desktop&&n)return t&&t(),void void 0;e.isSliding=!0;var s=$(".home-box")[0].clientWidth*(i-e.desktop);$(".home-main-box").transition({x:"-="+s,duration:o,easing:"ease",complete:function(){t&&t(),e.desktop=i,e.setPoint(),setTimeout(function(){e.isSliding=!1},100)}})},slideToleft:function(i){var n=this,t=$(".home-main-box").children().length;if(2==t)return!1;n.isSliding=!0,n.lock=!0;var e=$(".home-box")[0].clientWidth,o=t-2;if(1==o)$(".home-main-box").transition({x:"-90px"},240,function(){$(".home-main-box").transition({x:"0"},300,function(){setTimeout(function(){n.isSliding=!1},100)})});else{if(n.desktop===o){var s=$(".home-icon-box:nth-child(2)").children().clone();$(".home-icon-first").html(s)}$(".home-main-box").transition({x:"-="+e,duration:infinity.slideSpeed,easing:"easeOutBack",complete:function(){n.desktop+=1,n.desktop===o+1&&(n.desktop=1,$(".home-main-box").css("transform","translate(0px, 0px)")),n.setPoint(),i&&i(),setTimeout(function(){n.isSliding=!1},50)}})}},slideToRight:function(i){var n=this,t=$(".home-main-box").children().length;if(2==t)return!1;n.isSliding=!0,n.lock=!0;var e=t-2,o=$(".home-box")[0].clientWidth;if(1==e)$(".home-main-box").transition({x:"90px"},240,function(){$(".home-main-box").transition({x:"0"},300,function(){setTimeout(function(){n.isSliding=!1},50)})});else{if(1===n.desktop){var s=$(".home-icon-box:nth-child("+(t-1)+")").children().clone();$(".home-icon-last").html(s)}$(".home-main-box").transition({x:"+="+o,duration:infinity.slideSpeed,easing:"easeOutBack",complete:function(){if(n.desktop-=1,0===n.desktop){n.desktop=e;var t=(e-1)*o*-1;$(".home-main-box").css("transform","translate("+t+"px,0px)")}n.setPoint(),i&&i(),setTimeout(function(){n.isSliding=!1},100)}})}},loadScript:function(){$(document).on("contextmenu",".home-icon-img",function(i){i.preventDefault(),infinity.require("/home/js/home-edit",function(){_edit.isEdit||_edit.start()})})},onOpenSite:function(){var i=this;$(".home-main-out").on("mousedown",".home-icon-img",function(i){var n=i.button,t=$(this);if(1==n){var e=t.attr("data-url");-1!=e.indexOf("http://")||-1!=e.indexOf("https://")?chrome.tabs.create({url:e,active:!1},function(){}):t.click()}}),$(document).on("click",".home-icon-img",function(n){n.preventDefault();try{var t=JSON.parse(decodeURIComponent($(this).attr("icon-data"))).url;if(infinity.sendMessage("sendGa",{category:"icon",event:"open",label:infinity.getHost(t)}),0==t.indexOf("infinity://"))switch(t){case"infinity://weather":infinity.with("weather",function(i){i.show()});break;case"infinity://todos":infinity.with("todos",function(i){i.show()});break;case"infinity://history":infinity.requestPermission(["history"]).then(function(){infinity.with("history",function(i){i.show()})});break;case"infinity://bookmarks":infinity.requestPermission(["bookmarks"]).then(function(){infinity.with("bookmarks",function(i){i.show()})});break;case"infinity://settings":infinity.with("main",function(i){i.show("setting")});break;case"infinity://wallpaper":infinity.with("wallpaper",function(i){i.showLibrary()});break;default:infinity.with("alert",function(i){i.show(infinity.i18n("not_support"))})}else 0==t.indexOf("chrome-app://")?i.launchChromeApp(t.replace("chrome-app://","")):infinity.open("isOpenLinkInNewTab",t,n)}catch(i){}})},operate:function(){var i=this;$(document).on("click",".home-point",function(n){if(n.target.className.indexOf("home-point")>=0){var t=$(n.target).index()+1;i.slideToPage(t,!0)}}),$(".search-select-box,.search-cover").on("animationend webkitAnimationEnd",function(i){i.target.className.indexOf("infinity-fadeOut")>0&&$(this).hide()}),$(document).on("animationend webkitAnimationEnd",".home-icon-animate",function(i){void 0,$(this).removeClass("home-icon-scale0"),$(this).removeClass("home-icon-animate")}),$(document).on("click","a[infinity-href]",function(i){i.preventDefault();var n=$(this).attr("infinity-href"),t=$(this).attr("target");t||(t="_self"),window.open(n,t)})}};$(document).on("click",".home-infinity-tpye-main",function(i){infinity.sendMessage("sendGa",{category:"btn",event:"click",label:"homeinfinityBtn"}),infinity.with("main",function(i){var n=infinity.get("infinity-settings").settingLeftSlideZoom;$(".sildeBox").css("zoom",n/100),i.show("main")})}),$(document).on("click","#fengche",function(){infinity.sendMessage("sendGa",{category:"btn",event:"click",label:"randomChangeWallpaperBtn"});var i=infinity.get("infinity-user");i.isLogin,i["pro-expire-date"];$(this).hasClass("fengche")?$(this).removeClass("fengche"):($(this).addClass("fengche"),infinity.with("info",function(i){i.show(infinity.i18n("searching_random_wallpaper"))})),infinity.sendMessage("setRandWallPaper")}),infinity.onMessage("loginStatusChange",function(){infinity.get("infinity-user").isLogin&&infinity.with("info",function(i){i.show(infinity.i18n("login_success"),!0)})}),infinity.onMessage("setRandWallPaperDone",function(){loadWallpaper(),$("#fengche").removeClass("fengche"),infinity.with("info",function(i){i.show(infinity.i18n("random_wallpaper_success"),!0)})}),infinity.onMessage("setRandWallPaperFail",function(){infinity.with("info",function(i){i.show(infinity.i18n("random_wallpaper_failed"),!0)}),$("#fengche").removeClass("fengche")}),infinity.onBroadcast("deleteDone",function(){loadIcons(),infinityView.slideToPage(infinityView.desktop,!1)}),infinity.onMessage("reloadIcon",function(){loadIcons();var i=infinity.get("infinity-settings").settingMainZoom;infinity.zoom(i),infinityView.slideToPage(infinityView.desktop,!1)}),infinity.onMessage("addFromWebPage",function(){loadIcons(),infinityView.slideToPage(infinityView.desktop,!1)}),infinity.onMessage("userBackupDone",function(){infinity.with("info",function(i){i.show(infinity.i18n("backup_done"),!0)})}),infinity.onMessage("setStyleAfterRevovery",function(){infinity.setIconStyle();try{var i=infinity.get("infinity-settings"),n=i.isShowSearchBtn,t=i.searchBoxRadius,e=i.searchBoxOpacity,o=i.isShowSearchBox,s=i.isShowSearchType,a=i.searchBoxShadow,c=i.Searchboxsize;i.settingLeftSlideZoom;infinity.setSearch(o,n,t,e,s,a,c)}catch(i){}}),$(document).on("contextmenu","#contextMenu",function(){if("none"!=$("#contextMenu").css("display"))return!1}),$(document).on("contextmenu",function(i){var n=$(i.target);if(!n.is("input")){var t=$("#infinity-search");return!(!t.is(i.target)&&0===t.has(i.target).length)||!!n.closest(".J-allow-contextmenu").length}}),infinity.fisrtLogin=function(){var i=infinity.get("infinity-status"),n=i.isFirstLogin,t=i.email;n&&setTimeout(function(){infinity.with("login",function(){infinity.with("login",function(i){i.show(t),infinity.set("infinity-status",{isFirstLogin:!1})})})},500)},infinity.fisrtLogin(),$(".home-content").on("contextmenu",function(i){if(0===$("#contextMenu").length){var n=$(".home-icon-img"),t=$(".search-input-out");if(t.is(i.target)||0!==t.has(i.target).length)return;if(n.is(i.target)||0!==n.has(i.target).length)return!0}var e;if(infinity.with("contextmenu",function(n){e=infinity.modules.contextMenu.show(i)}),!1===e||void 0===e)return!1});