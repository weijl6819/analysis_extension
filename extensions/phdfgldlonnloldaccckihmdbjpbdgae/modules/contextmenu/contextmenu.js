infinity.modules.contextMenu={init:function(){$("#contextMenu-synchronization").text(infinity.i18n("backup_now")),$("#contextMenu-wallpaper").text(infinity.i18n("random_wallpaper")),$("#contextMenu-edit").text(infinity.i18n("edit_icon")),$("#donloadCurrentpaper").text(infinity.i18n("save_wallpaper")),$("#contextMenu").on("click","li",function(n){var i=$(n.target).data("type"),t=infinity.get("infinity-user");if(infinity.sendMessage("sendGa",{category:"contextmenuBtn",event:"click",label:i}),"synchronization"==i)infinity.with("info",function(n){n.show(infinity.i18n("backuping_your_data"),!0)}),infinity.isLogin()&&t.isVipMember?infinity.sendMessage("userBackup"):infinity.with("info",function(n){n.show(infinity.i18n("please_login_first"),!1)});else if("wallpaper"==i)$("#fengche").addClass("fengche"),infinity.with("info",function(n){n.show(infinity.i18n("searching_random_wallpaper"),!1)}),infinity.sendMessage("setRandWallPaper");else if("download"==i){var e=infinity.setting("currentBg"),o=infinity.get("infinity-bg").src;if(e){var a=document.createElement("a");a.href="local"==e?o:e,a.download="infinityWallPaper.jpg",$("#download-img-box-href").html(a),a.click()}if(!o)return!1;if(!e)return!1}else"edit"==i&&infinity.require("/home/js/home-edit",function(){_edit.isEdit||_edit.start()});$("#contextMenu").hide()}),$(".home-content").on("click",function(n){$(event.target).is("#contextMenu")||"none"!=$("#contextMenu").css("display")&&$("#contextMenu").hide()})},show:function(n){var i=$("#contextMenu");if("none"==i.css("display")){infinity.get("infinity-bg");var t=infinity.setting("currentBg"),e=$(".search-input-out"),o=$(".home-icon-img");if(e.is(n.target)||0!==e.has(n.target).length)return!0;if(o.is(n.target)||0!==o.has(n.target).length)return!0;var a=i.css("width"),c=i.css("height"),r=document.body.clientWidth,l=document.body.clientHeight,s=n.clientX,d=n.clientY,f=l-d,u=s,p=d;if(r-s<parseFloat(a)+20&&(u=s-parseFloat(a)-20),f<parseFloat(c)+20&&(p=d-parseFloat(c)-20),$("#contextMenu").css({display:"block",left:u+"px",top:p+"px"}),t){$("#contextMenu-download").removeClass("downloadwallpapernotclick");$("#donloadCurrentpaper")}return t||$("#contextMenu-download").addClass("downloadwallpapernotclick"),!1}return $("#contextMenu").hide(),!1}},infinity.modules.contextMenu.init();