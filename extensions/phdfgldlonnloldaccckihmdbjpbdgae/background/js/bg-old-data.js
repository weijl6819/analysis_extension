var bgOldData={oldId:"dbfmnekepjoapopniengjbcpnbljalfg",isInstall:!1,init:function(){var e=this;chrome.runtime.onInstalled.addListener(function(i){"install"==i.reason?e.isInstall=!0:i.reason}),infinity.onMessage("importOldData",function(i,t,n){return e.transOldData(i,function(e){e?(infinity.set("infinity-icons",e),bgWashData.washIcons(function(){n({error:null})})):n({error:null})}),!0})},messageOld:function(e){var i=this,t=i.oldId;chrome.runtime.sendMessage(t,{getTargetData:!0},function(t){i.transOldData(t,function(i){if(i)return infinity.set("infinity-icons",i),void bg.washIcons(function(){infinity.sendMessage("firstLogin"),e&&e()});chrome.tabs.create({url:"chrome://newtab/"})})})},transCustomIcon:function(e,i,t,n){var a=document.getElementById("iconCanvas"),o=a.getContext("2d"),r=infinity.iconSize;if(t)s=.56*r;else var s=r;var l=(r-s)/2;o.clearRect(0,0,r,r),a.width=r,a.height=r;var c=new Image;c.src=i,c.onload=function(){o.fillStyle=e,o.fillRect(0,0,r,r),o.drawImage(c,l,l,s,s);var i=a.toDataURL("image/png");n&&n(i)}},transOldData:function(e,i){var t=this;try{for(var n=e.icon,a=JSON.parse(e.setting),o=a.todostrue,r=a.todosfalse,s=[],l=0;l<r.length;l++){c={done:!0,time:(new Date).getTime(),text:r[l]};s.push(c)}for(l=0;l<o.length;l++){var c={done:!1,time:(new Date).getTime(),text:o[l]};s.push(c)}infinity.set("infinity-todos",s),infinity.setting("toDoNumber",o.length),infinity.sendMessage("todoChanged");for(var f=a.notes,d=[],l=0;l<f.length;l++){var m={text:f[l].text,time:(new Date).getTime()};d.push(m)}infinity.set("infinity-notes",d),infinity.sendMessage("updateNotesView");for(var g=JSON.parse(n),y=_.flatten(g,!0),l=0;l<y.length;l++){var u=y[l];if("weather"==u.type)u.uid="eed2a9287b324510678cd5e714888e99",u.name=infinity.i18n("weather"),u.url="infinity://weather",u.src="https://infinityicon.infinitynewtab.com/user-share-icon/b6a95410ed77627337567fea2cbb157c.png?imageMogr2/thumbnail/"+infinity.iconSize+"x/format/webp/blur/1x0/quality/100|imageslim",u.imageType="image",delete u.bgColor,delete u.type,delete u.ico;else if("todos"==u.type)u.uid="c09f31db43d7faca5bf659fadad3967c",u.name=infinity.i18n("todos"),u.url="infinity://todos",u.src="https://infinityicon.infinitynewtab.com/user-share-icon/6e49210c084629259f22609980c48ecf.png?imageMogr2/thumbnail/"+infinity.iconSize+"x/format/webp/blur/1x0/quality/100|imageslim",u.imageType="image",delete u.bgColor,delete u.type,delete u.ico;else if("apps"==u.type)u.uid="4e0da886cc15213d558a4c51b2623089",u.name=infinity.i18n("chrome_apps"),u.url="infinity://chrome-apps",u.src="https://infinityicon.infinitynewtab.com/user-share-icon/63cf498c5b3d20beaa0b1f38bda717f9.png?imageMogr2/thumbnail/"+infinity.iconSize+"x/format/webp/blur/1x0/quality/100|imageslim",u.imageType="image",delete u.bgColor,delete u.type,delete u.ico;else if("notepad"==u.type)u.uid="ea5ac5d9e9e08c1d57ad413e9e38d376",u.name=infinity.i18n("notes"),u.url="infinity://notes",u.src="https://infinityicon.infinitynewtab.com/user-share-icon/006b88c07a2e87d5a61f3c969a70575c.png?imageMogr2/thumbnail/"+infinity.iconSize+"x/format/webp/blur/1x0/quality/100|imageslim",u.imageType="image",delete u.bgColor,delete u.type,delete u.ico;else if("bookmarks"==u.type)u.uid="96646a13688f5bfd0aaf4811a579aee1",u.name=infinity.i18n("bookmarks"),u.url="infinity://bookmarks",u.src="https://infinityicon.infinitynewtab.com/user-share-icon/31a36139ccf4b9b005ec55445bf833b0.png?imageMogr2/thumbnail/"+infinity.iconSize+"x/format/webp/blur/1x0/quality/100|imageslim",u.imageType="image",delete u.bgColor,delete u.type,delete u.ico;else if("history"==u.type)u.uid="4528cef4f8d66e661cb3143af733694e",u.name=infinity.i18n("history"),u.url="infinity://history",u.src="https://infinityicon.infinitynewtab.com/user-share-icon/faa06f85d37cdd552e2e57cb282ad0f7.png?imageMogr2/thumbnail/"+infinity.iconSize+"x/format/webp/blur/1x0/quality/100|imageslim",u.imageType="image",delete u.bgColor,delete u.type,delete u.ico;else if("setting"==u.type)u.uid="552fa3a378b29375843fa3d021cbe129",u.name=infinity.i18n("settings"),u.url="infinity://settings",u.src="https://infinityicon.infinitynewtab.com/user-share-icon/9622b98e90dd4f107d23481566095b34.png?imageMogr2/thumbnail/"+infinity.iconSize+"x/format/webp/blur/1x0/quality/100|imageslim",u.imageType="image",delete u.bgColor,delete u.type,delete u.ico;else if("ico"==u.type||"gmail"==u.type){var p=u.ico;if(p){u.imageType="image";var b=p.indexOf("ouddn.com");if(b>0){var h=p.substr(b+9,p.length);u.src="https://infinityicon.infinitynewtab.com"+h}else u.src=u.ico;delete u.bgColor}else u.imageType="color",u.fontSize=32,u.showText=u.name.substr(0,2);delete u.type,delete u.ico,delete u.iconid,delete u.title}u.uid||(u.uid=infinity.id("800"))}var w=0;function v(e){var n=y[w];if(n)"custom"==n.type?""==n.ico?(n.showText=n.title.substr(0,2),n.fontSize=32,n.imageType="color",w+=1,v()):t.transCustomIcon(n.bgColor,n.ico,!1,function(e){n.src=e,n.imageType="image",n.bgColor="transparent",n.showText="",delete n.bgColor,delete n.type,delete n.ico,delete n.iconid,delete n.title,w+=1,v()}):"app"==n.type?t.transCustomIcon("#ffffff",n.ico,!0,function(e){n.src=e,n.url="chrome-app://"+n.url.split("://")[1],n.imageType="image",delete n.bgColor,delete n.type,delete n.ico,delete n.iconid,delete n.title,w+=1,v()}):(w+=1,v());else{var a=_.chunk(y,10);i&&i(a)}}v()}catch(e){void 0,i&&i(!1)}}};