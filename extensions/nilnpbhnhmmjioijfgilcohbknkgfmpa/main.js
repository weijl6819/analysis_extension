!function(window){"use strict";const document=window.document,extended=!0;let focusStop=!1,seeked=!1;function stopAutoplay(player){return seeked?seeked=!1:!((player.loop||-1!==document.location.search.indexOf("list=")||document.hasFocus())&&!focusStop)&&(function(player){if(void 0!==player.pause)return player.pause();player.pauseVideo()}(player),!0)}function _playIfNotHidden(player){document.hidden||function(player){if(void 0!==player.play){const maybePromise=player.play();return maybePromise instanceof Promise&&maybePromise.catch(console.warn)}player.playVideo()}(player)}const boundPlayers=new WeakSet;function bindPlayer(player){if(boundPlayers.has(player))return;boundPlayers.add(player),player.readyState>1&&stopAutoplay(player),player.addEventListener("canplaythrough",stopAutoplay.bind(void 0,player));let i=0;if(player.addEventListener("playing",function playing(){stopAutoplay(player),2==++i&&player.removeEventListener("playing",playing)}),player.addEventListener("loadeddata",function(){i=0}),extended)window.addEventListener("focus",function(player){window.setTimeout(_playIfNotHidden.bind(void 0,player),60)}.bind(void 0,player));else{const seekedTrue=()=>{player.readyState>1&&(seeked=!0)},onfocus=function(){focusStop=!0,player.addEventListener("playing",()=>{focusStop=!1},{once:!0}),player.addEventListener("play",seekedTrue,{once:!0}),player.addEventListener("seeked",seekedTrue),player.addEventListener("waiting",seekedTrue)};document.hasFocus()?onfocus():window.addEventListener("focus",onfocus,{once:!0})}}let video=document.getElementsByTagName("video");0!==video.length?(bindPlayer(video[0]),video=null):function(){const observer=new MutationObserver(function(mutations){for(let i=0;i<mutations.length;++i)for(var mutation=mutations[i].addedNodes,x=0;x<mutation.length;++x)if("VIDEO"===mutation[x].nodeName||"OBJECT"===mutation[x].nodeName)return observer.disconnect(),void bindPlayer(mutation[x])});observer.observe(document,{childList:!0,subtree:!0})}(),function(){const original=window.onYouTubePlayerReady;window.onYouTubePlayerReady=function(player){3!==player.getPlayerState()&&bindPlayer(document.getElementsByTagName("video")[0]),void 0!==original&&original()}}()}(window);
