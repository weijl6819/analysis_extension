define(["./utils"],function(e){return function(f){f=f||{};var c=this,d={},g=function(){var a=location.hash.substr(1);a=f.useHash?e.hashParseParam(a):e.parseUrl(a,{params:!0});var b;for(b in a){var c=a[b];"?query"===b&&(b="query");b&&(d[b]=c)}};window.addEventListener("popstate",function(){c.clear();g();c.applyUrl()});this.get=function(a){return"string"===typeof d[a]?d[a]:null};this.set=function(a,b){"number"===typeof b&&(b=b.toString());d[a]=b;return c};this.remove=function(a){delete d[a];return c};
this.clear=function(){for(var a in d)delete d[a];return c};this.applyUrl=function(){};this.getUrl=function(){var a=location.origin+location.pathname,b=f.useHash?e.hashParam(d):e.param(d);b&&(a+="#"+b);return a};this.go=function(){var a=c.getUrl();window.history.pushState(null,"",a);c.applyUrl()};g()}});
