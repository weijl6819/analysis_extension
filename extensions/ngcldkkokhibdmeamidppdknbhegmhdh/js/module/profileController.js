define(["./profile"],function(k){return function(b,f,l,m){var c=this,d={},e=null,g=function(){for(var a in d)delete d[a];b.profiles.forEach(function(a){d[a.id]=a})},h=function(){var a=b.profiles;0===a.length&&a.push(l.prototype.getDefaultProfile(c));g();c.setSelectOptions(a);d[b.currentProfileId]||(b.currentProfileId=a[0].id)};f.on("selectProfileById",function(a){d[a]||(a=b.currentProfileId);c.select(a)});f.on("profileRemoved",function(a){e.id===a?(h(),c.select(b.currentProfileId,!0)):(g(),c.setSelectOptions(b.profiles))});
f.on("profileInsert",function(a){g();c.setSelectOptions(b.profiles)});f.on("profilesSortChange",function(){c.setSelectOptions(b.profiles)});f.on("profileFieldChange",function(a,d){-1!==d.indexOf("name")&&(e.id===a?(c.setSelectOptions(b.profiles),c.setSelectValue(b.profiles,a)):c.setSelectOptions(b.profiles))});this.setSelectOptions=function(){};this.setSelectValue=function(){};this.setTrackerList=function(){};this.profile=e;this.getProfileById=function(a){return d[a]||null};this.getProfileId=function(){for(var a=
1;d[a];)a++;return a};this.select=function(a,g){a=d[a];if(g||!e||e.id!==a.id)c.setSelectValue(b.profiles,a.id),e&&e.destroy(),e=new k(a,m,c.setTrackerList,f,b),c.profile=e};this.load=h}});
