/*! Heartbleed Search v0.1.1 | (c) 2012, 2014, ADARTA Inc. <notify@heartbleedsearch.com> | Licensed heartbleedsearch.com/license */function parseURL(a){if(parsed_url={},null==a||0==a.length)return parsed_url;switch(protocol_i=a.indexOf("://"),parsed_url.protocol=a.substr(0,protocol_i),remaining_url=a.substr(protocol_i+3,a.length),domain_i=remaining_url.indexOf("/"),domain_i=-1==domain_i?remaining_url.length-1:domain_i,parsed_url.domain=remaining_url.substr(0,domain_i),parsed_url.path=-1==domain_i||domain_i+1==remaining_url.length?null:remaining_url.substr(domain_i+1,remaining_url.length),domain_parts=parsed_url.domain.split("."),domain_parts.length){case 2:parsed_url.subdomain=null,parsed_url.host=domain_parts[0],parsed_url.tld=domain_parts[1];break;case 3:parsed_url.subdomain=domain_parts[0],parsed_url.host=domain_parts[1],parsed_url.tld=domain_parts[2];break;case 4:parsed_url.subdomain=domain_parts[0],parsed_url.host=domain_parts[1],parsed_url.tld=domain_parts[2]+"."+domain_parts[3]}return parsed_url.parent_domain=parsed_url.host+"."+parsed_url.tld,parsed_url}function getHeartbeat(a,b,c){function d(a){window.clearTimeout(h),b&&b(a)}function e(){window.clearTimeout(h),c&&!i&&c(),i=!0}var f="https://hbelb.filippo.io/bleed/"+a,g=new XMLHttpRequest,h=window.setTimeout(function(){g.abort()},requestTimeout),i=!1;try{g.onreadystatechange=function(){if(4==g.readyState){if(200==g.status){var a=g.responseText;return void d(a)}console.error(chrome.i18n.getMessage("json_error")),e()}},g.onerror=function(){e()},g.open("GET",f,!0),g.send(null)}catch(j){console.error(chrome.i18n.getMessage("getHeartbeat_exception",j)),e()}}function onInit(){chrome.declarativeContent.onPageChanged.removeRules(void 0,function(){chrome.declarativeContent.onPageChanged.addRules([rule])})}function updateIcon(a){var b=isActive?"images/icon38.png":"images/icon-off38.png",c=isActive?"Heartbleed Search (ON)":"Heartbleed Search (OFF)";chrome.pageAction.setIcon({tabId:a,path:b}),chrome.pageAction.setTitle({tabId:a,title:c})}function updateContext(a,b){updateIcon(a),b?chrome.tabs.executeScript(a,{code:"isActivated=true;"}):chrome.tabs.executeScript(a,{code:"isActivated=false; removeBleedIcons();"})}function onNavigate(){}var requestTimeout=4e3;void 0!==localStorage.isInitialized&&localStorage.isInitialized?(localStorage.isInitialized=!0,void 0===localStorage.isActivated&&(localStorage.isActivated=!1)):(localStorage.isActivated=!1,localStorage.isInitialized=!0);var isActive=JSON.parse(localStorage.isActivated),condition1=new chrome.declarativeContent.PageStateMatcher({pageUrl:{hostEquals:"www.google.com",schemes:["https"]}}),condition2=new chrome.declarativeContent.PageStateMatcher({pageUrl:{hostEquals:"www.bing.com",pathContains:"search",queryContains:"q=",schemes:["https","http"]}}),condition2a=new chrome.declarativeContent.PageStateMatcher({pageUrl:{hostEquals:"www.bing.com",pathContains:"news",queryContains:"q=",schemes:["https","http"]}}),condition3=new chrome.declarativeContent.PageStateMatcher({pageUrl:{hostSuffix:"yahoo.com",pathContains:"search",schemes:["https"]}}),condition4=new chrome.declarativeContent.PageStateMatcher({pageUrl:{hostSuffix:"ask.com",pathContains:"web",schemes:["https","http"]}}),condition4a=new chrome.declarativeContent.PageStateMatcher({pageUrl:{hostSuffix:"ask.com",pathContains:"news",schemes:["https","http"]}}),condition5=new chrome.declarativeContent.PageStateMatcher({pageUrl:{hostSuffix:"aol.com",pathContains:"search",schemes:["https","http"]}}),condition5a=new chrome.declarativeContent.PageStateMatcher({pageUrl:{hostSuffix:"aol.com",pathContains:"news",schemes:["https","http"]}}),condition6=new chrome.declarativeContent.PageStateMatcher({pageUrl:{hostSuffix:"wow.com",pathContains:"search",schemes:["https","http"]}}),condition7=new chrome.declarativeContent.PageStateMatcher({pageUrl:{hostSuffix:"duckduckgo.com",schemes:["https"]}}),condition8=new chrome.declarativeContent.PageStateMatcher({pageUrl:{hostSuffix:"blekko.com",schemes:["https","http"]}}),condition9=new chrome.declarativeContent.PageStateMatcher({pageUrl:{hostSuffix:"ixquick.com",pathContains:"do",schemes:["https","http"]}}),conditions=[condition1,condition2,condition2a,condition3,condition4,condition4a,condition5,condition5a,condition6,condition7,condition8,condition9],rule={conditions:conditions,actions:[new chrome.declarativeContent.ShowPageAction]};chrome.runtime&&chrome.runtime.onInstalled&&chrome.runtime.onInstalled.addListener(onInit),chrome.pageAction.onClicked.addListener(function(a){isActive=!isActive,updateContext(a.id,isActive),isActive&&chrome.tabs.executeScript(a.id,{code:"waitForLoad();"}),localStorage.isActivated=isActive}),$(document).ready(function(){}),chrome.runtime.onMessage.addListener(function(a,b,c){if("loadNotify"===a.method)switch(a.key){case"complete":updateContext(b.tab.id,isActive);var d={isActivated:isActive};c(d);break;case"localStorage":var d={isActivated:isActive};c(d);break;default:c({})}else c({})});