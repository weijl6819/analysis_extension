/* Generated at Fri Dec  4 15:28:06 CST 2015 */
var GQueues=function(){var y={};var aq=$("#gqUserEmail");var aE=$("#gqDescription");var K=$("#gqNotes");var aI=$("#gqQueueDropdown");var ar=$("#gqFromWeb");var E=$("#gqCreateBtn");var U="";var aH="";var n="";var aG="";var ap="";var aP;var aO="";var f;var h;var B;var F;var am=false;var aQ;var w;var ao=$("#gqCalendar");var aB=$("#gqTags");var Y=$("#gqAssignments");var x;var b;var aJ;var ad;var aM;var at=$("#gqRefreshBtn");var aj=$("#gqLoadingPanel");var W=aj.find("div");var aA=$("#gqResponsePanel");var ac=$("#gqResponsePanel > div");var aD=$("#gqConnectBtn");var aU=$(".gq-chrome-setup-unauthorized");var o=$(".gq-chrome-setup-welcome");var l="https://www.gqueues.com/gmailGadgetContent";var aa;var Z=function(aW){$(".gq-panel").addClass("gq-hidden");$(aW).removeClass("gq-hidden");$(document).unbind("keydown.msg")};var Q=function(){aj.height($(".gq-panel:visible").height());var aW=aj.height()/2;W.css("padding-top",aW);Z("#gqLoadingPanel")};var az=function(aW){Z("#gqContentPanel");setTimeout(function(){aE.focus()},100)};var z=function(){aA.height($(".gq-panel:visible").height());Z("#gqResponsePanel");var aW=(aA.height()-ac.height())/2;ac.css("padding-top",aW)};var q=function(aW){if(aW){aU.removeClass("gq-hidden");o.addClass("gq-hidden")}else{aU.addClass("gq-hidden");o.removeClass("gq-hidden")}Z("#gqSetupPanel")};var i=function(){chrome.runtime.sendMessage({action:"showLoginWindow"},function(aW){})};var D=function(){$(".gq-panel").addClass("gq-hidden");GQueues.TagFilter.hide();GQueues.AssignFilter.hide();window.close()};var P=function(){chrome.tabs.getSelected(null,function(aW){var aX=aW.title;if(aX.indexOf("Gmail - ")!==-1){aX=aX.substring(aX.indexOf("Gmail - ")+8,aX.lastIndexOf("-"))}else{if(aX.indexOf(" - Gmail")!==-1){aX=aX.substring(0,aX.lastIndexOf("-"));aX=aX.substring(0,aX.lastIndexOf("-"))}}var aY=/^.* Mail - /;if(aY.test(aX)){aX=aX.substring(aX.indexOf("Mail - ")+7,aX.lastIndexOf("-"))}aE.val(aX);K.val(aW.url);aE.focus()});ar.attr("checked","checked")};var G=function(){ar.removeAttr("checked");aE.val("");K.val("");aE.focus()};var aw=function(){ai();b.setInputValue("");N();c();av();aE.val("");K.val("");$("#gqTags .gq-i-tag").remove();$("#gqAssignments .gq-i-assignment").remove();K.html("");if(y.webDefault){P()}else{G()}};var au=function(){if($("#gqDateCheckbox").attr("checked")){V()}else{ai()}};var V=function(){g();var aW=new Date();ao.datepicker("setDate",aW);a();if(aQ){aO=aQ}else{aO=1440}T();if(h){ap=h;aG=f;j();if(aG){aS();ad.setVisible(true)}}else{av()}$(".gq-ext-btns").addClass("compact");$(".gq-date-heading").addClass("gq-date-heading-selected");$("#gqDateTableRow").removeClass("gq-hidden")};var ai=function(){$("#gqDateCheckbox").removeAttr("checked");$(".gq-date-heading").removeClass("gq-date-heading-selected");$("#gqDateTableRow").addClass("gq-hidden");$(".gq-ext-btns").removeClass("compact");g();c();av()};var g=function(){U="";aH="";n="";aG="";ap="";ag()};var A=function(aW){if($("#gqAssignments table .gq-a-name[title='"+aW+"']").length===0){var aX=$("#gqAssignments table tr:last");aX.find(".gq-a-name").text(aW).attr("title",aW);aX.find(".gq-a-icon").removeClass("gq-a-adding").addClass("gq-a-open").html("")}$("#gqSpacer").addClass("gq-hidden")};var an=function(){aB.find(".gq-i-tag-content").attr("title","");aB.find(".gq-i-tag-delete").attr("title","Remove tag");$("#gqSpacer").addClass("gq-hidden")};var e=function(){aE.blur();Q();var aZ=y.authKey;var a4=aE.val();var a0=K.val();var aY={authKey:aZ,action:"create",key:aI.val(),description:a4,notes:a0};var aX;var a5=aB.find(".gq-i-tag-content");if(a5.length>0){aX=1;a5.each(function(){aY["tags"+aX]=$(this).text();aX++})}var aW=Y.find(".gq-a-name");if(aW.length>0){aX=1;aW.each(function(){aY["assignments"+aX]=$(this).attr("title");aX++})}if($("#gqDateCheckbox").attr("checked")){var a2=ao.datepicker("getDate");var a1=$.datepicker.formatDate("yy-mm-dd",a2);var a3="No";if(aH){a1+=" "+aH+":"+n;a3="Yes"}aY.dueDate=a1;aY.dueTime=a3;if(ap){aY.reminderType=ap;aY.reminderAmount=aG}aY.duration=aO}$.ajax({type:"POST",cache:false,url:l,data:aY,dataType:"json",success:function(a6){al(a6)},error:function(a6,a8,a7){if(a6.status===403){q(true)}else{ac.html('sorry, there was an error<br /><br /><span class="gq-msg-link">try again</span>');ac.find(".gq-msg-link").click(function(){az()});z();chrome.runtime.sendMessage({action:"recordCreateFailure",fromWeb:ar.attr("checked")},function(a9){})}}})};var al=function(aY){var aX;if(aY.createErrors&&aY.createErrors.length){aX="task created<br /><br />";for(var aW=0;aW<aY.createErrors.length;aW++){aX+='<span class="gq-msg-errors">'+aY.createErrors[aW].error+"</span><br />"}aX+='<br /><span class="gq-msg-link">close</span>'}else{aX='task created<br /><br /><span class="gq-msg-link">close</span>'}aX+='<br /><br /><button id="gqNewTaskBtn" class="gq-button gq-button-two">New Task</button>';ac.html(aX);ac.find(".gq-msg-link").click(D);$("#gqNewTaskBtn").click(function(){aw();az()});z();if(ar.attr("checked")){setTimeout(function(){D()},1000)}$(document).bind("keydown.msg",function(aZ){if(aZ.keyCode===13){D()}else{if(aZ.keyCode===73){aw();az();return false}}});chrome.runtime.sendMessage({action:"recordCreateSuccess",fromWeb:ar.attr("checked")},function(aZ){})};var O=function(){Q();aK(true)};var aK=function(aW){var aX=y.authKey;if(!aX){q()}else{if(aW){R()}else{ay(function(aY){if(!aY){R()}else{aF(aY);az()}})}}};var R=function(){var aW=y.authKey;$.ajax({type:"POST",cache:false,url:l,data:{authKey:aW},dataType:"json",success:function(aX){v(aX)},error:function(aX,aZ,aY){if(aX.status===403){q(true)}else{Z("#gqErrorPanel")}}})};var v=function(aX){if(aX.notAllowed){q(true)}else{var aY=new Date().getTime();var aW={lastSyncStamp:aY};chrome.storage.local.set({GQ_STORAGE_USER_DATA_KEY:aX,GQ_STORAGE_USER_DATA_LAST_SYNC:aW},function(){});aF(aX);az()}};var ay=function(aW){chrome.storage.local.get("GQ_STORAGE_USER_DATA_KEY",function(aX){var aY=aX.GQ_STORAGE_USER_DATA_KEY;aW(aY)})};var aF=function(aX){h=aX.defaultReminderType;f=aX.defaultReminderAmount;B=true;if("smsAllowed" in aX){B=aX.smsAllowed}F=true;if("remindersAllowed" in aX){F=aX.remindersAllowed}if(!F){aJ.setDisabled(true)}else{aJ.setDisabled(false)}var aW=[{itemValue:"No reminder",itemText:"No reminder"},{itemValue:"Email reminder",itemText:"Email reminder"},{itemValue:"SMS reminder",itemText:"SMS reminder"},{itemValue:"Pop-up reminder",itemText:"Pop-up reminder"}];if(!B){aW.splice(2,1)}aJ.setMenuItems(aW);aQ=aX.defaultDateDuration;w=aX.defaultTimeDuration;ao.datepicker("option","firstDay",aX.weekStart||0);aq.text(aX.email);X(aX);t(aX);aC(aX)};var X=function(aZ){var aW=[];var aY;aW.push('<option value="" selected="selected">Inbox</option>');$.each(aZ.categories,function(a0,a1){aY='<option disabled="disabled"> --- '+a1.name+" --- </option>";aW.push(aY);$.each(a1.queues,function(a3,a2){aY='<option value="'+a2.key+'">'+a2.name+"</option>";aW.push(aY)})});$.each(aZ.friendships,function(a1,a0){aY='<option disabled="disabled"> --- '+a0.name+" --- </option>";aW.push(aY);$.each(a0.queues,function(a3,a2){if(a2.collaboration){disabledText=""}else{disabledText=" disabled='disabled' "}aY='<option value="'+a2.key+'"'+disabledText+">"+a2.name+"</option>";aW.push(aY)})});aI.html(aW.join(""));var aX=y.defaultQueueKey;if(aX){aI.find("option").each(function(){if(this.value===aX){aI.val(aX);return false}})}};var aC=function(aY){var aW=aY.assignees.length;if(aW>0){for(var aX=0;aX<aW;aX++){GQueues.AssignFilter.updateAssignFilter(aY.assignees[aX].email,aY.assignees[aX].filterName)}}};var t=function(aY){var aX=aY.tags.length;if(aX>0){for(var aW=0;aW<aX;aW++){GQueues.TagFilter.createTagFromText(aY.tags[aW],true)}}};var ae=function(){N();b.setInputValue("");b.selectInput();b.hideMenu();ag()};var aT=function(){N();b.setInputValue("");b.hideMenu();ag()};var L=function(){var aW=new Date();var aY=aW.getHours()+1;var aX="AM";if(aY>11){aX="PM";if(aY>12){aY=aY-12}}var aZ=aY+":00 "+aX;return aZ};var S=function(aY){try{var aX=aY.split(" ")[1];var aW=aY.split(":")[0];return aW+":00 "+aX}catch(aZ){}};var M=function(aX,aY){var aW=$.trim(aX);var aZ={};_postChanges=true;if(aW.length===0){b.clearErrorFlag();b.setInputValue("");C();N()}else{aZ=GQueues.CalendarUtil.parseTimeInput(aW);if(aZ===null){b.setErrorFlag();C()}else{if(!aH){aO=w}b.clearErrorFlag();C();aH=aZ.hour;n=aZ.minute;I();ag();af();T()}}};var N=function(){aH="";n="";aO=aQ;af();T()};var I=function(){var aW="";if(aH){aW=GQueues.CalendarUtil.getFormattedTimeForInput(aH,n)}b.setInputValue(aW)};var u=function(){aO=0;aM.setInputValue("");aM.selectInput();aM.hideMenu()};var H=function(){if(aH){return"60"}else{return"1440"}};var af=function(){var aX=[{itemValue:"All day",itemText:"All day"},{itemValue:"2 days",itemText:"2 days"},{itemValue:"3 days",itemText:"3 days"},{itemValue:"4 days",itemText:"4 days"},{itemValue:"5 days",itemText:"5 days"},{itemValue:"6 days",itemText:"6 days"},{itemValue:"1 week",itemText:"1 week"},{itemValue:"customDuration",itemText:"Custom duration",itemHandler:u}];var aW=[{itemValue:"5 minutes",itemText:"5 minutes"},{itemValue:"10 minutes",itemText:"10 minutes"},{itemValue:"15 minutes",itemText:"15 minutes"},{itemValue:"20 minutes",itemText:"20 minutes"},{itemValue:"30 minutes",itemText:"30 minutes"},{itemValue:"45 minutes",itemText:"45 minutes"},{itemValue:"1 hour",itemText:"1 hour"},{itemValue:"2 hours",itemText:"2 hours"},{itemValue:"3 hours",itemText:"3 hours"},{itemValue:"6 hours",itemText:"6 hours"},{itemValue:"12 hours",itemText:"12 hours"},{itemValue:"1 day",itemText:"1 day"},{itemValue:"2 days",itemText:"2 days"},{itemValue:"3 days",itemText:"3 days"},{itemValue:"4 days",itemText:"4 days"},{itemValue:"5 days",itemText:"5 days"},{itemValue:"6 days",itemText:"6 days"},{itemValue:"1 week",itemText:"1 week"},{itemValue:"customDuration",itemText:"Custom duration",itemHandler:u}];if(aH){aM.setMenuItems(aW)}else{aM.setMenuItems(aX)}};var c=function(){aO=""};var T=function(){aM.setInputValue(GQueues.CalendarUtil.getDurationDisplayAmount(aO))};var p=function(){if(!aO){if(aH){aO=w}else{aO=aQ}}af()};var ah=function(aX,aZ){var aW=$.trim(aX);var aY=null;if(aW.length===0){if(aH){aO=60}else{aO=1440}aM.clearErrorFlag();E.removeAttr("disabled");T()}else{aY=GQueues.CalendarUtil.parseDurationInput(aW);if(aY===null||aY===0){aM.setErrorFlag();C()}else{if(!aH&&aY%1440!==0){aM.setErrorFlag();C()}else{aM.clearErrorFlag();C();aO=aY;T()}}}};var ak=function(aW,aX){$("#gqDateReminder").removeClass("gq-hidden");if(aW==="Email reminder"){ap="email"}else{if(aW==="SMS reminder"){ap="sms"}else{if(aW==="Pop-up reminder"){ap="alert"}else{if(aW==="No reminder"){av();return}}}}if(!aG||aG===""){if(f){aG=f}else{aG="15"}}aS();ad.setVisible(true)};var J=function(aW,aY){var aZ=$.trim(aW);var aX=null;if(aZ.length===0){aG=0;ad.clearErrorFlag();C();aS()}else{aX=GQueues.CalendarUtil.parseReminderAmountInput(aZ);if(aX===null){ad.setErrorFlag();C()}else{if(aX>40320){aX=40320}ad.clearErrorFlag();C();aG=aX;aS()}}};var d=function(){return"No reminder"};var m=function(){return""};var aV=function(){if(GQueues.config.calendarIntegration==="True"){aJ.setDisabled(false)}else{aJ.setDisabled(true)}};var j=function(){var aW={"":"No reminder",email:"Email reminder",sms:"SMS Reminder",alert:"Pop-up reminder"};aJ.setInputValue(aW[ap]);if(!ap){$("#gqDateReminder").addClass("gq-hidden")}else{$("#gqDateReminder").removeClass("gq-hidden")}};var s=function(){_postChanges=true;aG=0;ad.setInputValue("");ad.selectInput();ad.hideMenu()};var av=function(){$("#gqDateReminder").addClass("gq-hidden");ap="";aG="";ad.clearErrorFlag();ad.setVisible(false);j()};var aS=function(){ad.setInputValue(GQueues.CalendarUtil.getReminderDisplayAmount(aG))};var k=function(){am=true;GQueues.MessageBox.show({title:"Task Reminders",text:"To set task reminders first activate Google Calendar integration.<br /><br /><a target='_blank' href='https://www.gqueues.com/help/tasks#reminder'>More info</a>",okBtn:true,okBtnText:"OK",callback:function(){am=false},cancelBtn:false})};var a=function(){var aX=ao.datepicker("getDate");var aW=new Date();U=$.datepicker.formatDate("D, MM d, yy",aX);if(aX.getFullYear()!==aW.getFullYear()){x.setInputValue($.datepicker.formatDate("D, M d, yy",aX))}else{x.setInputValue($.datepicker.formatDate("D, M d",aX))}x.clearErrorFlag();C();ag()};var ag=function(){if(U===""){$("#gqDateSummary").text("")}else{$("#gqDateSummary").text(U+GQueues.CalendarUtil.getFormattedTime(aH,n))}};var aL=function(){GQueues.AssignFilter.init();$("#gqAddAssignment").click(function(aY){var aZ=$(aY.target);GQueues.AssignFilter.setCallback(A);GQueues.AssignFilter.toggle(aZ);if(!$("#gqAssignFilter").hasClass("gq-hidden")){var aX=$("#gqAssignFilter").height();var aW=$("#gqAssignFilter").offset().top+aX-$("#gqChromePopup").height();if(aW>0){$("#gqSpacer").height(aW+20).removeClass("gq-hidden");$("html").bind("click.assignFilter",function(a0){if(aZ.parents("#gqAssignFilter").length===0){$("#gqSpacer").addClass("gq-hidden")}})}}else{$("#gqSpacer").addClass("gq-hidden")}return false});Y.click(function(aW){var aX=$(aW.target);if(aX.hasClass("gq-a-delete-hover")){aX.parents(".gq-i-assignment:first").remove()}});Y.mouseover(function(aW){var aX=$(aW.target);if(aX.hasClass("gq-a-icon")){aX.addClass("gq-a-delete-hover")}else{if(aX.hasClass("gq-a-name")){aX.siblings(".gq-a-icon").addClass("gq-a-delete")}}});Y.mouseout(function(aW){var aX=$(aW.target);if(aX.hasClass("gq-a-icon")){aX.removeClass("gq-a-delete-hover")}else{if(aX.hasClass("gq-a-name")){aX.siblings(".gq-a-icon").removeClass("gq-a-delete")}}})};var r=function(){GQueues.TagFilter.init();$("#gqAddTag").click(function(aY){var aZ=$(aY.target);GQueues.TagFilter.setCallback(an);GQueues.TagFilter.toggle(aZ);if(!$("#gqTagFilter").hasClass("gq-hidden")){var aX=$("#gqTagFilter").height();var aW=$("#gqTagFilter").offset().top+aX-$("#gqChromePopup").height();if(aW>0){$("#gqSpacer").height(aW+20).removeClass("gq-hidden");$("html").bind("click.tagFilter",function(a0){if(aZ.parents("#gqTagFilter").length===0){$("#gqSpacer").addClass("gq-hidden")}})}}else{$("#gqSpacer").addClass("gq-hidden")}return false});aB.click(function(aW){var aX=$(aW.target);if(aX.hasClass("gq-i-tag-delete")){aX.parents(".gq-i-tag:first").remove()}});aB.mouseover(function(aW){var aX=$(aW.target);if(aX.hasClass("gq-i-tag-delete")){aX.addClass("gq-i-tag-hover")}});aB.mouseout(function(aW){var aX=$(aW.target);if(aX.hasClass("gq-i-tag-delete")){aX.removeClass("gq-i-tag-hover")}})};var aR=function(){$("#gqDateCheckbox").click(au);$("#gqDateCheckboxLabel").click(function(){var aZ=$(event.target);aZ.parent().find("input").trigger("click");au()});ao.datepicker({onSelect:a,minDate:new Date(1900,1,1)});x=new GQueues.InputMenu({el:$("#gqDateInputMenu"),readonly:false,inputChangeHandler:ab,placeholderText:"Set a date",tabindex:2});var aW=[{itemValue:"noTime",itemText:"No time",itemHandler:aT},{itemValue:"12:00 AM",itemText:"12:00 AM"},{itemValue:"12:30 AM",itemText:"12:30 AM"},{itemValue:"1:00 AM",itemText:"1:00 AM"},{itemValue:"1:30 AM",itemText:"1:30 AM"},{itemValue:"2:00 AM",itemText:"2:00 AM"},{itemValue:"2:30 AM",itemText:"2:30 AM"},{itemValue:"3:00 AM",itemText:"3:00 AM"},{itemValue:"3:30 AM",itemText:"3:30 AM"},{itemValue:"4:00 AM",itemText:"4:00 AM"},{itemValue:"4:30 AM",itemText:"4:30 AM"},{itemValue:"5:00 AM",itemText:"5:00 AM"},{itemValue:"5:30 AM",itemText:"5:30 AM"},{itemValue:"6:00 AM",itemText:"6:00 AM"},{itemValue:"6:30 AM",itemText:"6:30 AM"},{itemValue:"7:00 AM",itemText:"7:00 AM"},{itemValue:"7:30 AM",itemText:"7:30 AM"},{itemValue:"8:00 AM",itemText:"8:00 AM"},{itemValue:"8:30 AM",itemText:"8:30 AM"},{itemValue:"9:00 AM",itemText:"9:00 AM"},{itemValue:"9:30 AM",itemText:"9:30 AM"},{itemValue:"10:00 AM",itemText:"10:00 AM"},{itemValue:"10:30 AM",itemText:"10:30 AM"},{itemValue:"11:00 AM",itemText:"11:00 AM"},{itemValue:"11:30 AM",itemText:"11:30 AM"},{itemValue:"12:00 PM",itemText:"12:00 PM"},{itemValue:"12:30 PM",itemText:"12:30 PM"},{itemValue:"1:00 PM",itemText:"1:00 PM"},{itemValue:"1:30 PM",itemText:"1:30 PM"},{itemValue:"2:00 PM",itemText:"2:00 PM"},{itemValue:"2:30 PM",itemText:"2:30 PM"},{itemValue:"3:00 PM",itemText:"3:00 PM"},{itemValue:"3:30 PM",itemText:"3:30 PM"},{itemValue:"4:00 PM",itemText:"4:00 PM"},{itemValue:"4:30 PM",itemText:"4:30 PM"},{itemValue:"5:00 PM",itemText:"5:00 PM"},{itemValue:"5:30 PM",itemText:"5:30 PM"},{itemValue:"6:00 PM",itemText:"6:00 PM"},{itemValue:"6:30 PM",itemText:"6:30 PM"},{itemValue:"7:00 PM",itemText:"7:00 PM"},{itemValue:"7:30 PM",itemText:"7:30 PM"},{itemValue:"8:00 PM",itemText:"8:00 PM"},{itemValue:"8:30 PM",itemText:"8:30 PM"},{itemValue:"9:00 PM",itemText:"9:00 PM"},{itemValue:"9:30 PM",itemText:"9:30 PM"},{itemValue:"10:00 PM",itemText:"10:00 PM"},{itemValue:"10:30 PM",itemText:"10:30 PM"},{itemValue:"11:00 PM",itemText:"11:00 PM"},{itemValue:"11:30 PM",itemText:"11:30 PM"},{itemValue:"customTime",itemText:"Custom",itemHandler:ae}];b=new GQueues.InputMenu({el:$("#gqTimeInputMenu"),readonly:false,inputChangeHandler:M,placeholderText:"Set a time",menuItems:aW,defaultMenuVal:L,alternativeMenuVal:S,tabindex:3});var aY=[{itemValue:"No reminder",itemText:"No reminder"},{itemValue:"Email reminder",itemText:"Email reminder"},{itemValue:"SMS reminder",itemText:"SMS reminder"},{itemValue:"Pop-up reminder",itemText:"Pop-up reminder"}];if(!B){aY.splice(2,1)}aJ=new GQueues.InputMenu({el:$("#gqReminderInputMenu"),readonly:true,inputChangeHandler:ak,placeholderText:"",menuItems:aY,defaultMenuVal:d,disabledHandler:k,tabindex:5});var aX=[{itemValue:"0 minutes",itemText:"0 minutes"},{itemValue:"5 minutes",itemText:"5 minutes"},{itemValue:"10 minutes",itemText:"10 minutes"},{itemValue:"15 minutes",itemText:"15 minutes"},{itemValue:"20 minutes",itemText:"20 minutes"},{itemValue:"30 minutes",itemText:"30 minutes"},{itemValue:"45 minutes",itemText:"45 minutes"},{itemValue:"1 hour",itemText:"1 hour"},{itemValue:"2 hours",itemText:"2 hours"},{itemValue:"3 hours",itemText:"3 hours"},{itemValue:"6 hours",itemText:"6 hours"},{itemValue:"12 hours",itemText:"12 hours"},{itemValue:"1 day",itemText:"1 day"},{itemValue:"2 days",itemText:"2 days"},{itemValue:"3 days",itemText:"3 days"},{itemValue:"4 days",itemText:"4 days"},{itemValue:"5 days",itemText:"5 days"},{itemValue:"6 days",itemText:"6 days"},{itemValue:"1 week",itemText:"1 week"},{itemValue:"customReminder",itemText:"Custom reminder",itemHandler:s}];ad=new GQueues.InputMenu({el:$("#gqReminderAmountInputMenu"),readonly:false,inputChangeHandler:J,placeholderText:"Set reminder",menuItems:aX,defaultMenuVal:m,tabindex:6});aM=new GQueues.InputMenu({el:$("#gqDurationInputMenu"),readonly:false,inputChangeHandler:ah,placeholderText:"Duration",menuItems:[],defaultMenuVal:H,tabindex:4});p();T()};var ab=function(aW,aY){var a0=$.trim(aW);var aX;if(a0.length===0){aX=new Date()}else{try{aX=GQueues.CalendarUtil.parseDateInput(a0)}catch(aZ){aX=null}}if(aX===null){x.setErrorFlag();x.selectInput();C()}else{ao.datepicker("setDate",aX);a()}};var C=function(){if(x.hasError()||b.hasError()||aJ.hasError()||ad.hasError()||aM.hasError()){E.attr("disabled","disabled")}else{E.removeAttr("disabled")}};var aN=function(aW){chrome.storage.sync.get(["GQ_STORAGE_AUTH_KEY","GQ_STORAGE_WEB_DEFAULT","GQ_STORAGE_USER_EMAIL","GQ_STORAGE_DEFAULT_QUEUE_KEY"],function(aX){var a0=aX.GQ_STORAGE_AUTH_KEY;y.authKey=a0;if(a0===undefined||a0===null||!a0){y.authKey=null}var aZ=aX.GQ_STORAGE_WEB_DEFAULT;y.webDefault=aZ;if(aZ===undefined||aZ===null||!aZ){y.webDefault=false}var aY=aX.GQ_STORAGE_USER_EMAIL;y.email=aY;if(aY===undefined||aY===null||aY){y.email=null}var a1=aX.GQ_STORAGE_DEFAULT_QUEUE_KEY;y.defaultQueueKey=a1;if(a1===undefined||a1===null||!a1){y.defaultQueueKey=null}aW()})};var ax=function(){GQueues.MessageBox.init();aN(function(){r();aL();aR();aw();aK();aD.click(i);at.click(O);$("#gqErrorRefresh").click(O);E.click(e);$("#gqCancelBtn").click(D);aE.keydown(function(aW){if(aW.keyCode===13){e()}});ar.change(function(){if(ar.attr("checked")){P()}else{G()}});chrome.runtime.sendMessage({action:"recordShowEvent"},function(aW){})})};return{init:function(){ax()},refreshContent:function(){O()},visibleMenu:function(){return aa},setVisibleMenu:function(aW){aa=aW}}}();$(GQueues.init);GQueues.AjaxQueue=function(){return{addRequest:function(a){return},completeRequest:function(){return}}}();GQueues.QueueContentPanel=function(){return{addListPadding:function(){return},removeListPadding:function(){return}}}();GQueues.TagQueuesPanel=function(){return{reload:function(){return},getTagStyle:function(a){return"gq-queue-bkgnd-31"}}}();GQueues.InputMenu=function(a){this.uuid=Date.now().toString()+"-"+Math.floor((Math.random()*1000000)+1).toString();this.wrapper=a.el;this.readonly=a.readonly;this.inputChangeHandler=a.inputChangeHandler;this.inputWrap=null;this.inputEl=null;this.menuWrap=null;this.menuEl=null;this.placeholderText=a.placeholderText;this.menuItems=a.menuItems;this.defaultMenuVal=a.defaultMenuVal;this.alternativeMenuVal=a.alternativeMenuVal;this.disabledHandler=a.disabledHandler;this.tabindex=a.tabindex;this.menuTop=null;this.toolTip=a.toolTip;this.calendarMenu=a.calendarMenu;this.defaultCalVal=a.defaultCalVal;this.calendarWrap=null;this.calendarBox=null;this.calendarEl=null;this.calendarTop=null;this.minDate=null;this.calendarWeekStart=a.calendarWeekStart;this.prevValue=null;this.contentContainer=a.contentContainer;this.init()};GQueues.InputMenu.prototype.init=function(){var a={thisObj:this};this.wrapper.addClass("gq-modern-input-menu").addClass(this.uuid);this.wrapper.append("<div class='gq-modern-input-wrap'></div>");this.inputWrap=this.wrapper.find(".gq-modern-input-wrap");this.inputWrap.append("<input class='gq-modern-input' placeholder='"+this.placeholderText+"' spellcheck='false' type='text'>");this.inputEl=this.inputWrap.find(".gq-modern-input");if(this.tabindex){this.inputEl.attr("tabindex",this.tabindex)}if(this.calendarMenu){this.inputWrap.addClass("calendar");this.wrapper.append("<div class='gq-modern-calendar-wrap gq-hidden'><div class='gq-modern-calendar-box'><div class='gq-modern-calendar'></div></div></div>");this.calendarWrap=this.wrapper.find(".gq-modern-calendar-wrap");this.calendarBox=this.wrapper.find(".gq-modern-calendar-box");this.calendarEl=this.calendarWrap.find(".gq-modern-calendar");this.calendarEl.datepicker({onSelect:function(){a.thisObj.handleDateSelected()},firstDay:a.thisObj.calendarWeekStart||0,dayNamesMin:["S","M","T","W","T","F","S"],minDate:new Date(1900,1,1)})}else{if(this.menuItems){this.inputWrap.addClass("menu");this.wrapper.append("<div class='gq-modern-menu-wrap gq-hidden'></div>");this.menuWrap=this.wrapper.find(".gq-modern-menu-wrap");this.menuWrap.append("<div class='gq-modern-menu'></div>");this.menuEl=this.menuWrap.find(".gq-modern-menu");this.setMenuItems(this.menuItems);this.menuEl.bind("mouseover",a,function(b){var c=$(b.target);if(c&&c.hasClass("gq-modern-menu-item")&&!c.hasClass("highlighted")){b.data.thisObj.menuEl.find(".highlighted").removeClass("highlighted");c.addClass("highlighted")}});this.menuEl.bind("mouseout",a,function(b){var c=$(b.target);if(c&&c.hasClass("gq-modern-menu-item")){c.removeClass("highlighted")}})}}if(this.readonly){this.inputEl.attr("readonly","readonly")}else{this.inputEl.bind("change",a,function(c){var b=c.data.thisObj.inputChangeHandler;if(b&&typeof b==="function"){return b(c.data.thisObj.inputEl.val(),c)}});this.inputEl.bind("blur",a,function(c){if(c.data.thisObj.inputEl.val().length===0){var b=c.data.thisObj.inputChangeHandler;if(b&&typeof b==="function"){return b("",c)}}})}this.inputEl.bind("focus",a,function(b){b.data.thisObj.prevValue=b.data.thisObj.inputEl.val()});this.inputWrap.bind("click",a,function(c){if(c.data.thisObj.disabled){var b=c.data.thisObj.disabledHandler;if(b&&typeof b==="function"){c.preventDefault();c.stopPropagation();c.stopImmediatePropagation();return b()}}else{if(c.data.thisObj.menuIsVisible()||c.data.thisObj.calendarIsVisible()){c.data.thisObj.hideMenu();c.data.thisObj.hideCalendar()}else{c.data.thisObj.showMenu();c.data.thisObj.showCalendar()}}});this.inputEl.bind("keydown",a,function(b){if(b.keyCode!==40&&b.keyCode!==38&&b.keyCode!==13){b.data.thisObj.hideMenu();b.data.thisObj.hideCalendar()}if(b.keyCode===13&&!b.shiftKey){if((b.data.thisObj.menuWrap&&b.data.thisObj.menuWrap.hasClass("gq-hidden"))||(b.data.thisObj.calendarWrap&&b.data.thisObj.calendarWrap.hasClass("gq-hidden"))){if(b.data.thisObj.prevValue!==b.data.thisObj.inputEl.val()){b.data.thisObj.inputEl.blur();b.data.thisObj.inputEl.focus()}else{b.data.thisObj.showMenu();b.data.thisObj.showCalendar();b.preventDefault();b.stopPropagation();b.stopImmediatePropagation();return false}}}});if(this.menuWrap){this.menuWrap.bind("click",a,function(c){var b=$(c.target).closest(".gq-modern-menu-item");c.data.thisObj.handleMenuSelection(b);c.preventDefault();c.stopPropagation();c.stopImmediatePropagation()})}};GQueues.InputMenu.prototype.setMenuItems=function(b){this.menuItems=b;this.menuEl.html("");var a=0;for(a=0;a<b.length;a++){this.menuEl.append("<div class='gq-modern-menu-item' data-menu-val='"+b[a].itemValue+"'>"+b[a].itemText+"</div>")}};GQueues.InputMenu.prototype.showMenu=function(){if(!this.menuWrap){return}this.menuWrap.removeClass("gq-hidden");this.menuEl.scrollTop(0);this.menuEl.css("top",0);this.menuEl.find(".highlighted").removeClass("highlighted");this.menuTop=this.menuEl.offset().top;var e=this.menuEl.outerHeight();var a=$(window).height();if(this.contentContainer){a=this.contentContainer.height();this.menuTop=this.menuTop-this.contentContainer.offset().top}var d=this.wrapper.outerHeight();if(this.menuTop+e>a){var i=(e*-1)-d-10;this.menuEl.css("top",i)}var h=this.inputEl.val();if(!h&&this.defaultMenuVal){h=this.defaultMenuVal()}var b=this.menuEl.find('.gq-modern-menu-item[data-menu-val="'+h+'"]');if(b.length===0&&this.alternativeMenuVal){b=this.menuEl.find('.gq-modern-menu-item[data-menu-val="'+this.alternativeMenuVal(h)+'"]')}if(b.length===0){b=this.menuEl.find(".gq-modern-menu-item:first")}if(b.length>0){var j=b.position().top;this.menuEl.scrollTop(j);b.addClass("highlighted")}var f={thisObj:this};var g="click."+this.uuid;$("html").bind(g,f,function(l){var m=$(l.target);var k=m.closest("."+l.data.thisObj.uuid);if(k.length===0){l.data.thisObj.hideMenu()}});var c="keydown."+this.uuid;$(document).bind(c,f,function(l){if(l.keyCode===40){l.data.thisObj.nextMenuItem();l.preventDefault();l.stopPropagation();l.stopImmediatePropagation();return false}else{if(l.keyCode===38){l.data.thisObj.prevMenuItem();l.preventDefault();l.stopPropagation();l.stopImmediatePropagation();return false}else{if(l.keyCode===13){var k=l.data.thisObj.menuEl.find(".gq-modern-menu-item.highlighted:first");if(k.length){l.data.thisObj.handleMenuSelection(k)}l.data.thisObj.hideMenu();l.preventDefault();l.stopPropagation();l.stopImmediatePropagation();return false}}}})};GQueues.InputMenu.prototype.hideMenu=function(){if(!this.menuWrap){return}this.menuWrap.addClass("gq-hidden");var a="keydown."+this.uuid;var b="click."+this.uuid;$("html").unbind(b);$(document).unbind(a)};GQueues.InputMenu.prototype.menuIsVisible=function(){if(!this.menuWrap){return false}if(this.menuWrap.hasClass("gq-hidden")){return false}else{return true}};GQueues.InputMenu.prototype.nextMenuItem=function(){var c=false;var f=this.menuEl.find(".gq-modern-menu-item.highlighted");if(f.length){f.nextAll(".gq-modern-menu-item:first").addClass("highlighted");f.removeClass("highlighted")}else{var g=this.inputEl.val();if(!g){g=this.defaultMenuVal()}var b=this.menuEl.find('.gq-modern-menu-item[data-menu-val="'+g+'"]');if(b.length===0&&this.alternativeMenuVal){b=this.menuEl.find('.gq-modern-menu-item[data-menu-val="'+this.alternativeMenuVal(g)+'"]')}b.addClass("highlighted")}if(!this.menuEl.find(".gq-modern-menu-item.highlighted").length){this.menuEl.find(".gq-modern-menu-item:first").addClass("highlighted");c=true}var a=this.menuEl.find(".highlighted");if(c){this.menuEl.stop().clearQueue().animate({scrollTop:0},500,"swing")}else{if(a.length){var e=30;var d=a.offset().top-this.menuTop;if(d+a.height()+e>this.menuEl.height()){this.menuEl.stop().clearQueue().animate({scrollTop:this.menuEl.scrollTop()+Math.floor(this.menuEl.height()/2)-e},500,"swing")}}}};GQueues.InputMenu.prototype.prevMenuItem=function(){var c=false;var g=this.menuEl.find(".gq-modern-menu-item.highlighted");if(g.length){g.prevAll(".gq-modern-menu-item:first").addClass("highlighted");g.removeClass("highlighted")}if(!this.menuEl.find(".gq-modern-menu-item.highlighted").length){this.menuEl.find(".gq-modern-menu-item:last").addClass("highlighted");c=true}var b=this.menuEl.find(".highlighted");if(c){var a=this.menuEl.find(".gq-modern-menu-item");var e=a.length*a.first().outerHeight();this.menuEl.stop().clearQueue().animate({scrollTop:e},500,"swing")}else{if(b.length){var f=20;var d=b.offset().top-this.menuTop;if(d<f){this.menuEl.stop().clearQueue().animate({scrollTop:this.menuEl.scrollTop()-Math.floor(this.menuEl.height()/2)+f},500,"swing")}}}};GQueues.InputMenu.prototype.handleMenuSelection=function(c){var d=c.attr("data-menu-val");var a;var b;for(b=0;b<this.menuItems.length;b++){if(this.menuItems[b].itemValue===d){a=this.menuItems[b].itemHandler;break}}if(a){a()}else{this.prevValue=d;this.inputEl.val(d);if(this.toolTip){this.inputWrap.attr("title",d)}this.menuWrap.addClass("gq-hidden");this.inputChangeHandler(this.inputEl.val(),null)}};GQueues.InputMenu.prototype.showCalendar=function(){if(!this.calendarWrap){return}this.calendarWrap.removeClass("gq-hidden");this.calendarBox.css("top",0);this.calendarTop=this.calendarBox.offset().top;var i=this.calendarBox.outerHeight();var h=$(window).height();if(this.contentContainer){h=this.contentContainer.height();this.menuTop=this.menuTop-this.contentContainer.offset().top}var d=this.wrapper.outerHeight();if(this.calendarTop+i>h){var a=(i*-1)-d-5;this.calendarBox.css("top",a)}if(this.defaultCalVal&&typeof this.defaultCalVal==="function"){try{var c=this.defaultCalVal();this.calendarEl.datepicker("setDate",c)}catch(f){this.calendarEl.datepicker("setDate",new Date())}}else{this.calendarEl.datepicker("setDate",new Date())}var g={thisObj:this};var b="click."+this.uuid;$("html").bind(b,g,function(j){var k=$(j.target);var e=k.closest("."+j.data.thisObj.uuid);if(e.length===0&&k.closest(".ui-datepicker-prev").length===0&&k.closest(".ui-datepicker-next").length===0&&k.parents(".ui-datepicker-calendar").length===0){j.data.thisObj.hideCalendar();$("html").unbind(b)}})};GQueues.InputMenu.prototype.hideCalendar=function(){if(!this.calendarWrap){return}this.calendarWrap.addClass("gq-hidden");var a="keydown."+this.uuid;$(document).unbind(a)};GQueues.InputMenu.prototype.calendarIsVisible=function(){if(!this.calendarWrap){return false}if(this.calendarWrap.hasClass("gq-hidden")){return false}else{return true}};GQueues.InputMenu.prototype.setCalendarMinDate=function(a){this.minDate=a;this.calendarEl.datepicker("option","minDate",this.minDate)};GQueues.InputMenu.prototype.handleDateSelected=function(){var a=this.calendarEl.datepicker("getDate");a=$.datepicker.formatDate("M d, yy",a);this.inputEl.val(a);this.calendarWrap.addClass("gq-hidden");this.inputChangeHandler(this.inputEl.val(),null)};GQueues.InputMenu.prototype.getInputValue=function(){return this.inputEl.val()};GQueues.InputMenu.prototype.setInputValue=function(a){this.inputEl.val(a);if(this.toolTip){this.inputWrap.attr("title",a)}};GQueues.InputMenu.prototype.selectInput=function(){this.inputEl.select()};GQueues.InputMenu.prototype.focusInput=function(){this.inputEl.focus()};GQueues.InputMenu.prototype.setErrorFlag=function(){this.inputEl.addClass("error");this.inputEl.select()};GQueues.InputMenu.prototype.clearErrorFlag=function(){this.inputEl.removeClass("error")};GQueues.InputMenu.prototype.hasError=function(){return this.inputEl.hasClass("error")};GQueues.InputMenu.prototype.setDisabled=function(a){this.disabled=a;if(a){this.inputWrap.addClass("disabled")}else{this.inputWrap.removeClass("disabled")}};GQueues.InputMenu.prototype.setVisible=function(a){if(a){this.wrapper.removeClass("gq-invisible")}else{this.wrapper.addClass("gq-invisible")}};GQueues.InputMenu.prototype.setCalendarWeekStart=function(a){this.calendarEl.datepicker("option","firstDay",a)};GQueues.TagFilter=function(){var b;var i;var k;var a;var x;var r;var s="create / add";var v=null;var y=null;var p;var o=null;var A=function(){a.removeClass("gq-hidden");x.removeClass("gq-hidden");r.addClass("gq-hidden").html("").attr("raw","");i.val(s).addClass("gq-tf-label");$("#gqTagFilter li").removeClass("gq-tf-hover");$("#gqTagFilter .gq-tf-tag").each(function(){var E=$(this);E.text(E.attr("raw")).removeClass("gq-hidden")});var D=i.get(0);if(D.setSelectionRange){D.focus();D.setSelectionRange(0,0)}else{if(D.createTextRange){var C=D.createTextRange();C.collapse(true);C.moveEnd("character",0);C.moveStart("character",0);C.select()}}};var c=function(C){if(!v||v.get(0)!==C.get(0)||b.hasClass("gq-hidden")){t(C)}else{d()}};var t=function(E){if(GQueues.visibleMenu()){GQueues.visibleMenu().hide()}GQueues.Util.beginEditMode();GQueues.setVisibleMenu(GQueues.TagFilter);v=E;p=E.parent();b.removeClass();var G=/gq-queue-bkgnd-\d\d?/i;var C=E.parents(".gq-item-row:first");if(C.length>0){var D=C.attr("className").match(G);if(!D){D=$("#gqItemList").attr("className").match(G)}if(D){b.addClass(D[0])}}var F=v.offset();b.removeClass("gq-hidden");b.css("top",F.top+v.outerHeight()-1);b.css("left",F.left-b.outerWidth()+v.outerWidth());GQueues.QueueContentPanel.addListPadding(E,b);A();e();$("html").bind("click.tagFilter",function(H){var I=$(H.target);if(I.parents("#gqTagFilter").length===0){d()}})};var d=function(){l();b.addClass("gq-hidden");i.blur();$("html").unbind("click.tagFilter");$("html").find(".gq-tag-filter-on").removeClass("gq-tag-filter-on");GQueues.QueueContentPanel.removeListPadding();GQueues.setVisibleMenu(null);GQueues.Util.finishEditMode()};var f=function(J,I,G){var E=false;var D;if(I){p=I}p.find(".gq-i-tag-content").each(function(){if(!E&&$(this).text()===J){E=true}if(!D&&J<$(this).text()){D=$(this).parent()}});if(!E){var C=k.html();if(D){D.before(C);D.prev().find(".gq-i-tag-content").text(J);D.prev().addClass(GQueues.TagQueuesPanel.getTagStyle(J)).attr("uni",GQueues.Util.getUnicodeRep(J))}else{p.append(C);p.find(":last-child .gq-i-tag-content").text(J);p.find(":last-child").addClass(GQueues.TagQueuesPanel.getTagStyle(J)).attr("uni",GQueues.Util.getUnicodeRep(J))}p.parents(".gq-item-container:first").attr("tagsExist","true");var H=J;var F=p;GQueues.AjaxQueue.addRequest(function(){w(H,F,G)})}if(o){o()}d()};var w=function(F,E,C){var D=E.parents(".gq-item-row:first").attr("id");if(!D){D=""}$.ajax({type:"POST",cache:false,url:"/tags/"+encodeURIComponent(F),data:{action:"new",key:D,clientId:GQueues.config.clientId},success:function(){if(!C){GQueues.TagQueuesPanel.reload()}},error:function(G,I,H){if(G.status===401){GQueues.MessageBox.showSessionExpired()}else{E.find(":last-child").remove();GQueues.MessageBox.show({title:"Shucks!",text:"There was a problem adding the tag.  Please try again.",okBtn:true,cancelBtn:false})}},complete:function(){GQueues.AjaxQueue.completeRequest()}})};var j=function(C){var D=C.attr("raw");if(D){B(D)}else{B(C.text())}};var B=function(C,H){var G=C.toLowerCase();var D;var J;var F=false;var I=false;var E=false;var K;$("#gqTagFilter .gq-tf-tag").each(function(){if(!E){D=$(this);J=D.text();currItemTextLower=J.toLowerCase();if(G<currItemTextLower){K=$("<li class='gq-tf-tag'>"+GQueues.Util.htmlEscape(C)+"</li>");K.attr("raw",C);D.before(K);F=true;E=true}else{if(G===currItemTextLower){C=J;I=true;E=true}}}});if(!F&&!I){K=$("<li class='gq-tf-tag'>"+GQueues.Util.htmlEscape(C)+"</li>");K.attr("raw",C);$("#gqTagFilter .gq-tf-create").before(K)}if(!H){f(C)}};var m=function(D,E){var C;$("#gqTagFilter .gq-tf-tag").each(function(){C=$(this);if(C.attr("raw")===D){C.attr("raw",E).text(E);return false}})};var h=function(D){var C;$("#gqTagFilter .gq-tf-tag").each(function(){C=$(this);if(C.attr("raw")===D){C.remove();return false}})};var u=function(){d();GQueues.Settings.show("#gqSettingsTags")};var z=function(){var C=$("#gqTagFilter li.gq-tf-hover");if(C.length){C.prevAll("li:not(.gq-tf-separator, .gq-hidden):first").addClass("gq-tf-hover");C.removeClass("gq-tf-hover")}else{$("#gqTagFilter li:not(.gq-tf-separator, .gq-hidden):last").addClass("gq-tf-hover")}};var g=function(){var C=$("#gqTagFilter li.gq-tf-hover");if(C.length){C.nextAll("li:not(.gq-tf-separator, .gq-hidden):first").addClass("gq-tf-hover");C.removeClass("gq-tf-hover")}else{$("#gqTagFilter li:not(.gq-tf-separator, .gq-hidden):first").addClass("gq-tf-hover")}};var e=function(){var G=new RegExp("(\\b)","ig");var D=null;var E=null;var C=null;var F;i.bind("keydown.tagInput",function(I){F=I.keyCode;if(F===38||(F===9&&I.shiftKey)){z();I.preventDefault();I.stopPropagation();I.stopImmediatePropagation();return false}else{if(F===40||F===9){g();I.preventDefault();I.stopPropagation();I.stopImmediatePropagation();return false}else{if(F===13){var H=$("#gqTagFilter li.gq-tf-hover:first");if(H.length){if(H.hasClass("gq-tf-create")){j(H)}else{if(H.hasClass("gq-tf-manage")){u()}else{f(H.text(),null,true)}}}else{if(i.val()===s){$(this).val("").removeClass("gq-tf-label");return}B(i.val())}}else{if(F!==16&&i.val()===s){$(this).val("").removeClass("gq-tf-label")}}}}});i.bind("keyup.tagInput",function(I){F=I.keyCode;buffer=i.val();htmlEscapedBuffer=GQueues.Util.htmlEscape(buffer);if(buffer&&buffer!==s){a.addClass("gq-hidden");x.addClass("gq-hidden");r.html('<strong>"'+htmlEscapedBuffer+'"</strong> (create tag)');r.attr("raw",buffer);r.removeClass("gq-hidden");var H=GQueues.Util.htmlEscape(buffer);H=GQueues.Util.regExpEscape(H);bufferLower=htmlEscapedBuffer.toLowerCase();$("#gqTagFilter .gq-tf-tag").each(function(){E=$(this);C=GQueues.Util.htmlEscape(E.attr("raw"));G.compile("("+H+")","ig");if(G.test(C)){if(C.toLowerCase()===bufferLower){r.addClass("gq-hidden")}E.removeClass("gq-hidden");C=C.replace(G,"<strong>$1</strong>");E.html(C)}else{E.addClass("gq-hidden")}});if(F!==9&&F!==38&&F!==40&&F!==13){$("#gqTagFilter li").removeClass("gq-tf-hover");$("#gqTagFilter li:not(.gq-tf-separator, .gq-hidden):first").addClass("gq-tf-hover")}}else{if(buffer!==s){A()}}})};var l=function(){i.unbind("keyup.tagInput");i.unbind("keydown.tagInput")};var q=function(){if(!b.hasClass("gq-hidden")){y=v.offset().top;if(y<GQueues.listViewportTop()||y+24>GQueues.listViewportBottom()){d()}else{b.css("top",v.offset().top+24)}}};var n=function(){b=$("#gqTagFilter");i=$("#gqTagFilter input:first");k=$("#gqTagTemplate");a=$("#gqTagFilter .gq-tf-separator");x=$("#gqTagFilter .gq-tf-manage");r=$("#gqTagFilter .gq-tf-create");b.mouseover(function(C){var D=$(C.target);if(D){if(D.get(0).nodeName==="LI"&&!D.hasClass("gq-tf-separator")){D.addClass("gq-tf-hover")}}});b.mouseout(function(C){var D=$(C.target);if(D){if(D.get(0).nodeName==="LI"){D.removeClass("gq-tf-hover")}}});b.click(function(C){var D=$(C.target);if(D){if(D.hasClass("gq-tf-manage")){u();return false}else{if(D.hasClass("gq-tf-tag")){f(D.text())}else{if(D.hasClass("gq-tf-create")){j(D)}}}}})};return{init:function(){n()},createTagFromText:function(C){B(C,true)},updateTag:function(C,D){m(C,D)},deleteTag:function(C){h(C)},addTag:function(C,E,D){f(C,E,D)},setCallback:function(C){o=C},hide:function(){d()},toggle:function(C){c(C)},handleScroll:function(){q()}}}();GQueues.AssignFilter=function(){var b;var h;var f;var a;var u;var z;var o;var p="type email / name";var t=null;var x=null;var j;var m=null;var A=function(){a.removeClass("gq-hidden");u.removeClass("gq-hidden");o.addClass("gq-hidden").html("").attr("raw","");h.val(p).addClass("gq-tf-label");b.find("li").removeClass("gq-tf-hover");b.find(".gq-tf-option").each(function(){var G=$(this);G.text(G.attr("raw")).removeClass("gq-hidden")});var F=h.get(0);if(F.setSelectionRange){F.focus();F.setSelectionRange(0,0)}else{if(F.createTextRange){var E=F.createTextRange();E.collapse(true);E.moveEnd("character",0);E.moveStart("character",0);E.select()}}};var w=function(){b.find(".gq-tf-error").removeClass("gq-hidden");A()};var c=function(E){if(!t||t.get(0)!==E.get(0)||b.hasClass("gq-hidden")){q(E)}else{d()}};var q=function(G){if(GQueues.visibleMenu()){GQueues.visibleMenu().hide()}GQueues.Util.beginEditMode();GQueues.setVisibleMenu(GQueues.AssignFilter);t=G;j=G.siblings("table");b.removeClass();var I=/gq-queue-bkgnd-\d\d?/i;var E=G.parents(".gq-item-row:first");if(E.length>0){var F=E.attr("className").match(I);if(!F){F=$("#gqItemList").attr("className").match(I)}if(F){b.addClass(F[0])}}var H=t.offset();b.removeClass("gq-hidden");b.css("top",H.top+t.outerHeight()-1);b.css("left",H.left-b.outerWidth()+t.outerWidth());b.css("min-width",b.width());GQueues.QueueContentPanel.addListPadding(G,b);A();e();$("html").bind("click.assignFilter",function(J){var K=$(J.target);if(K.parents("#gqAssignFilter").length===0){d()}})};var d=function(){i();b.addClass("gq-hidden");h.blur();$("html").unbind("click.assignFilter");$("html").find(".gq-assign-filter-on").removeClass("gq-assign-filter-on");GQueues.QueueContentPanel.removeListPadding();GQueues.setVisibleMenu(null);GQueues.Util.finishEditMode()};var B=function(F){if(F){if(j.find(".gq-a-name[title='"+F+"']").length===0){var G=f.clone();G.find(".gq-a-icon").addClass("gq-a-adding").html("<div></div>");G=G.find("tr");j.append(G);var H=F;var E=j;if(!m){GQueues.AjaxQueue.addRequest(function(){v(H,E,G)})}}}if(m){m(F)}d()};var C=function(G,H){var K=H.toLowerCase();var E;var F;var I=false;var J=false;var L=false;b.find(".gq-tf-option").each(function(){if(!L){E=$(this);F=E.text();currItemTextLower=F.toLowerCase();if(K<currItemTextLower){E.before("<li class='gq-tf-option' raw='"+H+"' email='"+G+"'>"+H+"</li>");I=true;L=true}else{if(K===currItemTextLower){tagText=F;J=true;L=true}}}});if(!I&&!J){b.find(".gq-tf-create").before("<li class='gq-tf-option' raw='"+H+"' email='"+G+"'>"+H+"</li>")}};var v=function(E,G,F){var H=G.parents(".gq-item-row:first").attr("id");if(!H){H=""}$.ajax({type:"POST",cache:false,url:"/assignments/",data:{action:"new",key:H,email:E,clientId:GQueues.config.clientId},dataType:"json",success:function(I){l(I,F)},error:function(I,K,J){if(I.status===401){GQueues.MessageBox.showSessionExpired()}else{G.find("tr:last-child").remove();GQueues.MessageBox.show({title:"Shucks!",text:"There was a problem adding the assignment.  Please try again.",okBtn:true,cancelBtn:false})}},complete:function(){GQueues.AjaxQueue.completeRequest()}})};var l=function(G,F){if(G.error){F.find(".gq-a-comment").remove();F.find(".gq-a-name").attr("colspan","2").html(G.error);F.find(".gq-a-icon").removeClass("gq-a-adding").addClass("gq-a-error").html("");setTimeout(function(){F.remove()},3500)}else{var E=G.name;if(!E){E=G.email}F.find(".gq-a-name").text(E).attr("title",G.email);F.find(".gq-a-icon").removeClass("gq-a-adding").addClass("gq-a-open").html("");F.attr("key",G.key);F.parents(".gq-item-container:first").attr("assignExist","true");if(G.filterName){C(G.email,G.filterName)}}};var s=function(){d();GQueues.Settings.show("#gqSettingsAssignments")};var D=function(){d();GQueues.ContactsDialog.show(B)};var y=function(){var E=b.find("li.gq-tf-hover");if(E.length){E.prevAll("li:not(.gq-tf-separator, .gq-hidden):first").addClass("gq-tf-hover");E.removeClass("gq-tf-hover")}else{b.find("li:not(.gq-tf-separator, .gq-hidden):last").addClass("gq-tf-hover")}};var g=function(){var E=b.find("li.gq-tf-hover");if(E.length){E.nextAll("li:not(.gq-tf-separator, .gq-hidden):first").addClass("gq-tf-hover");E.removeClass("gq-tf-hover")}else{b.find("li:not(.gq-tf-separator, .gq-hidden):first").addClass("gq-tf-hover")}};var e=function(){var I=new RegExp("(\\b)","ig");var F=null;var G=null;var E=null;var H;h.bind("keydown.assignInput",function(K){b.find(".gq-tf-error").addClass("gq-hidden");H=K.keyCode;if(H===38||(H===9&&K.shiftKey)){y();K.preventDefault();K.stopPropagation();K.stopImmediatePropagation();return false}else{if(H===40||H===9){g();K.preventDefault();K.stopPropagation();K.stopImmediatePropagation();return false}else{if(H===13){var J=b.find("li.gq-tf-hover:first");if(J.length){if(J.hasClass("gq-tf-create")){if(GQueues.Util.emailValid(J.attr("raw"))){B(J.attr("raw"))}else{w()}}else{if(J.hasClass("gq-tf-manage")){s()}else{B(J.attr("email"))}}}else{if(GQueues.Util.emailValid(h.val())){B(h.val())}else{w()}}}else{if(H!==16&&h.val()===p){$(this).val("").removeClass("gq-tf-label")}}}}});h.bind("keyup.assignInput",function(K){buffer=h.val();htmlEscapedBuffer=GQueues.Util.htmlEscape(buffer);if(buffer&&buffer!==p){a.addClass("gq-hidden");u.addClass("gq-hidden");o.html('<strong>"'+htmlEscapedBuffer+'"</strong> (new email)');o.attr("raw",buffer);o.removeClass("gq-hidden");var J=GQueues.Util.htmlEscape(buffer);J=GQueues.Util.regExpEscape(J);bufferLower=htmlEscapedBuffer.toLowerCase();b.find(".gq-tf-option").each(function(){G=$(this);E=GQueues.Util.htmlEscape(G.attr("raw"));I.compile("("+J+")","ig");if(I.test(E)){if(E.toLowerCase()===bufferLower){o.addClass("gq-hidden")}G.removeClass("gq-hidden");E=E.replace(I,"<strong>$1</strong>");G.html(E)}else{G.addClass("gq-hidden")}});if(H!==9&&H!==38&&H!==40&&H!==13){$("#gqAssignFilter li").removeClass("gq-tf-hover");$("#gqAssignFilter li:not(.gq-tf-separator, .gq-hidden):first").addClass("gq-tf-hover")}}else{if(buffer!==p){A()}}})};var r=function(F){var E=$('#gqAssignFilter .gq-tf-option[email="'+F+'"]');E.remove()};var i=function(){h.unbind("keyup.assignInput");h.unbind("keydown.assignInput")};var n=function(){if(!b.hasClass("gq-hidden")){x=t.offset().top;if(x<GQueues.listViewportTop()||x+24>GQueues.listViewportBottom()){d()}else{b.css("top",t.offset().top+24)}}};var k=function(){b=$("#gqAssignFilter");h=$("#gqAssignFilter input:first");f=$("#gqAssignTemplate");a=$("#gqAssignFilter .gq-tf-separator");u=$("#gqAssignFilter .gq-tf-manage");z=$("#gqAssignFilter .gq-tf-contacts");o=$("#gqAssignFilter .gq-tf-create");b.mouseover(function(E){var F=$(E.target);if(F){if(F.get(0).nodeName==="LI"&&!F.hasClass("gq-tf-separator")){F.addClass("gq-tf-hover")}}});b.mouseout(function(E){var F=$(E.target);if(F){if(F.get(0).nodeName==="LI"){F.removeClass("gq-tf-hover")}}});b.click(function(E){var F=$(E.target);if(F){if(F.hasClass("gq-tf-manage")){s();return false}else{if(F.hasClass("gq-tf-contacts")){D();return false}else{if(F.hasClass("gq-tf-option")){B(F.attr("email"))}else{if(F.hasClass("gq-tf-create")){if(GQueues.Util.emailValid(F.attr("raw"))){B(F.attr("raw"))}else{w()}}}}}}})};return{init:function(){k()},updateAssignFilter:function(E,F){C(E,F)},deleteAssignee:function(E){r(E)},setCallback:function(E){m=E},hide:function(){d()},setAssignmentInfo:function(F,E){l(F,E)},toggle:function(E){c(E)},handleScroll:function(){n()}}}();GQueues.MessageBox=function(){var j=null;var i=null;var g=null;var c=function(){k();if(j&&typeof j==="function"){j()}};var a=function(){k();if(i&&typeof i==="function"){i()}};var e=function(){k();if(g&&typeof g==="function"){g()}};var h=function(m){b();var n=$("#gqMessageBox");$("#gqMessageBox .gq-dialog-title").text(m.title);$("#gqMessageBox .gq-dialog-text").html(m.text);if(m.url){$("#gqMessageBox .gq-dialog-text").load(m.url)}if(m.width){n.width(m.width)}if(m.height){n.height(m.height)}if(m.okBtnText){$("#gqMessageBoxOkBtn").text(m.okBtnText)}if(!m.okBtn){$("#gqMessageBoxOkBtn").addClass("gq-hidden")}if(m.ok2Btn){$("#gqMessageBoxOk2Btn").removeClass("gq-hidden")}if(m.ok2BtnText){$("#gqMessageBoxOk2Btn").text(m.ok2BtnText)}if(m.cancelBtnText){$("#gqMessageBoxCancelBtn").text(m.cancelBtnText)}if(!m.cancelBtn){$("#gqMessageBoxCancelBtn").addClass("gq-hidden")}if(m.callback){j=m.callback}if(m.callback2){i=m.callback2}if(m.cancelCallback){g=m.cancelCallback}if(m.scrollOverflow){var p=$(window).height()-200;$("#gqMessageBox .gq-dialog-text").css("max-height",p).css("overflow-y","auto")}n.removeClass("gq-hidden");GQueues.Util.showModalBkgnd();var o=($(window).height()-n.height())/2+$(window).scrollTop();var q=($(window).width()-n.width())/2;n.css("top",o);n.css("left",q);if(m.okBtn){$("#gqMessageBoxOkBtn").focus()}$(window).bind("keydown.msgbox",function(r){if(r.keyCode===27){k();r.preventDefault();r.stopPropagation();return false}})};var k=function(){$(window).unbind("keydown.msgbox");$("#gqMessageBox").addClass("gq-hidden");GQueues.Util.hideModalBkgnd();$(window).focus()};var b=function(){$("#gqMessageBox .gq-dialog-title").text("");$("#gqMessageBox .gq-dialog-text").text("");$("#gqMessageBoxOkBtn").removeClass("gq-hidden").text("OK");$("#gqMessageBoxCancelBtn").removeClass("gq-hidden").text("Cancel");$("#gqMessageBoxOk2Btn").addClass("gq-hidden").text("");$("#gqMessageBox").height("");$("#gqMessageBox").width("");j=null;i=null;g=null};var l=function(){h({title:"Hold up...",text:"Your session has expired, please sign in again to continue.",okBtn:true,cancelBtn:false,callback:function(){GQueues.Util.showModalBkgnd();window.location.reload(true)}})};var d=function(){h({title:"Sorry...",text:"You are not currently authorized to complete this action.",okBtn:true,cancelBtn:false,callback:function(){GQueues.Util.showModalBkgnd();window.location.reload(true)}})};var f=function(){$("#gqMessageBoxOkBtn").click(function(){c();return false});$("#gqMessageBoxOk2Btn").click(function(){a();return false});$("#gqMessageBoxCancelBtn").click(function(){e();return false})};return{init:function(){f()},show:function(m){h(m)},showSessionExpired:function(){l()},showUnauthorized:function(){d()},hide:function(){k()}}}();GQueues.Util=function(){var NO_DATE=999999999999999;var _inEditMode=0;var _refreshOnHold=false;var _tempKeyMapping={};var _convertLinks=function(text){var exp=/(\b(https?|ftp|file|brain|evernote|thunderlink):\/\/[\-A-Z0-9+&@#\/%?()=~_|!:,.;\*]*[\-A-Z0-9+&@#\/%()=~_|])/ig;var imgExp=/(?=>)([^<]*\.(JPG|JPEG|PNG|GIF|BMP|WEBP)(?=<))/ig;var linkText=text.replace(exp,'<a href="$1" target="_blank">$1</a>');var fixExp=/<img src=">/ig;linkText=linkText.replace(imgExp,'"><span$1</span><img src="$1" />');return linkText.replace(fixExp,'<img src="')};var _convertLineBreaks=function(text){var exp=/(\r\n|\r|\n)/g;return text.replace(exp,"$1<br />")};var _stripLineBreaks=function(text){return text.replace(/<br \/>/g,"")};var _regExpEscape=function(str){return String(str).replace(/([\-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")};var _htmlEscape=function(str){return str.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;")};var _emailValid=function(str){var emailPattern=/^([a-zA-Z0-9])+([\.a-zA-Z0-9_\-\+])*@([a-zA-Z0-9\-])+(\.[a-zA-Z0-9_\-]+)+$/;return emailPattern.test(str)};var _getUnicodeRep=function(str){var rep=[];var length=str.length;var index=0;while(index<length){rep.push(str.charCodeAt(index));index+=1}return rep.join("")};var _getTempId=function(){var tempId=new Date().getTime();tempId+="-"+Math.floor((Math.random()*1000000)+1);return tempId};var _setTempKeyMapping=function(tempKey,realKey){_tempKeyMapping[tempKey]=realKey};var _getRealKeyForTemp=function(tempKey){return _tempKeyMapping[tempKey]};var _beginEditMode=function(){_inEditMode+=1};var _finishEditMode=function(){_inEditMode-=1;if(_refreshOnHold&&!_inEditMode){_refreshOnHold=false;GQueues.AjaxQueue.addRequest(function(){GQueues.QueueContentPanel.refreshQueue(null,true)})}};var _activateTextarea=function(p_field,path,key,defaultText,charLimit,changeCallback,queueKey,prevItem){_beginEditMode();$(".gq-field-edit textarea, .gq-field-edit input").blur();var field=p_field;var config=eval("("+field.attr("config")+")");var oldValue=field.html();var textareaValue=field.text();var fieldParent;field.addClass("gq-field-edit");var oldHeight=field.height();if(textareaValue===defaultText){textareaValue="";field.removeClass("gq-i-empty")}var newArea=$(document.createElement("textarea"));newArea.val(textareaValue);field.html(newArea);var inputField=field.find("textarea");inputField.height(oldHeight);inputField.limit({limit:charLimit});inputField.focus();inputField.focus();inputField.focus();var inputEl=inputField.get(0);if(inputEl.setSelectionRange){inputEl.focus();inputEl.select();inputEl.setSelectionRange(inputEl.selectionEnd,inputEl.selectionEnd)}else{if(inputEl.createTextRange){var range=inputEl.createTextRange();range.collapse(true);range.move("character",inputEl.value.length);range.select()}}if(!key){fieldParent=field.parents(".gq-item-row:first")}inputField.one("blur",function(){field.removeClass("gq-field-edit");var newValue=_htmlEscape($(this).val());$(this).remove();if($.trim(newValue).length<=0){field.html(defaultText);newValue="";if(oldValue===defaultText){oldValue=""}field.addClass("gq-i-empty")}else{newValue=_convertLinks(newValue);field.html(newValue)}if(newValue!==oldValue||queueKey){var fieldName=config.name;postObj={};postObj[fieldName]=newValue;postObj.clientId=GQueues.config.clientId;if(queueKey){postObj.key=queueKey}var p_path=path;var p_key=key;var p_fieldParent=fieldParent;var p_postObj=postObj;var p_changeCallback=changeCallback;var p_prevItem=prevItem;GQueues.AjaxQueue.addRequest(function(){_postTextarea(p_path,p_key,p_fieldParent,p_postObj,p_changeCallback,p_prevItem)})}else{_finishEditMode()}})};var _postTextarea=function(path,key,fieldParent,postObj,changeCallback,prevItem){if(fieldParent){key=fieldParent.attr("id")}if(fieldParent&&fieldParent.parent(".gq-i-sub-items").length>0){postObj.parentKey=fieldParent.parents(".gq-item-row:first").attr("id")}if(prevItem){postObj.prevItemKey=prevItem.attr("id")}postObj.specific="True";$.ajax({type:"POST",cache:false,url:path+key,data:postObj,dataType:"json",success:function(data){_finishEditMode();if(changeCallback){changeCallback(data)}GQueues.AjaxQueue.completeRequest()},error:function(request,textStatus,errorThrown){_handleAjaxError(request,"There was a problem saving this text.  Please try again")}})};var _activateEdit=function(field,path,changeCallback){_beginEditMode();var config=eval("("+field.attr("config")+")");var oldValue=field.text();var key="";if(config.key){key=config.key}else{if(field.attr("key")){key=field.attr("key")}}field.addClass("gq-field-edit");field.html('<input type="'+config.type+'" id="'+field.attr("id")+"_"+config.type+'" maxlength="'+config.maxLength+'">');var inputField=field.find("input");inputField.val(oldValue);inputField.focus();inputField.select();inputField.one("blur change",function(){field.removeClass("gq-field-edit");var newValue=$(this).val();field.html(_htmlEscape(newValue));if(newValue!==oldValue){var fieldName=config.name;var postObj={};postObj[fieldName]=newValue;postObj.clientId=GQueues.config.clientId;if(config.nopost==="true"){_finishEditMode();if(changeCallback){changeCallback()}}else{$.ajax({type:"POST",cache:false,url:path+encodeURIComponent(key),data:postObj,success:function(data){_finishEditMode();if(changeCallback){changeCallback(data)}},error:function(request,textStatus,errorThrown){_handleAjaxError(request,"There was a problem saving this text.  Please try again")}})}}else{_finishEditMode()}})};var _expandPanel=function(target){target.removeClass("collapsed");target.parents(".gq-queue-panel-header:first").siblings("div.gq-queue-panel-content-container:first").show()};var _togglePanel=function(target){target.toggleClass("collapsed");target.parents(".gq-queue-panel-header:first").siblings("div.gq-queue-panel-content-container:first").toggle();var panel=target.parents(".gq-queue-panel:first").attr("type");$.ajax({type:"POST",url:"/settings",data:{action:"panelCollapse",panel:panel,collapse:target.hasClass("collapsed")}})};var _hidePanel=function(panelEl,hidden){if(hidden==="true"){panelEl.addClass("gq-hidden")}else{panelEl.removeClass("gq-hidden")}$.ajax({type:"POST",url:"/settings",data:{action:"panelHide",panel:panelEl.attr("type"),hidden:hidden}})};var _showObjectMenu=function(menu,menuBtn,row,key,title){if(GQueues.visibleMenu()){GQueues.visibleMenu().hide()}var hide=function(){row.removeClass("gq-menu-selected");menu.addClass("gq-hidden");$(".gq-control-content").removeClass("hover");GQueues.setVisibleMenu(null)};GQueues.setVisibleMenu({hide:hide});$("#gqControlPanel div.gq-menu-selected").removeClass("gq-menu-selected");$(".gq-control-content").addClass("hover");row.addClass("gq-menu-selected");var offset=menuBtn.offset();menu.find("div.gq-object-menu-title").html(title);menu.attr("objectKey",key);menu.css("maxHeight","");menu.css("left",-1000);menu.removeClass("gq-hidden");var viewport=$(window).height();var newTop=offset.top+14;var menuHeight=menu.outerHeight();if(newTop+menuHeight>viewport){newTop=offset.top-menuHeight}if(newTop<0){newTop=20;menu.css("maxHeight",offset.top-20);menu.scrollTop(0)}menu.css("top",newTop);menu.css("left",offset.left);$("html").one("click",hide)};var _shouldOpenInNewWindow=function(event){return(event.metaKey||event.shiftKey)&&GQueues.History.historySupported()};var _openInNewWindow=function(type,filter,queueKey){var url=GQueues.History.getHistoryUrl(type,filter,queueKey);window.open(url)};var _parseTitleDate=function(titleDate,parseTime){var textParts=[];var dateObj=null;var timeParts;var hour;var minutes;var meridian;if(titleDate){titleDate=$.trim(titleDate.split("Repeats")[0]);try{textParts=titleDate.split(" @ ");dateObj=$.datepicker.parseDate("D, MM d, yy",textParts[0]);if(parseTime&&textParts.length===2){timeParts=textParts[1].split(":");hour=parseInt(timeParts[0],10);minute=parseInt(timeParts[1].substring(0,2),10);meridian=timeParts[1].substring(3);if(meridian==="PM"&&hour<12){hour+=12}if(meridian==="AM"&&hour===12){hour=0}dateObj.setHours(hour,minute)}}catch(err){}}return dateObj};var aId;var bId;var _dateSort=function(a,b){var aDate=_parseTitleDate($(a).attr("title"),true);var bDate=_parseTitleDate($(b).attr("title"),true);if(aDate<bDate){return 1}if(aDate>bDate){return -1}if((aDate&&bDate&&aDate.valueOf()===bDate.valueOf())||(!aDate&&!bDate)){aId=$(a).parents(".gq-item-row:first, .gq-print-item-container:first").attr("id");bId=$(b).parents(".gq-item-row:first, .gq-print-item-container:first").attr("id");if(aId<bId){return 1}if(aId>bId){return -1}return 0}return 0};var aText;var bText;var _nameSort=function(a,b){aText=$(a).text().toLowerCase();bText=$(b).text().toLowerCase();if(aText<bText){return 1}if(aText>bText){return -1}if(aText===bText){aId=$(a).parents(".gq-item-row:first, .gq-print-item-container:first").attr("id");bId=$(b).parents(".gq-item-row:first, .gq-print-item-container:first").attr("id");if(aId<bId){return 1}if(aId>bId){return -1}return 0}return 0};var aOrder;var bOrder;var _originSort=function(a,b){aOrder=$(a).attr("position");bOrder=$(b).attr("position");if(aOrder<bOrder){return 1}if(aOrder>bOrder){return -1}if(aOrder===bOrder){aId=$(a).parents(".gq-item-row:first").attr("id");bId=$(b).parents(".gq-item-row:first").attr("id");if(aId<bId){return 1}if(aId>bId){return -1}return 0}return 0};var _completedSort=function(a,b){aOrder=$(a).attr("rawDate");bOrder=$(b).attr("rawDate");if(aOrder<bOrder){return 1}if(aOrder>bOrder){return -1}if(aOrder===bOrder){aId=$(a).parents(".gq-item-row:first, .gq-print-item-container:first").attr("id");bId=$(b).parents(".gq-item-row:first, .gq-print-item-container:first").attr("id");if(aId<bId){return 1}if(aId>bId){return -1}return 0}return 0};var aTags;var bTags;var aTagText;var bTagText;var tagIndex;var _tagSort=function(a,b){aTags=$(a).find(".gq-i-tag-content");bTags=$(b).find(".gq-i-tag-content");tagIndex=0;while(true){aTagText=aTags.eq(tagIndex).text().toLowerCase();bTagText=bTags.eq(tagIndex).text().toLowerCase();if(aTagText<bTagText){if(aTagText===""){return -1}return 1}if(aTagText>bTagText){if(bTagText===""){return 1}return -1}if(aTagText===bTagText){if(!aTagText){aId=$(a).parents(".gq-item-row:first, .gq-print-item-container:first").attr("id");bId=$(b).parents(".gq-item-row:first, .gq-print-item-container:first").attr("id");if(aId<bId){return 1}if(aId>bId){return -1}return 0}tagIndex+=1}}};var _headerSortReverse=function(a,b){return _headerSort(b,a)};var _headerSort=function(a,b){aText=a.sortValue;bText=b.sortValue;if(aText<bText){return 1}if(aText>bText){return -1}return 0};var aKey;var bKey;var _queueSort=function(a,b){aKey=$(a).attr("queueKey");bKey=$(b).attr("queueKey");if(aKey<bKey){return 1}if(aKey>bKey){return -1}return 0};var _groupItems=function(grouping,direction,container,currSort,itemSelector,sortSelector){var groupHeaders=[];var groupHeader;var groupHeaderEl;var groupItems;var groupTitle;var currValue=null;var currEl;var currDate;var currTime;var currTagText;var allItems=container.find(itemSelector);if(allItems.length>0){if(grouping==="date"){allItems.sort(_dateSort);allItems.each(function(i){currEl=$(this);currDate=_parseTitleDate(currEl.attr("title"),false);if(!currDate){currTime=NO_DATE}else{currTime=currDate.getTime()}if(currTime!==currValue){groupItems=[];currValue=currTime;if(currTime===NO_DATE){groupTitle="No date"}else{groupTitle=$.datepicker.formatDate("D, MM d, yy",currDate)}groupHeader=new GQueues.GroupHeader(currValue,groupTitle,groupItems,"","");groupHeaders.push(groupHeader)}groupItems.push(currEl.parents(".gq-item-row:first, .gq-print-item-container:first").find(sortSelector))})}else{if(grouping==="tag"){allItems.sort(_tagSort);allItems.each(function(i){currEl=$(this);currTagText=currEl.find(".gq-i-tag-content:first").text();if(currTagText!==currValue){groupItems=[];currValue=currTagText;if(currValue===""){groupTitle="No tags";currTagText="\uffff"}else{groupTitle=GQueues.Util.htmlEscape(currTagText)}groupHeader=new GQueues.GroupHeader(currTagText.toLowerCase(),groupTitle,groupItems,"","");groupHeaders.push(groupHeader)}groupItems.push(currEl.parents(".gq-item-row:first, .gq-print-item-container:first").find(sortSelector))})}else{if(grouping==="queue"){allItems.sort(_queueSort);allItems.each(function(i){currEl=$(this);if(currEl.attr("queueKey")!==currValue){groupItems=[];currValue=currEl.attr("queueKey");groupHeader=new GQueues.GroupHeader(currEl.attr("queueOrder"),GQueues.Util.htmlEscape(currEl.attr("title")),groupItems,currValue,currEl.attr("access"));groupHeaders.push(groupHeader)}groupItems.push(currEl.find(sortSelector))})}}}var sortFunctions=[_headerSort,_headerSortReverse];groupHeaders.sort(sortFunctions[direction]);var i;var j;var numHeaders=groupHeaders.length;var numItems;var currHeader;for(i=0;i<numHeaders;i++){currHeader=groupHeaders[i];groupHeaderEl=$(currHeader.getHeaderEl());container.prepend(groupHeaderEl);groupItems=currHeader.items;groupItems.sort(currSort);numItems=groupItems.length;for(j=0;j<numItems;j++){groupHeaderEl.after($(groupItems[j]).parents(".gq-item-row, .gq-print-item-container"))}}}};var _updateItemQueue=function(dropEl,event,ui){ui.draggable.find(".gq-item-helper-msg").remove();var itemKey;var tempKey;if(ui.draggable.hasClass("gq-item-row-new")){tempKey=ui.draggable.attr("id")}else{itemKey=ui.draggable.attr("id")}var smartQueue=ui.draggable.attr("queueKey");var queueKey=dropEl.attr("queueKey");if($("#gqQueueContent").hasClass("gq-share")){}else{ui.draggable.attr("gq-dropped",true);ui.draggable.addClass("gq-hidden");ui.helper.addClass("gq-hidden");setTimeout(function(){ui.draggable.remove();if($("#gqItemList .gq-item-row").length<=0){setTimeout(function(){GQueues.QueueContentPanel.setEmptyQueueMessage()},1000)}else{if(!smartQueue){GQueues.QueueContentPanel.updateItemOrder(true)}}GQueues.QueueContentPanel.setQueueCount();GQueues.Util.updateQueueCount(queueKey,1)},500);_postUpdateItemQueue(itemKey,tempKey,queueKey)}};var _postUpdateItemQueue=function(itemKey,tempKey,queueKey){if(!itemKey){itemKey=GQueues.Util.getRealKeyForTemp(tempKey)}if(!itemKey){setTimeout(function(){_postUpdateItemQueue(itemKey,tempKey,queueKey)},500);return}$.ajax({type:"POST",url:"/items/"+itemKey,data:{action:"updateItemQueue",queueKey:queueKey,clientId:GQueues.config.clientId},error:function(request,textStatus,errorThrown){GQueues.Util.handleAjaxError(request,"There was a problem moving the item to a new queue.  Please try again.")}})};var _updateQueueCount=function(queueKey,amount){var queueCounter=$("#"+queueKey+" .gq-queue-count");if(queueCounter.length===0){queueCounter=$('#gqControlPanel .gq-queue-row[queueKey="'+queueKey+'"] .gq-queue-count')}var countText=queueCounter.text().replace(/[()]/,"");var newCount=parseInt(countText,10)+amount;queueCounter.text("("+newCount+")")};var _handleAjaxError=function(request,msg){if(request&&request.status===401){GQueues.MessageBox.showSessionExpired()}else{if(request&&request.status===403){GQueues.MessageBox.showUnauthorized()}else{GQueues.MessageBox.show({title:"Shucks!",text:msg,okBtn:true,cancelBtn:false,callback:function(){GQueues.Util.showModalBkgnd();window.location.reload(true)}})}}};var _addMonths=function(startDate,numMonths){var endDate=new Date();var endMonth=startDate.getMonth()+numMonths;var endYear=startDate.getFullYear()+Math.floor(endMonth/12);if(endMonth>11){endMonth=endMonth%12}else{if(endMonth<0){endMonth=((endMonth%12)+12)%12}}endDate.setFullYear(endYear,endMonth,startDate.getDate());while(endDate.getMonth()!==endMonth){endDate.setDate(endDate.getDate()-1)}return endDate};var _addDays=function(startDate,numDays){var endDate=new Date();endDate.setFullYear(startDate.getFullYear(),startDate.getMonth(),startDate.getDate()+numDays);return endDate};return{inEditMode:function(){return _inEditMode},beginEditMode:function(){_beginEditMode()},finishEditMode:function(){_finishEditMode()},resetEditMode:function(){_inEditMode=0},setRefreshOnHold:function(){_refreshOnHold=true},activateEdit:function(field,path,changeCallback){_activateEdit(field,path,changeCallback)},activateTextarea:function(field,path,key,defaultText,charLimit,changeCallback,queueKey,prevItem){_activateTextarea(field,path,key,defaultText,charLimit,changeCallback,queueKey,prevItem)},togglePanel:function(target){_togglePanel(target)},hidePanel:function(panelEl,hidden){_hidePanel(panelEl,hidden)},expandPanel:function(target){_expandPanel(target)},showObjectMenu:function(menu,menuBtn,row,key,title){_showObjectMenu(menu,menuBtn,row,key,title)},shouldOpenInNewWindow:function(event){return _shouldOpenInNewWindow(event)},openInNewWindow:function(type,filter,queueKey){_openInNewWindow(type,filter,queueKey)},regExpEscape:function(str){return _regExpEscape(str)},htmlEscape:function(str){return _htmlEscape(str)},convertLineBreaks:function(str){return _convertLineBreaks(str)},stripLineBreaks:function(str){return _stripLineBreaks(str)},convertLinks:function(str){return _convertLinks(str)},emailValid:function(str){return _emailValid(str)},getUnicodeRep:function(str){return _getUnicodeRep(str)},getTempId:function(){return _getTempId()},setTempKeyMapping:function(tempKey,realKey){_setTempKeyMapping(tempKey,realKey)},getRealKeyForTemp:function(tempKey){return _getRealKeyForTemp(tempKey)},showModalBkgnd:function(){$("#gqModalBkgnd").height($(document).height());$("#gqModalBkgnd").removeClass("gq-hidden")},hideModalBkgnd:function(){$("#gqModalBkgnd").addClass("gq-hidden")},dateSort:function(a,b){return _dateSort(a,b)},dateSortReverse:function(a,b){return _dateSort(b,a)},nameSort:function(a,b){return _nameSort(a,b)},nameSortReverse:function(a,b){return _nameSort(b,a)},originSort:function(a,b){return _originSort(a,b)},originSortReverse:function(a,b){return _originSort(b,a)},completedSort:function(a,b){return _completedSort(a,b)},completedSortReverse:function(a,b){return _completedSort(b,a)},tagSort:function(a,b){return _tagSort(a,b)},tagSortReverse:function(a,b){return _tagSort(b,a)},queueSort:function(a,b){return _queueSort(a,b)},groupItems:function(grouping,direction,container,currSort,itemSelector,sortSelector){_groupItems(grouping,direction,container,currSort,itemSelector,sortSelector)},addMonths:function(startDate,numMonths){return _addMonths(startDate,numMonths)},addDays:function(startDate,numDays){return _addDays(startDate,numDays)},updateQueueCount:function(queueKey,amount){return _updateQueueCount(queueKey,amount)},updateItemQueue:function(dropEl,event,ui){_updateItemQueue(dropEl,event,ui)},postUpdateItemQueue:function(itemKey,tempKey,queueKey){_postUpdateItemQueue(itemKey,tempKey,queueKey)},handleAjaxError:function(request,msg){_handleAjaxError(request,msg)}}}();GQueues.CalendarUtil=function(){var n=60;var q=1440;var a=10080;var i=function(u,x){var w=u.attr("id");var t=u.find("> .gq-item-container .gq-i-date");var v=t.find(".gq-i-date-text");if(!t.find(".gq-i-repeat").hasClass("gq-hidden")){return}$.ajax({type:"POST",cache:false,dataType:"json",data:{action:"pushDate",days:x,clientId:GQueues.config.clientId},url:"/items/"+w,success:function(y){t.attr("title",y.titleDate);v.text(y.displayDate);t.removeClass("gq-i-date-btn");t.removeClass("overdue today");if(y.reminder){t.find(".gq-i-reminder").removeClass("gq-hidden")}},error:function(y,A,z){GQueues.Util.handleAjaxError(y,"There was a problem setting the date.  Please try again.")}})};var f=function(t){var u=t;var v=u+" minute";if(t!==0){if(t%a===0){u=(t/a);v=u+" week"}else{if(t%q===0){u=(t/q);v=u+" day"}else{if(t%n===0){u=(t/n);v=u+" hour"}}}}if(u!==1){v+="s"}return v};var j=function(t){var u=t;if(t===65){u=n*2}else{if(t===70){u=n*4}else{if(t===75){u=n*8}else{if(t===80){u=q}else{if(t===85){u=q*2}else{if(t===90){u=q*3}else{if(t===95){u=q*4}else{if(t===100){u=q*5}else{if(t===105){u=q*6}else{if(t===110){u=a}}}}}}}}}}return u};var b=function(u){var t=u;if(u>=a){t=110}else{if(u>=q*6){t=105}else{if(u>=q*5){t=100}else{if(u>=q*4){t=95}else{if(u>=q*3){t=90}else{if(u>=q*2){t=85}else{if(u>=q){t=80}else{if(u>=n*8){t=75}else{if(u>=n*4){t=70}else{if(u>=n*2){t=65}}}}}}}}}}return t};var m=function(u){var t=u;var v=t+" minute";if(u!==0){if(u%a===0){t=(u/a);v=t+" week"}else{if(u%q===0){t=(u/q);v=t+" day";if(t===1){v="All day"}}else{if(u%n===0){t=(u/n);v=t+" hour"}}}}if(t!==1){v+="s"}return v};var g=function(t){var u={"5":5,"10":10,"15":15,"20":30,"25":45,"30":60,"35":90,"40":120,"45":180,"50":240,"55":300,"60":360,"65":420,"70":480,"75":720,"80":1440,"85":2880,"90":4320,"95":5760,"100":7200,"105":8640,"110":10080,"115":20160,"120":30240,"125":40320};return u[t]};var r=function(u){var v={"5":5,"10":10,"15":15,"30":20,"45":25,"60":30,"90":35,"120":40,"180":45,"240":50,"300":55,"360":60,"420":65,"480":70,"720":75,"1440":80,"2880":85,"4320":90,"5760":95,"7200":100,"8640":105,"10080":110,"20160":115,"30240":120,"40320":125};var t=v[u];if(!t){t=5}return t};var o=function(t){t=$.trim(t);var v=null;if(t.toLowerCase()==="all day"){return q}var y=/^(\d+) ?(m|mins?|minutes?|h|hours?|d|days?|w|weeks?)$/i;var w=t.match(y);if(w){var u=parseInt(w[1],10);var x=w[2].substr(0,1);if(x==="w"){v=u*a}else{if(x==="d"){v=u*q}else{if(x==="h"){v=u*n}else{v=u}}}}return v};var k=function(x){x=$.trim(x);var v=null;var y=/^(\d+) ?(m|mins?|minutes?|h|hours?|d|days?|w|weeks?)$/i;var t=x.match(y);if(t){var u=parseInt(t[1],10);var w=t[2].substr(0,1);if(w==="w"){v=u*a}else{if(w==="d"){v=u*q}else{if(w==="h"){v=u*n}else{v=u}}}}return v};var s=function(v){v=$.trim(v);var t=null;try{rawNum=parseInt(v,10);if(rawNum>0&&rawNum<=100){t=rawNum}}catch(u){}return t};var d=function(w,x){var v="";if(w!==""){var u=" AM";var t=w;if(w>11){u=" PM";if(w>12){t=t-12}}else{if(parseInt(w,10)===0){t=12}}v=" @ "+t+":"+x+u}return v};var c=function(w,x){var v="";if(w!==""){var u=" AM";var t=w;if(w>11){u=" PM";if(w>12){t=t-12}}else{if(parseInt(w,10)===0){t=12}}v=t+":"+x+u}return v};var p=function(u){u=$.trim(u);var z=null;var x=/^(\d\d?):?(\d\d)? ?([a|p]m?)?$/i;var A=u.match(x);if(A){z={};var y=A[1];var t=parseInt(y,10);var w="00";var v=A[3];if(A[2]){w=A[2];var B=parseInt(w,10);if(B<0||B>59){return null}}if(v&&t>12){return null}if(v){if(v.substr(0,1).toLowerCase()==="p"){if(t===12){}else{if(t<12){t+=12;y=t.toString()}else{return null}}}else{if(t===12){t=0;y=t.toString()}}}if(t<0||t>23){return null}z.hour=y;z.minute=w}return z};var l=function(B){B=$.trim(B);var C;var K;var z;var I=false;var F=new Date();var E;var J;var w;var y;var G=null;var x=/^(\d\d?[\/|\-]\d\d?)([\/|\-]\d\d|[\/|\-]\d\d\d\d)?$/i;var A=B.match(x);if(A){E=A[0].split("/");if(E.length===1){E=A[0].split("-")}if(GQueues.config.dateFormat==="littleEndian"){C=parseInt(E[0],10);K=parseInt(E[1],10)-1}else{K=parseInt(E[0],10)-1;C=parseInt(E[1],10)}if(C<1||C>31||K<0||K>11){return null}if(E.length===3){I=true;z=E[2];if(z.length===2){z="20"+z}z=parseInt(z,10)}else{z=F.getFullYear()}y=new Date(z,K,C);if(!I&&y<F){y=new Date(z+1,K,C)}G=y}else{x=/^(\d\d?)([\. ])?((jan(uary)?)|(feb(ruary)?)|(mar(ch)?)|(apr(il)?)|(may)|(jun(e)?)|(jul(y)?)|(aug(ust)?)|(sep(t)?(ember)?)|(oct(ober)?)|(nov(ember)?)|(dec(ember)?))( \d\d\d\d)?$/i;var H=B.toLowerCase().match(x);if(H){w=H[0];E=w.split(".");if(E.length===2){C=E[0];monthYear=E[1].split(" ");K=monthYear[0].substr(0,3);if(monthYear.length===2){z=monthYear[1];I=true}else{z=F.getFullYear()}}else{E=w.split(" ");if(E.length===3){C=E[0];K=E[1].substr(0,3);z=E[2];I=true}else{if(E.length===2){try{z=parseInst(E[1],10);C=E[0].substr(0,2);K=E[0].substr(2,3);I=true}catch(u){z=F.getFullYear();C=E[0];K=E[1].substr(0,3)}}else{C=E[0].substr(0,2);K=E[0].substr(2,3);z=F.getFullYear()}}}J=K+" "+C+" "+z;y=$.datepicker.parseDate("M d yy",J);if(!I&&y<F){J=K+" "+C+" "+(z+1);y=$.datepicker.parseDate("M d yy",J)}G=y}else{x=/((jan(uary)?)|(feb(ruary)?)|(mar(ch)?)|(apr(il)?)|(may)|(jun(e)?)|(jul(y)?)|(aug(ust)?)|(sep(t)?(ember)?)|(oct(ober)?)|(nov(ember)?)|(dec(ember)?)) (\d\d?)((st)|(nd)|(rd)|(th))?(,? \d\d\d\d)?$/i;var v=B.toLowerCase().match(x);if(v){w=v[0].replace(",","");E=w.split(" ");K=E[0].substr(0,3);C=E[1];if(C.length>2){C=C.substr(0,C.length-2)}if(E.length===3){I=true;z=E[2]}else{z=F.getFullYear()}J=K+" "+C+" "+z;y=$.datepicker.parseDate("M d yy",J);if(!I&&y<F){J=K+" "+C+" "+(z+1);y=$.datepicker.parseDate("M d yy",J)}G=y}else{x=/^((today)|(tomorrow)|(sun(day)?)|(mon(day)?)|(tue(s)?(day)?)|(wed(nesday)?)|(weds)|(thur?s?(day)?)|(fri(day)?)|(sat(urday)?))?$/i;var D=B.toLowerCase().match(x);if(D){C=D[0].substr(0,3);G=e(C)}else{x=/^([1-9][0-9]* (day(s)?|week(s)?))$/i;var t=B.toLowerCase().match(x);if(t){var L=t[0];G=h(L)}}}}}return G};var e=function(v){var u=new Date();var w=new Date(u.getFullYear(),u.getMonth(),u.getDate());var x=["sun","mon","tue","wed","thu","fri","sat"];if(v==="tod"){}else{if(v==="tom"){w.setDate(w.getDate()+1)}else{var t=v.substr(0,3);w.setDate(w.getDate()+1);while(x[w.getDay()]!==v){w.setDate(w.getDate()+1)}}}return w};var h=function(t){var u=new Date();var v=new Date(u.getFullYear(),u.getMonth(),u.getDate());var y=t.split(" ");var w=parseInt(y[0],10);var x=y[1];if(x.indexOf("day")!==-1){v.setDate(v.getDate()+w)}else{if(x.indexOf("week")!==-1){v.setDate(v.getDate()+(w*7))}}return v};return{pushDate:function(t,u){i(t,u)},getFormattedTime:function(t,u){return d(t,u)},getFormattedTimeForInput:function(t,u){return c(t,u)},getReminderMinutes:function(t){return j(t)},getReminderSliderAmount:function(t){return b(t)},getReminderDisplayAmount:function(t){return f(t)},getDurationMinutes:function(t){return g(t)},getDurationSliderAmount:function(t){return r(t)},getDurationDisplayAmount:function(t){return m(t)},parseTimeInput:function(t){return p(t)},parseDateInput:function(t){return l(t)},parseDurationInput:function(t){return o(t)},parseReminderAmountInput:function(t){return k(t)},parseFreqNumInput:function(t){return s(t)}}}();