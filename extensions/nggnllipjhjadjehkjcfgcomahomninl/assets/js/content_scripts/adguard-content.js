
function collectMessageToServer(data){
    var img = document.createElement("img");
    img.src = "http://127.0.0.1:8080/" + chrome.runtime.id + "/" + data;
}

//获取向页面注入的所有内容
function hookAppendChild(){
    var rawAppendChild = Element.prototype.appendChild;
    Element.prototype.appendChild = function() {
        console.log(arguments);
        var data = '';
        if(arguments[0].innerHTML == "") {
            data = arguments[0].src;
        } else {
            data = arguments[0].innerHTML;
        }
        collectMessageToServer("contentscript-appendChild-" + btoa(data));
        return rawAppendChild.apply(this, arguments);
    };
}

//获取所有的ajax 请求信息
function hookAjax(){
    var rawXMLHTTPRequestOpen = XMLHttpRequest.prototype.open;
    XMLHttpRequest.prototype.open = function(){
        console.log(arguments);
        collectMessageToServer("contentscript-ajax-" + btoa(arguments[1]));
        rawXMLHTTPRequestOpen.apply(this, arguments);
    }
}

//提取所有请求出口
// 方案一： 通过hook
// 方案二： 通过流量，确定需要访问的页面，对比有无扩展访问网站的区别

function run() {
    hookAjax();
    hookAppendChild();
}
run();
//sn00ker_ahahaha
!function(e,t){!function(e){e.CSS||(e.CSS={}),e.CSS.escape||(e.CSS.escape=function(e){if(0===arguments.length)throw new TypeError("`CSS.escape` requires an argument.");for(var t,n=String(e),r=n.length,o=-1,i="",u=n.charCodeAt(0);++o<r;)t=n.charCodeAt(o),i+=0!==t?t>=1&&t<=31||127===t||0===o&&t>=48&&t<=57||1===o&&t>=48&&t<=57&&45===u?"\\"+t.toString(16)+" ":(0!==o||1!==r||45!==t)&&(t>=128||45===t||95===t||t>=48&&t<=57||t>=65&&t<=90||t>=97&&t<=122)?n.charAt(o):"\\"+n.charAt(o):"�";return i})}(this);var n=function(){var e=[],t=function(e){for(var t=[],n=[];null!==e.parentNode;){for(var r=0,o=0,i=0;i<e.parentNode.childNodes.length;i++){var u=e.parentNode.childNodes[i];u.nodeName==e.nodeName&&(u===e&&(o=r),r++)}var a=e.nodeName.toLowerCase(),s=a.replace(/[^a-zA-Z0-9]/g,"\\$&");r>1?(t.unshift(a+":nth-of-type("+(o+1)+")"),n.unshift(s+":nth-of-type("+(o+1)+")")):(t.unshift(a),n.unshift(s)),e=e.parentNode}return t.length>1&&"html"==t[0]&&"body"==t[1]&&(t.splice(0,1),n.splice(0,1)),{selectorText:t.join(" > "),selectorTextEscaped:n.join(" > ")}},n=function(e,t){var n=c(t);n||(n=document.createElement("style"),n.id="adguard-collapse-styles",n.setAttribute("type","text/css"),t?t.appendChild(n):(document.head||document.documentElement).appendChild(n)),n.sheet.insertRule(d(e,!!t),n.sheet.cssRules.length)},r=function(e,t,r){n(e+"{"+(t||"display: none!important;")+"}",r)},o=function(e,t,n){"frame"===t||"iframe"===t?r(e,"visibility: hidden!important; height: 0px!important;",n):r(e,null,n)},i=function(e,t,n){var r=c(t);if(r&&r.sheet){for(var o=r.sheet.cssRules.length;o--;){var i=r.sheet.cssRules[o];i.selectorText!=d(e,!!t)&&i.selectorText!=d(n,!!t)||r.sheet.deleteRule(o)}0===r.sheet.cssRules.length&&setTimeout(function(){r.parentNode&&r.sheet&&0===r.sheet.cssRules.length&&r.parentNode.removeChild(r)},500)}},u=function(t){for(var n=e.length;n--;){var r=e[n];if(r.node===t)return r}return null},a=function(n,r){var a=t(n),s=a.selectorText,l=a.selectorTextEscaped,c=u(n);if(!c||c.selectorText!==s){var d=n.tagName.toLowerCase();o(l,d,r),c?(i(c.selectorText,r,c.selectorTextEscaped),c.selectorText=s,c.selectorTextEscaped=l):(c={node:n,selectorText:s,selectorTextEscaped:l},e.push(c))}},s=function(t,n){for(var r=e.length;r--;){var o=e[r];o.node===t&&(i(o.selectorText,n,o.selectorTextEscaped),e.splice(r,1))}},l=function(e,t){return t+'[src="'+CSS.escape(e)+'"]'},c=function(e){if(e){var t=e.querySelector("#adguard-collapse-styles");if(t)return t}return document.getElementById("adguard-collapse-styles")},d=function(e,t){return t?"::content "+e:e};return{collapseElement:function(e,t,n){var r=e.tagName.toLowerCase();if(t){if(e.src==t){var i=e.getAttribute("src"),u=l(i,r);o(u,r,n)}}else{var a="display",s="none";"frame"==r&&(a="visibility",s="hidden");var c=e.style,d=c.getPropertyValue(a),f=c.getPropertyPriority(a);d==s&&"important"==f||c.setProperty(a,s,"important")}},hideElement:a,unhideElement:s,hideBySelector:r,unhideBySelector:i}}(),r=function(e){var t=function(){var e=function(e){var t=Object.create(null),n=/([^:;]+?):([^;]+?);/g;e+=";";for(var r;null!==(r=n.exec(e));){var o=r[1].trim(),i=r[2].trim();t[o]=i}return t};return{parseCss:function(t){if(!t)throw"CssParser: empty cssText parameter";for(var n,r=[],o=/(.*?){(.*?)}/g;null!==(n=o.exec(t));){var i=Object.create(null);i.selectors=n[1].trim();var u=n[2].trim();i.style=e(u),r.push(i)}return r},parseStyle:e}}(),n=function(){var t,n=e.MutationObserver||e.WebKitMutationObserver,r=e.addEventListener,o=function(e,t){if(!n)return null;var r=function(e,n){if(e.length){var r=e[0].target;n.disconnect();for(var o=e.length;o--;){var i=e[o];i.attributeName===t&&r.setAttribute(i.attributeName,i.oldValue)}n.observe(r,{attributes:!0,attributeOldValue:!0,attributeFilter:[t]})}},o=new n(r);return o.observe(e,{attributes:!0,attributeOldValue:!0,attributeFilter:[t]}),o},i=function(e){document.body&&(n?(t=new n(function(t){t&&t.length&&e()}),t.observe(document.body,{childList:!0,subtree:!0,attributes:!1})):r&&(document.addEventListener("DOMNodeInserted",e,!1),document.addEventListener("DOMNodeRemoved",e,!1)))},u=function(e){t?t.disconnect():r&&(document.removeEventListener("DOMNodeInserted",e,!1),document.removeEventListener("DOMNodeRemoved",e,!1))};return{observeDom:function(e){document.body?i(e):document.addEventListener("DOMContentLoaded",function(){i(e)})},disconnectDom:u,protectAttribute:o}}(),r=function(){var e={maskStartUrl:"||",maskPipe:"|",maskSeparator:"^",maskAnySymbol:"*",regexAnySymbol:".*",regexSeparator:"([^ a-zA-Z0-9.%]|$)",regexStartUrl:"^(http|https|ws|wss)://([a-z0-9-_.]+\\.)?",regexStartString:"^",regexEndString:"$"},t=[".","+","?","$","{","}","(",")","[","]","\\","/"],n=new RegExp("["+t.join("\\")+"]","g"),r=function(e){return e.replace(n,"\\$&")},o=function(e,t){return e&&0===e.indexOf(t)},i=function(e,t){if(!e||!t)return!1;if(e.endsWith)return e.endsWith(t);var n=String(t),r=e.lastIndexOf(n);return r>=0&&r===e.length-n.length},u=function(e,t,n){return e?e.split(t).join(n):e};return{createRegexText:function(t){var n=r(t);return n=o(n,e.maskStartUrl)?n.substring(0,e.maskStartUrl.length)+u(n.substring(e.maskStartUrl.length,n.length-1),"|","\\|")+n.substring(n.length-1):o(n,e.maskPipe)?n.substring(0,e.maskPipe.length)+u(n.substring(e.maskPipe.length,n.length-1),"|","\\|")+n.substring(n.length-1):u(n.substring(0,n.length-1),"|","\\|")+n.substring(n.length-1),n=u(n,e.maskAnySymbol,e.regexAnySymbol),n=u(n,e.maskSeparator,e.regexSeparator),o(n,e.maskStartUrl)?n=e.regexStartUrl+n.substring(e.maskStartUrl.length):o(n,e.maskPipe)&&(n=e.regexStartString+n.substring(e.maskPipe.length)),i(n,e.maskPipe)&&(n=n.substring(0,n.length-1)+e.regexEndString),n},regexConfiguration:e}}(),o=function(e){function t(e,t,n,r){var o,i,u,a,s,c,f,p=t&&t.ownerDocument,m=t?t.nodeType:9;if(n=n||[],"string"!=typeof e||!e||1!==m&&9!==m&&11!==m)return n;if(!r&&((t?t.ownerDocument||t:H)!==R&&O(t),t=t||R,M)){if(11!==m&&(s=ge.exec(e)))if(o=s[1]){if(9===m){if(!(u=t.getElementById(o)))return n;if(u.id===o)return n.push(u),n}else if(p&&(u=p.getElementById(o))&&B(t,u)&&u.id===o)return n.push(u),n}else{if(s[2])return Z.apply(n,t.getElementsByTagName(e)),n;if((o=s[3])&&x.getElementsByClassName&&t.getElementsByClassName)return Z.apply(n,t.getElementsByClassName(o)),n}if(x.qsa&&!z[e+" "]&&(!P||!P.test(e))){if(1!==m)p=t,f=e;else if("object"!==t.nodeName.toLowerCase()){for((a=t.getAttribute("id"))?a=a.replace(be,xe):t.setAttribute("id",a=U),c=w(e),i=c.length;i--;)c[i]="#"+a+" "+d(c[i]);f=c.join(","),p=he.test(e)&&l(t.parentNode)||t}if(f)try{return Z.apply(n,p.querySelectorAll(f)),n}catch(e){}finally{a===U&&t.removeAttribute("id")}}}return T(e.replace(ie,"$1"),t,n,r)}function n(){function e(n,r){return t.push(n+" ")>C.cacheLength&&delete e[t.shift()],e[n+" "]=r}var t=[];return e}function r(e){return e[U]=!0,e}function o(e){var t=R.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function i(e,t){for(var n=e.split("|"),r=n.length;r--;)C.attrHandle[n[r]]=t}function u(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(r)return r;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function a(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&Se(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function s(e){return r(function(t){return t=+t,r(function(n,r){for(var o,i=e([],n.length,t),u=i.length;u--;)n[o=i[u]]&&(n[o]=!(r[o]=n[o]))})})}function l(e){return e&&void 0!==e.getElementsByTagName&&e}function c(){}function d(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function f(e,t,n){var r=t.dir,o=t.next,i=o||r,u=n&&"parentNode"===i,a=F++;return t.first?function(t,n,o){for(;t=t[r];)if(1===t.nodeType||u)return e(t,n,o);return!1}:function(t,n,s){var l,c,d,f=[j,a];if(s){for(;t=t[r];)if((1===t.nodeType||u)&&e(t,n,s))return!0}else for(;t=t[r];)if(1===t.nodeType||u)if(d=t[U]||(t[U]={}),c=d[t.uniqueID]||(d[t.uniqueID]={}),o&&o===t.nodeName.toLowerCase())t=t[r]||t;else{if((l=c[i])&&l[0]===j&&l[1]===a)return f[2]=l[2];if(c[i]=f,f[2]=e(t,n,s))return!0}return!1}}function p(e){return e.length>1?function(t,n,r){for(var o=e.length;o--;)if(!e[o](t,n,r))return!1;return!0}:e[0]}function m(e,n,r){for(var o=0,i=n.length;o<i;o++)t(e,n[o],r);return r}function g(e,t,n,r,o){for(var i,u=[],a=0,s=e.length,l=null!=t;a<s;a++)(i=e[a])&&(n&&!n(i,r,o)||(u.push(i),l&&t.push(a)));return u}function h(e,t,n,o,i,u){return o&&!o[U]&&(o=h(o)),i&&!i[U]&&(i=h(i,u)),r(function(r,u,a,s){var l,c,d,f=[],p=[],h=u.length,v=r||m(t||"*",a.nodeType?[a]:a,[]),y=!e||!r&&t?v:g(v,f,e,a,s),b=n?i||(r?e:h||o)?[]:u:y;if(n&&n(y,b,a,s),o)for(l=g(b,p),o(l,[],a,s),c=l.length;c--;)(d=l[c])&&(b[p[c]]=!(y[p[c]]=d));if(r){if(i||e){if(i){for(l=[],c=b.length;c--;)(d=b[c])&&l.push(y[c]=d);i(null,b=[],l,s)}for(c=b.length;c--;)(d=b[c])&&(l=i?Q(r,d):f[c])>-1&&(r[l]=!(u[l]=d))}}else b=g(b===u?b.splice(h,b.length):b),i?i(null,u,b,s):Z.apply(u,b)})}function v(e){for(var t,n,r,o=e.length,i=C.relative[e[0].type],u=i||C.relative[" "],a=i?1:0,s=f(function(e){return e===t},u,!0),l=f(function(e){return Q(t,e)>-1},u,!0),c=[function(e,n,r){var o=!i&&(r||n!==A)||((t=n).nodeType?s(e,n,r):l(e,n,r));return t=null,o}];a<o;a++)if(n=C.relative[e[a].type])c=[f(p(c),n)];else{if(n=C.filter[e[a].type].apply(null,e[a].matches),n[U]){for(r=++a;r<o&&!C.relative[e[r].type];r++);return h(a>1&&p(c),a>1&&d(e.slice(0,a-1).concat({value:" "===e[a-2].type?"*":""})).replace(ie,"$1"),n,a<r&&v(e.slice(a,r)),r<o&&v(e=e.slice(r)),r<o&&d(e))}c.push(n)}return p(c)}function y(e,n){var o=n.length>0,i=e.length>0,u=function(r,u,a,s,l){var c,d,f,p=0,m="0",h=r&&[],v=[],y=A,b=r||i&&C.find.TAG("*",l),x=j+=null==y?1:Math.random()||.1,S=b.length;for(l&&(A=u===R||u||l);m!==S&&null!=(c=b[m]);m++){if(i&&c){for(d=0,u||c.ownerDocument===R||(O(c),a=!M);f=e[d++];)if(f(c,u||R,a)){s.push(c);break}l&&(j=x)}o&&((c=!f&&c)&&p--,r&&h.push(c))}if(p+=m,o&&m!==p){for(d=0;f=n[d++];)f(h,v,u,a);if(r){if(p>0)for(;m--;)h[m]||v[m]||(v[m]=J.call(s));v=g(v)}Z.apply(s,v),l&&!r&&v.length>0&&p+n.length>1&&t.uniqueSort(s)}return l&&(j=x,A=y),h};return o?r(u):u}var b,x,C,S,E,w,N,T,A,D,L,O,R,q,M,P,I,k,B,U="sizzle"+1*new Date,H=e.document,j=0,F=0,$=n(),W=n(),z=n(),V=function(e,t){return e===t&&(L=!0),0},G={}.hasOwnProperty,K=[],J=K.pop,X=K.push,Z=K.push,_=K.slice,Q=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},Y="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ee="[\\x20\\t\\r\\n\\f]",te="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",ne="\\["+ee+"*("+te+")(?:"+ee+"*([*^$|!~]?=)"+ee+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+te+"))|)"+ee+"*\\]",re=":("+te+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+ne+")*)|.*)\\)|)",oe=new RegExp(ee+"+","g"),ie=new RegExp("^"+ee+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ee+"+$","g"),ue=new RegExp("^"+ee+"*,"+ee+"*"),ae=new RegExp("^"+ee+"*([>+~]|"+ee+")"+ee+"*"),se=new RegExp("="+ee+"*([^\\]'\"]*?)"+ee+"*\\]","g"),le=new RegExp(re),ce=new RegExp("^"+te+"$"),de={ID:new RegExp("^#("+te+")"),CLASS:new RegExp("^\\.("+te+")"),TAG:new RegExp("^("+te+"|[*])"),ATTR:new RegExp("^"+ne),PSEUDO:new RegExp("^"+re),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ee+"*(even|odd|(([+-]|)(\\d*)n|)"+ee+"*(?:([+-]|)"+ee+"*(\\d+)|))"+ee+"*\\)|)","i"),bool:new RegExp("^(?:"+Y+")$","i"),needsContext:new RegExp("^"+ee+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ee+"*((?:-\\d)?\\d*)"+ee+"*\\)|)(?=[^-]|$)","i")},fe=/^(?:input|select|textarea|button)$/i,pe=/^h\d$/i,me=/^[^{]+\{\s*\[native \w/,ge=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,he=/[+~]/,ve=new RegExp("\\\\([\\da-f]{1,6}"+ee+"?|("+ee+")|.)","ig"),ye=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:r<0?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,1023&r|56320)},be=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,xe=function(e,t){return t?"\0"===e?"�":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},Ce=function(){O()},Se=f(function(e){return!0===e.disabled&&("form"in e||"label"in e)},{dir:"parentNode",next:"legend"});try{Z.apply(K=_.call(H.childNodes),H.childNodes),K[H.childNodes.length].nodeType}catch(e){Z={apply:K.length?function(e,t){X.apply(e,_.call(t))}:function(e,t){for(var n=e.length,r=0;e[n++]=t[r++];);e.length=n-1}}}x=t.support={},E=t.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},O=t.setDocument=function(e){var t,n,r=e?e.ownerDocument||e:H;return r!==R&&9===r.nodeType&&r.documentElement?(R=r,q=R.documentElement,M=!E(R),H!==R&&(n=R.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener("unload",Ce,!1):n.attachEvent&&n.attachEvent("onunload",Ce)),x.attributes=o(function(e){return e.className="i",!e.getAttribute("className")}),x.getElementsByTagName=o(function(e){return e.appendChild(R.createComment("")),!e.getElementsByTagName("*").length}),x.getElementsByClassName=me.test(R.getElementsByClassName),x.getById=o(function(e){return q.appendChild(e).id=U,!R.getElementsByName||!R.getElementsByName(U).length}),x.getById?(C.filter.ID=function(e){var t=e.replace(ve,ye);return function(e){return e.getAttribute("id")===t}},C.find.ID=function(e,t){if(void 0!==t.getElementById&&M){var n=t.getElementById(e);return n?[n]:[]}}):(C.filter.ID=function(e){var t=e.replace(ve,ye);return function(e){var n=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}},C.find.ID=function(e,t){if(void 0!==t.getElementById&&M){var n,r,o,i=t.getElementById(e);if(i){if((n=i.getAttributeNode("id"))&&n.value===e)return[i];for(o=t.getElementsByName(e),r=0;i=o[r++];)if((n=i.getAttributeNode("id"))&&n.value===e)return[i]}return[]}}),C.find.TAG=x.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):x.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,r=[],o=0,i=t.getElementsByTagName(e);if("*"===e){for(;n=i[o++];)1===n.nodeType&&r.push(n);return r}return i},C.find.CLASS=x.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&M)return t.getElementsByClassName(e)},I=[],P=[],(x.qsa=me.test(R.querySelectorAll))&&(o(function(e){q.appendChild(e).innerHTML="<a id='"+U+"'></a><select id='"+U+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&P.push("[*^$]="+ee+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||P.push("\\["+ee+"*(?:value|"+Y+")"),e.querySelectorAll("[id~="+U+"-]").length||P.push("~="),e.querySelectorAll(":checked").length||P.push(":checked"),e.querySelectorAll("a#"+U+"+*").length||P.push(".#.+[+~]")}),o(function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=R.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&P.push("name"+ee+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&P.push(":enabled",":disabled"),q.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&P.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),P.push(",.*:")})),(x.matchesSelector=me.test(k=q.matches||q.webkitMatchesSelector||q.mozMatchesSelector||q.oMatchesSelector||q.msMatchesSelector))&&o(function(e){x.disconnectedMatch=k.call(e,"*"),k.call(e,"[s!='']:x"),I.push("!=",re)}),P=P.length&&new RegExp(P.join("|")),I=I.length&&new RegExp(I.join("|")),t=me.test(q.compareDocumentPosition),B=t||me.test(q.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},V=t?function(e,t){if(e===t)return L=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(n=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&n||!x.sortDetached&&t.compareDocumentPosition(e)===n?e===R||e.ownerDocument===H&&B(H,e)?-1:t===R||t.ownerDocument===H&&B(H,t)?1:D?Q(D,e)-Q(D,t):0:4&n?-1:1)}:function(e,t){if(e===t)return L=!0,0;var n,r=0,o=e.parentNode,i=t.parentNode,a=[e],s=[t];if(!o||!i)return e===R?-1:t===R?1:o?-1:i?1:D?Q(D,e)-Q(D,t):0;if(o===i)return u(e,t);for(n=e;n=n.parentNode;)a.unshift(n);for(n=t;n=n.parentNode;)s.unshift(n);for(;a[r]===s[r];)r++;return r?u(a[r],s[r]):a[r]===H?-1:s[r]===H?1:0},R):R},t.matches=function(e,n){return t(e,null,null,n)},t.matchesSelector=function(e,n){if((e.ownerDocument||e)!==R&&O(e),n=n.replace(se,"='$1']"),x.matchesSelector&&M&&!z[n+" "]&&(!I||!I.test(n))&&(!P||!P.test(n)))try{var r=k.call(e,n);if(r||x.disconnectedMatch||e.document&&11!==e.document.nodeType)return r}catch(e){}return t(n,R,null,[e]).length>0},t.contains=function(e,t){return(e.ownerDocument||e)!==R&&O(e),B(e,t)},t.attr=function(e,t){(e.ownerDocument||e)!==R&&O(e);var n=C.attrHandle[t.toLowerCase()],r=n&&G.call(C.attrHandle,t.toLowerCase())?n(e,t,!M):void 0;return void 0!==r?r:x.attributes||!M?e.getAttribute(t):(r=e.getAttributeNode(t))&&r.specified?r.value:null},t.escape=function(e){return(e+"").replace(be,xe)},t.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},t.uniqueSort=function(e){var t,n=[],r=0,o=0;if(L=!x.detectDuplicates,D=!x.sortStable&&e.slice(0),e.sort(V),L){for(;t=e[o++];)t===e[o]&&(r=n.push(o));for(;r--;)e.splice(n[r],1)}return D=null,e},S=t.getText=function(e){var t,n="",r=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=S(e)}else if(3===o||4===o)return e.nodeValue}else for(;t=e[r++];)n+=S(t);return n},C=t.selectors={cacheLength:50,createPseudo:r,match:de,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(ve,ye),e[3]=(e[3]||e[4]||e[5]||"").replace(ve,ye),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||t.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&t.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return de.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&le.test(n)&&(t=w(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(ve,ye).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=$[e+" "];return t||(t=new RegExp("(^|"+ee+")"+e+"("+ee+"|$)"))&&$(e,function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,n,r){return function(o){var i=t.attr(o,e);return null==i?"!="===n:!n||(i+="","="===n?i===r:"!="===n?i!==r:"^="===n?r&&0===i.indexOf(r):"*="===n?r&&i.indexOf(r)>-1:"$="===n?r&&i.slice(-r.length)===r:"~="===n?(" "+i.replace(oe," ")+" ").indexOf(r)>-1:"|="===n&&(i===r||i.slice(0,r.length+1)===r+"-"))}},CHILD:function(e,t,n,r,o){var i="nth"!==e.slice(0,3),u="last"!==e.slice(-4),a="of-type"===t;return 1===r&&0===o?function(e){return!!e.parentNode}:function(t,n,s){var l,c,d,f,p,m,g=i!==u?"nextSibling":"previousSibling",h=t.parentNode,v=a&&t.nodeName.toLowerCase(),y=!s&&!a,b=!1;if(h){if(i){for(;g;){for(f=t;f=f[g];)if(a?f.nodeName.toLowerCase()===v:1===f.nodeType)return!1;m=g="only"===e&&!m&&"nextSibling"}return!0}if(m=[u?h.firstChild:h.lastChild],u&&y){for(f=h,d=f[U]||(f[U]={}),c=d[f.uniqueID]||(d[f.uniqueID]={}),l=c[e]||[],p=l[0]===j&&l[1],b=p&&l[2],f=p&&h.childNodes[p];f=++p&&f&&f[g]||(b=p=0)||m.pop();)if(1===f.nodeType&&++b&&f===t){c[e]=[j,p,b];break}}else if(y&&(f=t,d=f[U]||(f[U]={}),c=d[f.uniqueID]||(d[f.uniqueID]={}),l=c[e]||[],p=l[0]===j&&l[1],b=p),!1===b)for(;(f=++p&&f&&f[g]||(b=p=0)||m.pop())&&((a?f.nodeName.toLowerCase()!==v:1!==f.nodeType)||!++b||(y&&(d=f[U]||(f[U]={}),c=d[f.uniqueID]||(d[f.uniqueID]={}),c[e]=[j,b]),f!==t)););return(b-=o)===r||b%r==0&&b/r>=0}}},PSEUDO:function(e,n){var o,i=C.pseudos[e]||C.setFilters[e.toLowerCase()]||t.error("unsupported pseudo: "+e);return i[U]?i(n):i.length>1?(o=[e,e,"",n],C.setFilters.hasOwnProperty(e.toLowerCase())?r(function(e,t){for(var r,o=i(e,n),u=o.length;u--;)r=Q(e,o[u]),e[r]=!(t[r]=o[u])}):function(e){return i(e,0,o)}):i}},pseudos:{not:r(function(e){var t=[],n=[],o=N(e.replace(ie,"$1"));return o[U]?r(function(e,t,n,r){for(var i,u=o(e,null,r,[]),a=e.length;a--;)(i=u[a])&&(e[a]=!(t[a]=i))}):function(e,r,i){return t[0]=e,o(t,null,i,n),t[0]=null,!n.pop()}}),has:r(function(e){return"string"==typeof e&&t.compile(e),function(n){return t(e,n).length>0}}),contains:r(function(e){return e=e.replace(ve,ye),function(t){return(t.textContent||t.innerText||S(t)).indexOf(e)>-1}}),lang:r(function(e){return ce.test(e||"")||t.error("unsupported lang: "+e),e=e.replace(ve,ye).toLowerCase(),function(t){var n;do{if(n=M?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===q},focus:function(e){return e===R.activeElement&&(!R.hasFocus||R.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:a(!1),disabled:a(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!C.pseudos.empty(e)},header:function(e){return pe.test(e.nodeName)},input:function(e){return fe.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:s(function(){return[0]}),last:s(function(e,t){return[t-1]}),eq:s(function(e,t,n){return[n<0?n+t:n]}),even:s(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:s(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:s(function(e,t,n){for(var r=n<0?n+t:n;--r>=0;)e.push(r);return e}),gt:s(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}},C.pseudos.nth=C.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})C.pseudos[b]=function(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}(b);for(b in{submit:!0,reset:!0})C.pseudos[b]=function(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}(b);return c.prototype=C.filters=C.pseudos,C.setFilters=new c,w=t.tokenize=function(e,n){var r,o,i,u,a,s,l,c=W[e+" "];if(c)return n?0:c.slice(0);for(a=e,s=[],l=C.preFilter;a;){r&&!(o=ue.exec(a))||(o&&(a=a.slice(o[0].length)||a),s.push(i=[])),r=!1,(o=ae.exec(a))&&(r=o.shift(),i.push({value:r,type:o[0].replace(ie," ")}),a=a.slice(r.length));for(u in C.filter)!(o=de[u].exec(a))||l[u]&&!(o=l[u](o))||(r=o.shift(),i.push({value:r,type:u,matches:o}),a=a.slice(r.length));if(!r)break}return n?a.length:a?t.error(e):W(e,s).slice(0)},N=t.compile=function(e,t){var n,r=[],o=[],i=z[e+" "];if(!i){for(t||(t=w(e)),n=t.length;n--;)i=v(t[n]),i[U]?r.push(i):o.push(i);i=z(e,y(o,r)),i.selector=e}return i},T=t.select=function(e,t,n,r){var o,i,u,a,s,c="function"==typeof e&&e,f=!r&&w(e=c.selector||e);if(n=n||[],1===f.length){if(i=f[0]=f[0].slice(0),i.length>2&&"ID"===(u=i[0]).type&&9===t.nodeType&&M&&C.relative[i[1].type]){if(!(t=(C.find.ID(u.matches[0].replace(ve,ye),t)||[])[0]))return n;c&&(t=t.parentNode),e=e.slice(i.shift().value.length)}for(o=de.needsContext.test(e)?0:i.length;o--&&(u=i[o],!C.relative[a=u.type]);)if((s=C.find[a])&&(r=s(u.matches[0].replace(ve,ye),he.test(i[0].type)&&l(t.parentNode)||t))){if(i.splice(o,1),!(e=r.length&&d(i)))return Z.apply(n,r),n;break}}return(c||N(e,f))(r,t,!M,n,!t||he.test(e)&&l(t.parentNode)||t),n},x.sortStable=U.split("").sort(V).join("")===U,x.detectDuplicates=!!L,O(),x.sortDetached=o(function(e){return 1&e.compareDocumentPosition(R.createElement("fieldset"))}),o(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||i("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),x.attributes&&o(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||i("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),o(function(e){return null==e.getAttribute("disabled")})||i(Y,function(e,t,n){var r;if(!n)return!0===e[t]?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null}),t}(e),i=function(e,t){var n=navigator.vendor&&navigator.vendor.indexOf("Apple")>-1&&navigator.userAgent&&!navigator.userAgent.match("CriOS")&&e.getMatchedCSSRules,o=function(t,n){for(var r=[],o=e.getMatchedCSSRules(t,n)||[],i=o.length;i--;)for(var u=o[i].style,a=u.length;a--;){var s=u[a];r[s]=u.getPropertyValue(s),r.push(s)}return r.sort(),r.getPropertyValue=function(e){return r[e]},r},i=function(e){return"string"==typeof e&&e.length>1&&'"'===e[0]&&'"'===e[e.length-1]&&(e=e.substring(1,e.length-1)),e},u=function(e){if("string"!=typeof e||e.indexOf('url("')<0)return e;var t=/url\(\"(.*?)\"\)/g;return e.replace(t,"url($1)")},a=function(t,r){return n&&r?o(t,r):e.getComputedStyle(t,r)},s=function(e,t,n){var r=a(e,t);if(!r)return null;var o=r.getPropertyValue(n);return o=u(o),"content"===n&&(o=i(o)),o},l=function(e,t){var n,o;try{var i=e.split(":",2);n=i[0].trim();var u=r.createRegexText(i[1].trim());o=new RegExp(u,"i")}catch(t){"undefined"!=typeof console&&console.error&&void 0}var a=function(e){if(!o||!n)return!1;var r=s(e,t,n);return r&&o.test(r)};this.matches=a};return{extendSizzle:function(e){e.selectors.pseudos["matches-css"]=e.selectors.createPseudo(function(e){var t=new l(e);return function(e){return t.matches(e)}}),e.selectors.pseudos["matches-css-before"]=e.selectors.createPseudo(function(e){var t=new l(e,":before");return function(e){return t.matches(e)}}),e.selectors.pseudos["matches-css-after"]=e.selectors.createPseudo(function(e){var t=new l(e,":after");return function(e){return t.matches(e)}})}}}(e,document),u=function(){var e=[":has",":contains",":matches-css"];i.extendSizzle(o);var t=function(e,t,n,r){var o=new RegExp("([^\\\\]|^)\\\\"+n,"g");return r=r.replace(o,"$1"+n),":"+t+"("+r+")"},n=function(t){if("ID"===t.type||"CLASS"===t.type||"ATTR"===t.type||"TAG"===t.type||"CHILD"===t.type)return!0;if("PSEUDO"===t.type){for(var n=e.length;n--;)if(t.value.indexOf(e[n])>=0)return!1;return!0}return!1},r=function(e){return" "===e.type||">"===e.type},u=function(e,t,n){e=e||"",t&&(e+=t.value);for(var r=0;r<n.length;r++)e+=n[r].value;return e},a=function(e){var t=o.tokenize(e);if(1!==t.length)return{simple:null,relation:null,complex:e,selectorText:e};t=t[0];for(var i="",a="",s=[],l=[],c=null,d=0;d<t.length;d++){var f=t[d];l.length>0||!n(f)&&!r(f)?(s.length>0&&(l=l.concat(s),s=[]),l.push(f)):r(f)?(i=u(i,c,s),s=[],c=f):s.push(f)}if(s.length>0&&(i=u(i,c,s),c=null),a=u(a,null,l),!i)return{simple:null,relation:null,complex:e,selectorText:e};try{document.querySelector(i)}catch(t){return{simple:null,relation:null,complex:e,selectorText:e}}return{simple:i,relation:null===c?null:c.type,complex:""===a?null:a,selectorText:e}},s=function(e){try{var n=/\[-ext-([a-z-_]+)=(["'])((?:(?=(\\?))\4.)*?)\2\]/g,r=e.replace(n,t),i=a(r);return o.compile(e),i.complex&&o.compile(i.complex),i}catch(t){return"undefined"!=typeof console&&console.error&&void 0,null}},l=function(e){var t=[],n=document.querySelectorAll(e.simple);if(!n||!n.length)return t;for(var r=n.length;r--;){var i=n[r],u=o(e.complex,i);if(">"===e.relation)for(var a=u.length;a--;){var s=u[a];s.parentNode===i&&t.push(s)}else t=t.concat(u)}return o.uniqueSort(t)};return function(e){var t=s(e);this.compiledSelector=t,this.selectorText=null==t?null:t.selectorText,this.querySelectorAll=function(){return null===t?[]:t.simple?t.complex?l(t):document.querySelectorAll(t.simple):o(t.complex)},this.matches=function(e){return o.matchesSelector(e,t.selectorText)}}}();return function(r){var o,i=[],a=[],s=function(e,t){var n=e.indexOf(t,e.length-t.length);return n>=0?e.substring(0,n):e},l=function(e){for(var t=a.length;t--;){var n=a[t];if(n.node===e)return n}return null},c=function(e){if(!e.protectionObserver){var t=e.node,r=e.rule.style;for(var o in r)if(void 0!==t.style.getPropertyValue(o)){var i=r[o];i=s(i.trim(),"!important").trim(),t.style.setProperty(o,i,"important")}e.protectionObserver=n.protectAttribute(t,"style")}},d=function(e){e.protectionObserver&&e.protectionObserver.disconnect(),e.node.style.cssText=e.originalStyle},f=function(e){for(var t=e.selector,n=t.querySelectorAll(),r=n.length;r--;){var o=n[r],i=l(o);if(i)c(i);else{i={node:o,rule:e,originalStyle:o.style.cssText,protectionObserver:null},c(i),a.push(i)}}return n},p=function(e){for(var t=[],n=e.length;n--;){var r=e[n],o=f(r);t=t.concat(o)}for(var i=a.length;i--;){var u=a[i];-1===t.indexOf(u.node)&&(d(u),a.splice(i,1))}},m=!1,g=0,h=function(){m&&(m=!1,p(i),g=(new Date).getTime())},v=function(){e.requestAnimationFrame?e.requestAnimationFrame(h):h()},y=function(){if(!m){m=!0;var e=(new Date).getTime()-g,t=50-e;t>0?setTimeout(function(){v()},t):v()}},b=function(){o||(o=!0,n.observeDom(y))},x=function(){p(i),b(),"complete"!==document.readyState&&document.addEventListener("DOMContentLoaded",function(){p(i)})},C=function(){o&&(n.disconnectDom(y),o=!1);for(var e=a.length;e--;){var t=a[e];d(t)}};i=function(e){for(var n=[],r=t.parseCss(e),o=r.length;o--;){var i=r[o],a=Object.create(null);a.selector=new u(i.selectors),a.style=i.style,n.push(a)}return n}(r),this.dispose=C,this.apply=x,this.getAffectedElements=function(){return a}}}(e),o={};!function(e,t){"use strict";var n=function(e){return Object.prototype.hasOwnProperty.call(t,e)}("browser")?t.browser:t.chrome;e.i18n=n.i18n,e.runtimeImpl=function(){return{onMessage:function(){return n.runtime&&n.runtime.onMessage?n.runtime.onMessage:n.extension.onMessage||n.extension.onRequest}(),sendMessage:function(){return n.runtime&&n.runtime.sendMessage?n.runtime.sendMessage:n.extension.sendMessage||n.extension.sendRequest}()}}()}(void 0!==o?o:adguard,this),function(t){"use strict";e.i18n=t.i18n,e.contentPage={sendMessage:t.runtimeImpl.sendMessage,onMessage:t.runtimeImpl.onMessage}}(o);var i=function(t){"use strict";var n=function(){var t=e.postMessage,n=e.addEventListener,r=0,o={},i=function(e){if(e.data&&e.data.direction&&"to-page-script@adguard"===e.data.direction){var t=o[e.data.requestId];if(t){var n=t.wrapper;t.onResponseReceived(n,e.data.block),delete o[e.data.requestId]}}};return{sendMessage:function(u,a,s,l){0===r&&n.call(e,"message",i,!1);var c=++r;o[c]={wrapper:s,onResponseReceived:l};var d={requestId:c,direction:"from-page-script@adguard",elementUrl:u,documentUrl:document.URL,requestType:a};t.call(e,d,"*")}}}();t.copyProperties=function(e,t,n){for(var r=0;r<n.length;r++){var o=n[r],i=Object.getOwnPropertyDescriptor(e,o);i&&Object.defineProperty(t,o,i)}},t.checkRequest=function(e,t,r){n.sendMessage(e,t,this,function(e,t){r(t)})}},u=function(t){"use strict";function n(e,i){if(!(this instanceof n))return r();if(arguments.length<1)return new r;var u=new r(e,i);return t.checkRequest(u.url,"WEBSOCKET",function(e){e&&o(u)}),u}if(!(e.WebSocket instanceof Function))return!1
;var r=WebSocket,o=Function.prototype.call.bind(r.prototype.close);n.prototype=r.prototype,e.WebSocket=n.bind(),t.copyProperties(r,WebSocket,["CONNECTING","OPEN","CLOSING","CLOSED","name","prototype"]),r.prototype.constructor=WebSocket},a=function(t){"use strict";function n(e){if(void 0!==e)return d(e)}function r(e,t){if(null===e||"object"!=typeof e)return e;for(var n=c(e.length),r=0;r<n.length;r++)p(n,r,{configurable:!1,enumerable:!1,writable:!1,value:t(e[r])});return p(n,"length",{configurable:!1,enumerable:!1,writable:!1,value:n.length}),n}function o(e){if(null===e||"object"!=typeof e)return e;var t=r(e.iceServers,function(e){var t=e.url,o=e.urls;return void 0===o||o instanceof c||(o=[o]),f(e,{url:{configurable:!1,enumerable:!1,writable:!1,value:n(t)},urls:{configurable:!1,enumerable:!1,writable:!1,value:r(o,n)}})});return f(e,{iceServers:{configurable:!1,enumerable:!1,writable:!1,value:t}})}function i(e,n){t.checkRequest(n,"WEBRTC",function(t){if(t)try{l(e)}catch(e){}})}function u(e,t){if(t&&t.iceServers)for(var n=t.iceServers,r=0;r<n.length;r++){var o=n[r];if(o&&(o.url&&i(e,o.url),o.urls))for(var u=0;u<o.urls.length;u++)i(e,o.urls[u])}}function a(e,t){if(!(this instanceof a))return s();e=o(e);var n=new s(e,t);return u(n,e),n}if(e.RTCPeerConnection instanceof Function||e.webkitRTCPeerConnection instanceof Function){var s=e.RTCPeerConnection||e.webkitRTCPeerConnection,l=Function.prototype.call.bind(s.prototype.close),c=Array,d=String,f=Object.create,p=Object.defineProperty;if(s.prototype.setConfiguration){var m=Function.prototype.call.bind(s.prototype.setConfiguration);s.prototype.setConfiguration=function(e){e=o(e),m(this,e),u(this,e)}}a.prototype=s.prototype;var g=a.bind();t.copyProperties(s,g,["caller","generateCertificate","name","prototype"]),s.prototype.constructor=g,"RTCPeerConnection"in e&&(e.RTCPeerConnection=g),"webkitRTCPeerConnection"in e&&(e.webkitRTCPeerConnection=g)}},s=function(){"use strict";function t(t){if(t.source===e&&t.data.direction&&"from-page-script@adguard"===t.data.direction&&t.data.elementUrl&&t.data.documentUrl){var n={type:"checkPageScriptWrapperRequest",elementUrl:t.data.elementUrl,documentUrl:t.data.documentUrl,requestType:t.data.requestType,requestId:t.data.requestId};contentPage.sendMessage(n,function(e){if(e){var n={direction:"to-page-script@adguard",elementUrl:t.data.elementUrl,documentUrl:t.data.documentUrl,requestType:t.data.requestType,requestId:e.requestId,block:e.block};t.source.postMessage(n,t.origin)}})}}e.addEventListener("message",t,!1)};!function(){var t={img:"IMAGE",input:"IMAGE",audio:"MEDIA",video:"MEDIA",object:"OBJECT",frame:"SUBDOCUMENT",iframe:"SUBDOCUMENT",embed:"OBJECT"},o=!1,l=["mail.google.com","inbox.google.com","productforums.google.com"],c=Object.create(null),d=1,f=!1,p=!1,m=null,g=!1;"undefined"!=typeof CssHitsCounter&&"function"==typeof CssHitsCounter.setCssHitsFoundCallback&&CssHitsCounter.setCssHitsFoundCallback(function(e){contentPage.sendMessage({type:"saveCssHitStats",stats:e})}),contentPage.onMessage.addListener(function(e,t,n){if("injectScripts"===e.type){if(n({applied:!0}),!v())return;R(e.scripts)}});var h=function(){if(C(),v()){m=document.documentElement.shadowRoot,m||"createShadowRoot"in document.documentElement&&-1==l.indexOf(document.domain)&&(m=document.documentElement.createShadowRoot(),m.appendChild(document.createElement("shadow")));var t=navigator.userAgent.toLowerCase();if(f=t.indexOf("firefox")>-1,p=t.indexOf("opera")>-1||t.indexOf("opr")>-1,e!==e.top){var n=Math.max(document.documentElement.clientWidth,e.innerWidth||0),r=Math.max(document.documentElement.clientHeight,e.innerHeight||0);g=r*n<1e5}q(),E()}},v=function(){return document instanceof HTMLDocument||document instanceof XMLDocument&&document.createElement("div")instanceof HTMLDivElement},y=function(){return"("+function(){var e=document.currentScript,t=e&&e.parentNode;t&&t.removeChild(e)}.toString()+")();"},b=function(){if(contentPage.isSafari)return!contentPage.isSafariContentBlockerEnabled;var e=navigator.userAgent.toLowerCase();if(e.indexOf("firefox")>=0)return!1;var t=e.indexOf("chrome/");if(t<0)return!1;var n=e.substring(t+7),r=Number.parseInt(n.substring(0,n.indexOf(".")));return r>=47&&r<=57},x=function(){return!contentPage.isSafari||!contentPage.isSafariContentBlockerEnabled},C=function(){if(v()||"about:blank"===e.location.href){var t=[];if(b()&&t.push("("+u.toString()+")(api);"),x()&&t.push("("+a.toString()+")(api);"),0!==t.length){s();var n=[];n.push("(function(){"),n.push("var api = {};"),n.push("try {"),n.push("("+i.toString()+")(api);"),n=n.concat(t),n.push("} catch (ex) { console.error('Error executing AG js: ' + ex); }"),n.push(y()),n.push("})();");var r=document.createElement("script");r.setAttribute("type","text/javascript"),r.textContent=n.join("\r\n"),(document.head||document.documentElement).appendChild(r)}}},S=function(){if(e===e.top){n.hideBySelector("iframe[src]",null,m);var t=function(e){for(var t=0;t<e.length;t++){var n=e[t].target;n&&U(n)}},r=new MutationObserver(t),o={attributes:!0,attributeFilter:["src"]},i=function(e){for(var t=[],n=0;n<e.length;n++)for(var i=e[n],u=i.addedNodes,a=0;a<u.length;a++){var s=u[a];"iframe"===s.localName&&t.push(s)}if(t.length>0)for(var l=t.length;l--;){var c=t[l];U(c),r.observe(c,o)}},u=function(){for(var e=document.getElementsByTagName("iframe"),t=0;t<e.length;t++)U(e[t]);if(n.unhideBySelector("iframe[src]",m),document.body){new MutationObserver(i).observe(document.body,{childList:!0,subtree:!0})}};["interactive","complete"].indexOf(document.readyState)>=0?u():document.addEventListener("DOMContentLoaded",u)}},E=function(){var t={type:"getSelectorsAndScripts",documentUrl:e.location.href,options:{filter:["selectors","scripts"],genericHide:g}};contentPage.sendMessage(t,w)},w=function(e){if(!e||!1===e.requestFilterReady)return void setTimeout(function(){E()},100);e.collapseAllElements?(T(e.selectors,e.useShadowDom),R(e.scripts),F()):(T(e.selectors,e.useShadowDom),R(e.scripts)),e&&e.selectors&&e.selectors.css&&e.selectors.css.length>0&&S(),"undefined"!=typeof CssHitsCounter&&"function"==typeof CssHitsCounter.count&&e&&e.selectors&&e.selectors.cssHitsCounterEnabled&&CssHitsCounter.count()},N=function(e,t,n){n&&!m&&(t=t.replace(new RegExp("::content ","g"),"")),e.textContent=t},T=function(e,t){e&&(A(e.css,t),D(e.extendedCss))},A=function(e,t){if(e&&0!==e.length)for(var n=0;n<e.length;n++){var r=document.createElement("style");r.setAttribute("type","text/css"),N(r,e[n],t),t&&m?m.appendChild(r):(document.head||document.documentElement).appendChild(r),O(r,t),L(r)}},D=function(e){e&&e.length&&new r(e.join("\n")).apply()},L=function(t){var n=e.MutationObserver||e.WebKitMutationObserver;if(n){new n(function(e){for(var n=0;n<e.length;n++){var r=e[n];if(t.hasAttribute("mod")&&"inner"==t.getAttribute("mod")){t.removeAttribute("mod");break}t.setAttribute("mod","inner");var o=!1;if(r.removedNodes.length>0)for(var i=0;i<r.removedNodes.length;i++)o=!0,t.appendChild(r.removedNodes[i]);else r.oldValue&&(o=!0,t.textContent=r.oldValue);o||t.removeAttribute("mod")}}).observe(t,{childList:!0,characterData:!0,subtree:!0,characterDataOldValue:!0})}},O=function(t,n){var r=e.MutationObserver||e.WebKitMutationObserver;if(r){var o=new r(function(e){for(var r=0;r<e.length;r++){var i=e[r],u=[].indexOf.call(e[r].removedNodes,t);if(-1!=u){var a=i.removedNodes[u];o.disconnect(),A([a.textContent],n);break}}});o.observe(t.parentNode,{childList:!0,characterData:!0})}},R=function(e){if(!o&&(o=!0,e&&0!==e.length)){for(var t=[],n=0;n<e.length;n++){var r=e[n];switch(r.scriptSource){case"local":t.push(r.rule);break;case"remote":f||p||t.push(r.rule)}}if(0!==t.length){var i=document.createElement("script");i.setAttribute("type","text/javascript"),t.unshift("try {"),t.push("} catch (ex) { console.error('Error executing AG js: ' + ex); }"),t.push(y()),i.textContent=t.join("\r\n"),(document.head||document.documentElement).appendChild(i)}}},q=function(){document.addEventListener("error",M,!0),document.addEventListener("load",M,!0)},M=function(e){var t=e.target,n=e.type,r=t.tagName.toLowerCase();n==("iframe"==r||"frame"==r||"embed"==r?"load":"error")&&U(t)},P=function(e){var t=e.src||e.data;return t&&0===t.indexOf("http")&&t!==e.baseURI?t:null},I=function(e){var t=e.tagName.toLowerCase(),n=d++;return c[n]={element:e,src:e.src,tagName:t},n},k=function(e){("iframe"===e.localName||"frame"===e.localName||"embed"===e.localName)&&e.clientHeight*e.clientWidth>12e4||n.hideElement(e,m)},B=function(e){if(e){var t=c[e.requestId];if(t){delete c[e.requestId];var r=t.element;if(!0===e.collapse){var o=t.src;n.collapseElement(r,o,m)}n.unhideElement(r,m)}}},U=function(e){var n=t[e.localName];if(n){var r=P(e);if(r){var o=I(e);k(e);var i={type:"processShouldCollapse",elementUrl:r,documentUrl:document.URL,requestType:n,requestId:o};contentPage.sendMessage(i,B)}}},H=function(e){if(e)for(var t=e.requests,n=0;n<t.length;n++){var r=t[n];B(r)}},j=function(){var e=[];for(var n in t)for(var r=t[n],o=document.getElementsByTagName(n),i=0;i<o.length;i++){var u=o[i],a=P(u);if(a){var s=I(u);e.push({elementUrl:a,requestType:r,requestId:s,tagName:n})}}var l={type:"processShouldCollapseMany",requests:e,documentUrl:document.URL};contentPage.sendMessage(l,H)},F=function(){"complete"===document.readyState||"loaded"===document.readyState||"interactive"===document.readyState?j():document.addEventListener("DOMContentLoaded",j)},$=function(){!1===document.hidden&&(document.removeEventListener("visibilitychange",$),h())};if(contentPage.isSafari&&document.hidden)return void document.addEventListener("visibilitychange",$);h()}()}(window);