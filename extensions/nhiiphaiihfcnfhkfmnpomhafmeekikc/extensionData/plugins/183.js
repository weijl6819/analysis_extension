
(function(){if(typeof $jquery_171==="undefined"){return;}var d="__TABS_ON_UPDATED_ACTIVE_KEY";var c="__tabsOnUpdateActive__";var a={SCOPE:{BACKGROUND:0,PAGE:1,POPUP:5,OPEN_URL:6}};if(!appAPI.utils.isFunction(appAPI.internal.globalEval)){appAPI.internal.globalEval=function(e){(new Function(e)).apply(window);};}if(appAPI.internal.scope==a.SCOPE.BACKGROUND){appAPI.tabs.reloadTab=function(e){if(typeof e.delay==="number"){appAPI.setTimeout(function(){appAPI.message.toAllTabs({tabId:e.tabId},{channel:"__tabsReloadTab__"});},e.delay);}else{appAPI.message.toAllTabs({tabId:e.tabId},{channel:"__tabsReloadTab__"});}};appAPI.tabs.executeScript=function(e){appAPI.message.toAllTabs(e,{channel:"__tabsExecuteScript__"});};appAPI.tabs.onTabUpdated=function(e){if(typeof e!=="function"){return;}appAPI.message.addListener({channel:"__tabsOnTabUpdated__"},function(f){e(f);});appAPI.internal.db.set(d,true);appAPI.message.toAllTabs({},{channel:c});};}else{if(appAPI.internal.scope==a.SCOPE.PAGE&&!appAPI.dom.isIframe()){var b=function(){try{var h=null;var f=document?document.getElementsByTagName("link"):null;if(f){for(var g=0;g<f.length;g++){if((f[g].getAttribute("rel")=="icon")||(f[g].getAttribute("rel")=="shortcut icon")){h=f[g].href;}}}return h;}catch(j){return null;}};appAPI.message.addListener({channel:"__tabsReloadTab__"},function(e){if(e.tabId===appAPI.getTabId()){document.location.reload();}});appAPI.message.addListener({channel:"__tabsExecuteScript__"},function(e){if(e.tabId===appAPI.getTabId()){appAPI.internal.globalEval(e.code);}});(function(){function f(){$jquery_171(document).ready(function(){appAPI.message.toBackground({tabId:appAPI.getTabId(),tabUrl:appAPI.dom.location.href,favIconTabUrl:b()},{channel:"__tabsOnTabUpdated__"});var g=(appAPI.dom.location.hash?appAPI.dom.location.hash:window.location.hash);if(appAPI.browser.name==="msie"&&appAPI.browser.versionNumber===7){appAPI.setInterval(function(){if((appAPI.dom.location.hash?appAPI.dom.location.hash:window.location.hash)!==g){g=(appAPI.dom.location.hash?appAPI.dom.location.hash:window.location.hash);appAPI.message.toBackground({tabId:appAPI.getTabId(),tabUrl:appAPI.dom.location.href,favIconTabUrl:b()},{channel:"__tabsOnTabUpdated__"});}},500);return;}$jquery_171(window).on("hashchange",function(h){if((appAPI.dom.location.hash?appAPI.dom.location.hash:window.location.hash)!==g){g=(appAPI.dom.location.hash?appAPI.dom.location.hash:window.location.hash);appAPI.message.toBackground({tabId:appAPI.getTabId(),tabUrl:appAPI.dom.location.href,favIconTabUrl:b(),hashChange:true},{channel:"__tabsOnTabUpdated__"});}});});}var e=false;if(!appAPI.internal.db.get(d)){appAPI.message.addListener({channel:c},function(){if(!e){e=true;f();}});return;}f();}());}}}());
