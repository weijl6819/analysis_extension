var Events=(function(){var a=Consts;var c=function(){var l=new Delegate();function j(o,n){if(typeof Reports!=="undefined"){Reports.error(new ErrorMessage(o,n));}}function m(n){l.invoke(n);}(function k(){if(chrome.tabs.cr_tabs_TabSelectionChanged_listeners_added===undefined&&chrome.tabs.hasOwnProperty("onHighlighted")){chrome.tabs.onHighlighted.addListener(m);chrome.tabs.cr_tabs_TabSelectionChanged_listeners_added=true;}})();return{addEventListener:function(n){if(typeof n==="function"){return l.addObserver(n);}}};};var f=function(){var j=new Delegate();function l(o,n){if(typeof Reports!=="undefined"){Reports.error(new ErrorMessage(o,n));}}function k(o,n){j.invoke(o,n);}(function m(){if(chrome.tabs.cr_tabs_TabClosed_listeners_added===undefined){chrome.tabs.onRemoved.addListener(k);chrome.tabs.cr_tabs_TabClosed_listeners_added=true;}})();return{addEventListener:function(n){if(typeof n==="function"){return j.addObserver(n);}}};};var i=function(){var l=new Delegate();function j(o,n){if(typeof Reports!=="undefined"){Reports.error(new ErrorMessage(o,n));}}function m(n){l.invoke(n);}(function k(){if(chrome.tabs.cr_tabs_TabCreated_listeners_added===undefined){chrome.tabs.onCreated.addListener(m);chrome.tabs.cr_tabs_TabCreated_listeners_added=true;}})();return{addEventListener:function(n){if(typeof n==="function"){return l.addObserver(n);}}};};var g=function(l,m,s){var o;function n(u,t){if(typeof Reports!=="undefined"){Reports.error(new ErrorMessage(u,t));}}function q(u){var t=false;if(!o.isEmpty()){if((u.url.indexOf("http")>=0)||(u.url.indexOf("file")>=0)){t=true;if(u.type=="main_frame"){if(typeof Crossrider!=="undefined"&&Crossrider.hasOwnProperty("_tabsUrlsByIds")){Crossrider._tabsUrlsByIds[u.tabId]=u.url;if(typeof Crossrider._framesUrlsByIds[u.tabId]==="undefined"){Crossrider._framesUrlsByIds[u.tabId]={};}}}else{if(u.type=="sub_frame"){if(typeof Crossrider!=="undefined"&&Crossrider.hasOwnProperty("_framesUrlsByIds")){if(typeof Crossrider._framesUrlsByIds[u.tabId]==="undefined"){Crossrider._framesUrlsByIds[u.tabId]={};}Crossrider._framesUrlsByIds[u.tabId][u.frameId]=u.url;}}}}}return t;}function r(v){function w(x){var y=true;if(IsDefined(x)){if(x.hasOwnProperty("redirectTo")&&(typeof(x.redirectTo)==="string"&&x.redirectTo.length>0)){return new ObserverResult(y,{redirectUrl:x.redirectTo});}if(x.hasOwnProperty("cancel")&&(x.cancel===true)){return new ObserverResult(!y,{cancel:true});}}}var t=null;if(l==="OldOnRequest"||l==="OnRequest"){if(s){var u=(typeof Crossrider._framesUrlsByIds[v.tabId]!=="undefined"&&Crossrider._framesUrlsByIds[v.tabId]!==null)?Crossrider._framesUrlsByIds[v.tabId][v.frameId]:undefined;u=(u!==undefined&&typeof v.url==="string"&&v.url!==u)?u:undefined;t=o.invokeWithCallback(w,{requestUrl:v.url,pageUrl:Crossrider._tabsUrlsByIds[v.tabId],iframeUrl:u,method:v.method});}else{t=o.invokeWithCallback(w,v.url,Crossrider._tabsUrlsByIds[v.tabId]);}}else{if(l==="OldOnBeforeNavigate"||l==="OnBeforeNavigate"){if(s){t=o.invokeWithCallback(w,{pageUrl:v.url});}else{t=o.invokeWithCallback(w,v.url);}}else{Reports.error(new ErrorMessage(new Error("wrong name on webRequest"),"Events->handleUserResult"));}}return t;}function k(u){var t=undefined;if(u.hasOwnProperty("isHaltOperation")&&u.isHaltOperation){if(u.hasOwnProperty("returnValues")){var v=u.returnValues[u.returnValues.length-1];if(IsDefined(v)&&v.hasOwnProperty("redirectUrl")&&typeof(v.redirectUrl)==="string"&&v.redirectUrl.length>0){t={redirectUrl:v.redirectUrl};}}}return t;}function j(t){var w=false;if(t.hasOwnProperty("returnValues")){var u;for(var v=0;v<t.returnValues.length;++v){currentObserversResult=t.returnValues[v];if(IsDefined(currentObserversResult)&&currentObserversResult.hasOwnProperty("cancel")){w=true;break;}}}return w;}var p=this;this.init=function(){if(typeof chrome.webRequest!=="undefined"&&chrome.webRequest["cr_"+l+"_listeners_added"]===undefined){chrome.webRequest.onBeforeRequest.addListener(function(t){return p.webRequestHandler(t);},m,["blocking"]);chrome.webRequest["cr_"+l+"_listeners_added"]=true;o=new Delegate();}};this.webRequestHandler=function(u){var w=false;if(q(u)===true){var t=r(u);if(IsDefined(t)){var v=k(t);if(IsDefined(v)){return v;}w=j(t);}}return{cancel:w};};this.addEventListener=function(v,u){var t=null;if(typeof v==="function"){t=o.addObserver(v,u);}return t;};this.remove=function(t){return o.removeObserver(t);};this.removeAll=function(){return o.removeAllObservers();};this.updateOpaque=function(t,u){return o.updateObserverOpaque(t,u);};return this;};var b=function(){var j=new g("OldOnRequest",{urls:["<all_urls>"]});return{init:j.init,addEventListener:j.addEventListener,remove:j.remove,removeAll:j.removeAll,updateOpaque:j.updateOpaque};};var e=function(){var j=new g("OldOnBeforeNavigate",{urls:["<all_urls>"],types:["main_frame"]});return{init:j.init,addEventListener:j.addEventListener,remove:j.remove,removeAll:j.removeAll,updateOpaque:j.updateOpaque};};var d=function(){var j=new g("OnRequest",{urls:["<all_urls>"]},true);return{init:j.init,addEventListener:j.addEventListener,remove:j.remove,removeAll:j.removeAll,updateOpaque:j.updateOpaque};};var h=function(){var j=new g("OnBeforeNavigate",{urls:["<all_urls>"],types:["main_frame"]},true);return{init:j.init,addEventListener:j.addEventListener,remove:j.remove,removeAll:j.removeAll,updateOpaque:j.updateOpaque};};reloadBackground=(function(){var k=new Delegate();var m=function(n){k.invoke();self.location.reload();};var j=function(n){k.addObserver(n);};(function l(){document.addEventListener(a.RELOAD_BG_EVENT_NAME,m);}());return{addListener:j};}());return{tabSelectionChanged:c(),tabClosed:f(),tabCeated:i(),oldWebRequest:b(),oldBeforeNavigate:e(),webRequest:d(),beforeNavigate:h(),reloadBackground:reloadBackground};})();
