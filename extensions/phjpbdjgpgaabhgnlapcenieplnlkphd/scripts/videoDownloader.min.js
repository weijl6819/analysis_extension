var __extends=(this&&this.__extends)||(function(){var extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b})||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}})();var VideoDownloader=(function(_super){__extends(VideoDownloader,_super);function VideoDownloader(Url){var _this=_super.call(this,Url)||this;_this.Url=Url;return _this}VideoDownloader.prototype.DownloadCallback=function(o){_super.prototype.DownloadCallback.call(this,o);var parsedObjects=null;if(o&&o.objects&&o.objects.items){parsedObjects=this.ParseVideos(o.objects.items||[]);dataDownloader.DownloadCompleted({hasChanged:o.hasChanged,hash:o.hash,objects:parsedObjects,hasData:(parsedObjects.length>0),settings:settings},this)}else{dataDownloader.DownloadCompleted(null,this)}};VideoDownloader.prototype.SortVideos=function(a,b){if(a.Position==b.Position)return 0;else if(a.Position<b.Position)return-1;else if(a.Position>b.Position)return 1};VideoDownloader.prototype.ParseVideos=function(json){var videos=[];if(Object.prototype.toString.call(json)!=='[object Array]'){json=[json]}for(var itemIdx=0;itemIdx<json.length;itemIdx++){var video={Description:'',Title:'',PublishedDate:null,PublishedDateString:'',Link:'',EmbeddedLink:'',VideoId:'',Position:-1,ThumbnailUrl:''};var videoDescription=$.trim(json[itemIdx].snippet.description);videoDescription=videoDescription.replace('<![CDATA[','').replace(']]>','');if(videoDescription.indexOf('&gt;')>=0){videoDescription=$("<div/>").html(videoDescription).text()}videoDescription=videoDescription.replace('&gt;','>').replace('&lt;','<');videoDescription=videoDescription.replace(/\<br \/\>/gm,'<br/>');videoDescription=videoDescription.replace(/\<br\/\><br\/\><br\/\>/gm,'<br/><br/>');videoDescription=videoDescription.replace(/\<br\/\><br\/\><br\/\>/gm,'<br/><br/>');video.Description=videoDescription;video.PublishedDate=moment(json[itemIdx].snippet.publishedAt).toDate();video.PublishedDateString=moment(json[itemIdx].snippet.publishedAt).format('ddd DD MMM YYYY');video.Title=$("<div/>").html(json[itemIdx].snippet.title).text();video.Position=parseInt(json[itemIdx].snippet.position);video.VideoId=json[itemIdx].snippet.resourceId.videoId;video.Link='https://youtu.be/'+video.VideoId;video.ThumbnailUrl=json[itemIdx].snippet.thumbnails.high.url;video.EmbeddedLink='https://www.youtube.com/embed/'+video.VideoId+'?autoplay=1&autohide=1&showinfo=0&allowScriptAccess=never';videos[videos.length]=video}if(videos.length>0){videos=videos.sort(this.SortVideos)}return videos};return VideoDownloader}(XmlDownloader))