function sanitizeHref(e){return e&&e.trim().toLowerCase().startsWith("javascript:")?"":e}function binarySearch(e,t,n){for(var s=0,i=t.length-1;i>=s;){var r=s+i>>1,a=n(e,t[r]);if(a>0)s=r+1;else{if(!(0>a))return r;i=r-1}}return-(s+1)}function insertionIndexForObjectInListSortedByFunction(e,t,n){var s=binarySearch(e,t,n);if(0>s)return-s-1;for(;s>0&&0===n(e,t[s-1]);)s--;return s}function createSearchRegex(e,t,n){var s,i=t?"g":"gi";if(n)try{s=new RegExp(e,i)}catch(r){}return s||(s=createPlainTextSearchRegex(e,i)),s}function createPlainTextSearchRegex(e,t){for(var n=String.regexSpecialCharacters(),s="",i=0;i<e.length;++i){var r=e.charAt(i);-1!=n.indexOf(r)&&(s+="\\"),s+=r}return new RegExp(s,t||"")}function countRegexMatches(e,t){for(var n,s=t,i=0;s&&(n=e.exec(s));)n[0].length>0&&++i,s=s.substring(n.index+1);return i}function numberToStringWithSpacesPadding(e,t){var n=e.toString(),s=Math.max(0,t-n.length),i=Array(s+1).join(" ");return i+n}function loadXHR(e,t,n){function s(){return i.readyState===XMLHttpRequest.DONE?200===i.status?(n(i.responseText),void 0):(n(null),void 0):void 0}var i=new XMLHttpRequest;return i.open("GET",e,t),t&&(i.onreadystatechange=s),i.send(null),t?null:200===i.status?i.responseText:null}function StringPool(){this.reset()}function importScript(e){if(!_importedScripts[e]){var t=new XMLHttpRequest;if(_importedScripts[e]=!0,window.flattenImports&&(e=e.split("/").reverse()[0]),t.open("GET",e,!1),t.send(null),!t.responseText)throw"empty response arrived for script '"+e+"'";var n=WebInspector.ParsedURL.completeURL(window.location.href,e);window.eval(t.responseText+"\n//@ sourceURL="+n)}}function getFavicon(e){if(defaultFavicon||$.ajax({url:"chrome://favicon/http://sample.com",async:!1,success:function(e){defaultFavicon=e}}),/^http/.test(e)||(e="http://"+e),/.ico$/.test(e))return e;var t="",n=e.parseUrl(),s=n.hostname.split(".");return(4===s.length||3===s.length)&&(n.hostname=s.slice(1).join(".")),$.ajax({url:"http://"+n.hostname+"/favicon.ico",async:!1,success:function(){t="http://"+n.hostname+"/favicon.ico"},error:function(){t="http://"+n.hostname+"/favicon.ico"}}),t}function copyToClipboard(e){var t=document.createElement("textarea");t.value=e,t.style="width:1px;height:1px;",document.body.appendChild(t),t.select(),document.execCommand("Copy"),document.body.removeChild(t)}function removeSubsequentNodes(e,t){for(var n=e;n&&n!==t;){var s=n;n=n.nextSibling,s.removeSelf()}}function Size(e,t){this.width=e,this.height=t}function AnchorBox(e,t,n,s){this.x=e||0,this.y=t||0,this.width=n||0,this.height=s||0}function isEnterKey(e){return 229!==e.keyCode&&"Enter"===e.keyIdentifier}function consumeEvent(e){e.consume()}function NonLeakingMutationObserver(e){this._observer=new WebKitMutationObserver(e),NonLeakingMutationObserver._instances.push(this),NonLeakingMutationObserver._unloadListener||(NonLeakingMutationObserver._unloadListener=function(){for(;NonLeakingMutationObserver._instances.length;)NonLeakingMutationObserver._instances[NonLeakingMutationObserver._instances.length-1].disconnect()},window.addEventListener("unload",NonLeakingMutationObserver._unloadListener,!1))}function TreeOutline(e,t){this.children=[],this.selectedTreeElement=null,this._childrenListNode=e,this.childrenListElement=this._childrenListNode,this._childrenListNode.removeChildren(),this.expandTreeElementsWhenArrowing=!1,this.root=!0,this.hasChildren=!1,this.expanded=!0,this.selected=!1,this.treeOutline=this,this.comparator=null,this.searchable=!1,this.searchInputElement=null,this.setFocusable(!t),this._childrenListNode.addEventListener("keydown",this._treeKeyDown.bind(this),!0),this._childrenListNode.addEventListener("keypress",this._treeKeyPress.bind(this),!0),this._treeElementsMap=new Map,this._expandedStateMap=new Map}function TreeElement(e,t,n){this._title=e,this.representedObject=t||{},this._hidden=!1,this._selectable=!0,this.expanded=!1,this.selected=!1,this.hasChildren=n,this.children=[],this.treeOutline=null,this.parent=null,this.previousSibling=null,this.nextSibling=null,this._listItemNode=null}var Stylomatic=function(){function e(n){if(!(this instanceof e))return new e(n);Object.defineProperty(this,"__ident__",{value:Object.__identseed__++});var s=t[this.__ident__]={};if(n&&n.constructor===CSSStyleSheet){s.sheet=n;for(var i=n.cssRules.length;i;s["CSSRule"+i]=n.cssRules[i--]);}else{var r=document.createElement("style");document.querySelector("head").appendChild(r),s.sheet=r.sheet}s.rules={}}Object.__identseed__||(Object.__identseed__=1);var t={},n=e.prototype,s=e;return n.tag=function(){return t[this.__ident__].sheet.ownerNode},n.add=function(e,n,s){var i=t[this.__ident__],r=i.sheet,a=void 0===s?r.cssRules.length:Math.max(Math.min(Number(s)>>0,r.cssRules.length),0);return r.insertRule(n,a),i.rules[e]=r.cssRules[a]},n.getName=function(e){for(var n=t[this.__ident__],s=Object.keys(n),i=s.length;i--;)if(n[s[i]]===e)return s[i]},n.get=function(e){var n=t[this.__ident__];return n.rules[e]},n.rename=function(e,n){var s=t[this.__ident__];return s[n]=s[e],delete s[e],s[n]},n.nameFromSelector=function(e){for(var n=t[this.__ident__],s=Object.keys(n),i=s.length;i--;)if(n[s[i]].selectorText===e)return s[i]},n.findFromSelector=function(e){for(var n=t[this.__ident__],s=Object.keys(n),i=s.length;i--;)if(n[s[i]].selectorText===e)return n[s[i]]},n.remove=function(e){var n=t[this.__ident__],s=n.sheet,i=n.rules,r=[].indexOf.call(s.cssRules,i[e]),a=null;return-1!==r&&(s.removeRule(r),a=i[e],delete i[e]),a},n.replace=function(e,n){var s=t[this.__ident__],i=s.sheet,r=s.rules,a=[].indexOf.call(i.cssRules,r[e]);return-1!==a?(i.removeRule(a),i.insertRule(n,a),r[e]=i.cssRules[a],r[e]):this.add(e,n)},s.fromStyleTag=function(t){return t&&t.sheet&&t.sheet.constructor===CSSStyleSheet?new e(t.sheet):null},e}();Object.isEmpty=function(e){for(var t in e)return!1;return!0},Object.values=function(e){for(var t=Object.keys(e),n=[],s=0;s<t.length;++s)n.push(e[t[s]]);return n},String.prototype.hasSubstring=function(e,t){return t?this.match(new RegExp(e.escapeForRegExp(),"i")):-1!==this.indexOf(e)},String.prototype.findAll=function(e){for(var t=[],n=this.indexOf(e);-1!==n;)t.push(n),n=this.indexOf(e,n+e.length);return t},String.prototype.lineEndings=function(){return this._lineEndings||(this._lineEndings=this.findAll("\n"),this._lineEndings.push(this.length)),this._lineEndings},String.prototype.escapeCharacters=function(e){for(var t=!1,n=0;n<e.length;++n)if(-1!==this.indexOf(e.charAt(n))){t=!0;break}if(!t)return String(this);for(var s="",n=0;n<this.length;++n)-1!==e.indexOf(this.charAt(n))&&(s+="\\"),s+=this.charAt(n);return s},String.regexSpecialCharacters=function(){return"^[]{}()\\.$*+?|-,"},String.prototype.escapeForRegExp=function(){return this.escapeCharacters(String.regexSpecialCharacters)},String.prototype.escapeHTML=function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},String.prototype.collapseWhitespace=function(){return this.replace(/[\s\xA0]+/g," ")},String.prototype.trimMiddle=function(e){if(this.length<=e)return String(this);var t=e>>1,n=e-t-1;return this.substr(0,t)+"…"+this.substr(this.length-n,n)},String.prototype.trimEnd=function(e){return this.length<=e?String(this):this.substr(0,e-1)+"…"},String.prototype.trimURL=function(e){var t=this.replace(/^(https|http|file):\/\//i,"");return e&&(t=t.replace(new RegExp("^"+e.escapeForRegExp(),"i"),"")),t},String.prototype.toTitleCase=function(){return this.substring(0,1).toUpperCase()+this.substring(1)},String.prototype.compareTo=function(e){return this>e?1:e>this?-1:0},String.prototype.removeURLFragment=function(){var e=this.indexOf("#");return-1==e&&(e=this.length),this.substring(0,e)},String.prototype.startsWith=function(e){return!this.lastIndexOf(e,0)},String.prototype.endsWith=function(e){return-1!==this.indexOf(e,this.length-e.length)},Number.constrain=function(e,t,n){return t>e?e=t:e>n&&(e=n),e},Date.prototype.toISO8601Compact=function(){function e(e){return e>9?""+e:"0"+e}return this.getFullYear()+e(this.getMonth()+1)+e(this.getDate())+"T"+e(this.getHours())+e(this.getMinutes())+e(this.getSeconds())},Object.defineProperty(Array.prototype,"remove",{value:function(e,t){if(t){var n=this.indexOf(e);return-1!==n&&this.splice(n,1),void 0}for(var s=this.length,i=0;s>i;++i)this[i]===e&&this.splice(i,1)}}),Object.defineProperty(Array.prototype,"keySet",{value:function(){for(var e={},t=0;t<this.length;++t)e[this[t]]=!0;return e}}),Object.defineProperty(Array.prototype,"upperBound",{value:function(e){for(var t=0,n=this.length;n>0;){var s=n>>1,i=t+s;e>=this[i]?(t=i+1,n-=s+1):n=s}return t}}),Object.defineProperty(Array.prototype,"rotate",{value:function(e){for(var t=[],n=e;n<e+this.length;++n)t.push(this[n%this.length]);return t}}),Object.defineProperty(Uint32Array.prototype,"sort",{value:Array.prototype.sort}),function(){var e={value:function(e,t,n,s){function i(e,t,n){var s=e[t];e[t]=e[n],e[n]=s}var r=this[s];i(this,n,s);for(var a=t,o=t;n>o;++o)e(this[o],r)<0&&(i(this,a,o),++a);return i(this,n,a),a}};Object.defineProperty(Array.prototype,"partition",e),Object.defineProperty(Uint32Array.prototype,"partition",e);var t={value:function(e,t,n,s){function i(e,t,n,s,r){if(!(n>=s)){var a=Math.floor(Math.random()*(s-n))+n,o=e.partition(t,n,s,a);i(e,t,n,o-1,r),n+r-1>o&&i(e,t,o+1,s,n+r-1-o)}}return 0===t&&n===this.length-1&&s>=this.length?this.sort(e):i(this,e,t,n,s),this}};Object.defineProperty(Array.prototype,"sortRange",t),Object.defineProperty(Uint32Array.prototype,"sortRange",t)}(),Object.defineProperty(Array.prototype,"qselect",{value:function(e,t){if(!(0>e||e>=this.length)){t||(t=function(e,t){return e-t});for(var n=0,s=this.length-1;;){var i=this.partition(t,n,s,Math.floor((s+n)/2));if(i===e)return this[e];i>e?s=i-1:n=i+1}}}}),Object.defineProperty(Array.prototype,"binaryIndexOf",{value:function(e,t){var n=binarySearch(e,this,t);return n>=0?n:-1}}),Object.defineProperty(Array.prototype,"select",{value:function(e){for(var t=new Array(this.length),n=0;n<this.length;++n)t[n]=this[n][e];return t}}),Object.defineProperty(Array.prototype,"peekLast",{value:function(){return this[this.length-1]}}),Object.defineProperty(Array.prototype,"multidimSort",{value:function(e,t){for(t||(t=[]);t.length<e.length;)t.push("asc");var n=[];for(a=this.length;a--;)if(i=this[a],n.length){for(var s=0,r=n.length-1;r>=s;){for(var o=s+r>>1,l=0,c=n[o],d=-1,h=e.length;0===l&&++d<h;){var p=e[d];switch(t[d]){case"desc":i[p]>c[p]?l=-1:i[p]<c[p]&&(l=1);break;case"asc":default:i[p]<c[p]?l=-1:i[p]>c[p]&&(l=1)}}if(l>0)s=++o;else{if(!(0>l))break;r=o-1}}n.splice(o,0,i)}else n.push(i);return n}}),String.sprintf=function(e){return String.vsprintf(e,Array.prototype.slice.call(arguments,1))},String.tokenizeFormatString=function(e,t){function n(e){r.push({type:"string",value:e})}function s(e,t,n){r.push({type:"specifier",specifier:e,precision:t,substitutionIndex:n})}function i(e){return!!/[0-9]/.exec(e)}for(var r=[],a=0,o=0,l=e.indexOf("%",o);-1!==l;l=e.indexOf("%",o)){if(n(e.substring(o,l)),o=l+1,i(e[o])){for(var c=parseInt(e.substring(o),10);i(e[o]);)++o;c>0&&"$"===e[o]&&(a=c-1,++o)}var d=-1;if("."===e[o])for(++o,d=parseInt(e.substring(o),10),isNaN(d)&&(d=0);i(e[o]);)++o;e[o]in t?(s(e[o],d,a),++a,++o):(n(e.substring(l,o+1)),++o)}return n(e.substring(o)),r},String.standardFormatters={d:function(e){return isNaN(e)?0:e},f:function(e,t){return e&&t.precision>-1&&(e=e.toFixed(t.precision)),isNaN(e)?t.precision>-1?Number(0).toFixed(t.precision):0:e},s:function(e){return e}},String.vsprintf=function(e,t){return String.format(e,t,String.standardFormatters,"",function(e,t){return e+t}).formattedResult},String.format=function(e,t,n,s,i){function r(){return'String.format("'+e+'", "'+t.join('", "')+'")'}function a(e){console.warn(r()+": "+e)}function o(e){console.error(r()+": "+e)}if(!e||!t||!t.length)return{formattedResult:i(s,e),unusedSubstitutions:t};for(var l=s,c=String.tokenizeFormatString(e,n),d={},h=0;h<c.length;++h){var p=c[h];"string"!==p.type?"specifier"===p.type?p.substitutionIndex>=t.length?(o("not enough substitution arguments. Had "+t.length+" but needed "+(p.substitutionIndex+1)+", so substitution was skipped."),l=i(l,"%"+(p.precision>-1?p.precision:"")+p.specifier)):(d[p.substitutionIndex]=!0,p.specifier in n?l=i(l,n[p.specifier](t[p.substitutionIndex],p)):(a("unsupported format character “"+p.specifier+"”. Treating as a string."),l=i(l,t[p.substitutionIndex]))):o('Unknown token type "'+p.type+'" found.'):l=i(l,p.value)}for(var u=[],h=0;h<t.length;++h)h in d||u.push(t[h]);return{formattedResult:l,unusedSubstitutions:u}};var createObjectIdentifier=function(){return"_"+ ++createObjectIdentifier._last};createObjectIdentifier._last=0;var Set=function(){this._set={},this._size=0};Set.prototype={add:function(e){var t=e.__identifier;t||(t=createObjectIdentifier(),e.__identifier=t),this._set[t]||++this._size,this._set[t]=e},remove:function(e){this._set[e.__identifier]&&(--this._size,delete this._set[e.__identifier])},items:function(){var e=new Array(this._size),t=0;for(var n in this._set)e[t++]=this._set[n];return e},hasItem:function(e){return this._set[e.__identifier]},size:function(){return this._size},clear:function(){this._set={},this._size=0}};var Map=function(){this._map={},this._size=0};Map.prototype={put:function(e,t){var n=e.__identifier;n||(n=createObjectIdentifier(),e.__identifier=n),this._map[n]||++this._size,this._map[n]=[e,t]},remove:function(e){var t=this._map[e.__identifier];return t?(--this._size,delete this._map[e.__identifier],t[1]):void 0},keys:function(){return this._list(0)},values:function(){return this._list(1)},_list:function(e){var t=new Array(this._size),n=0;for(var s in this._map)t[n++]=this._map[s][e];return t},get:function(e){var t=this._map[e.__identifier];return t?t[1]:void 0},contains:function(e){var t=this._map[e.__identifier];return!!t},size:function(){return this._size},clear:function(){this._map={},this._size=0}},StringPool.prototype={intern:function(e){if("__proto__"===e)return"__proto__";var t=this._strings[e];return void 0===t&&(this._strings[e]=e,t=e),t},reset:function(){this._strings=Object.create(null)},internObjectStrings:function(e,t){if("number"!=typeof t)t=100;else if(--t<0)throw"recursion depth limit reached in StringPool.deepIntern(), perhaps attempting to traverse cyclical references?";for(var n in e)switch(typeof e[n]){case"string":e[n]=this.intern(e[n]);break;case"object":this.internObjectStrings(e[n],t)}}};var _importedScripts={},loadScript=importScript;String.prototype.parseUrl=function(e){return new URL(this,e||document.baseURI)};var defaultFavicon=null;Node.prototype.rangeOfWord=function(e,t,n,s){var i,r,a=0,o=0;if(n||(n=this),s&&"backward"!==s&&"both"!==s)i=this,a=e;else{for(var l=this;l;){if(l===n){i||(i=n);break}if(l.nodeType===Node.TEXT_NODE)for(var c=l===this?e-1:l.nodeValue.length-1,d=c;d>=0;--d)if(-1!==t.indexOf(l.nodeValue[d])){i=l,a=d+1;break}if(i)break;l=l.traversePreviousNode(n)}i||(i=n,a=0)}if(s&&"forward"!==s&&"both"!==s)r=this,o=e;else{for(l=this;l;){if(l===n){r||(r=n);break}if(l.nodeType===Node.TEXT_NODE)for(var c=l===this?e:0,d=c;d<l.nodeValue.length;++d)if(-1!==t.indexOf(l.nodeValue[d])){r=l,o=d;break}if(r)break;l=l.traverseNextNode(n)}r||(r=n,o=n.nodeType===Node.TEXT_NODE?n.nodeValue.length:n.childNodes.length)}var h=this.ownerDocument.createRange();return h.setStart(i,a),h.setEnd(r,o),h},Node.prototype.traverseNextTextNode=function(e){var t=this.traverseNextNode(e);if(t){for(;t&&t.nodeType!==Node.TEXT_NODE;)t=t.traverseNextNode(e);return t}},Node.prototype.rangeBoundaryForOffset=function(e){for(var t=this.traverseNextTextNode(this);t&&e>t.nodeValue.length;)e-=t.nodeValue.length,t=t.traverseNextTextNode(this);return t?{container:t,offset:e}:{container:this,offset:0}},Element.prototype.removeStyleClass=function(e){this.classList.remove(e)},Element.prototype.removeMatchingStyleClasses=function(e){var t=new RegExp("(^|\\s+)"+e+"($|\\s+)");t.test(this.className)&&(this.className=this.className.replace(t," "))},Element.prototype.addStyleClass=function(e){this.classList.add(e)},Element.prototype.hasStyleClass=function(e){return this.classList.contains(e)},Element.prototype.enableStyleClass=function(e,t){t?this.addStyleClass(e):this.removeStyleClass(e)},Element.prototype.positionAt=function(e,t){"number"==typeof e?this.style.setProperty("left",e+"px"):this.style.removeProperty("left"),"number"==typeof t?this.style.setProperty("top",t+"px"):this.style.removeProperty("top")},Element.prototype.isScrolledToBottom=function(){return this.scrollTop+this.clientHeight===this.scrollHeight},Element.prototype.removeSelf=function(){this.parentElement&&this.parentElement.removeChild(this)},CharacterData.prototype.removeSelf=Element.prototype.removeSelf,DocumentType.prototype.removeSelf=Element.prototype.removeSelf,Element.prototype.measurePreferredSize=function(e){e=e||document.body,e.appendChild(this),this.positionAt(0,0);var t=new Size(this.offsetWidth,this.offsetHeight);return this.positionAt(void 0,void 0),this.removeSelf(),t},Node.prototype.enclosingNodeOrSelfWithNodeNameInArray=function(e){for(var t=this;t&&t!==this.ownerDocument;t=t.parentNode)for(var n=0;n<e.length;++n)if(t.nodeName.toLowerCase()===e[n].toLowerCase())return t;return null},Node.prototype.enclosingNodeOrSelfWithNodeName=function(e){return this.enclosingNodeOrSelfWithNodeNameInArray([e])},Node.prototype.enclosingNodeOrSelfWithClass=function(e,t){for(var n=this;n&&n!==t&&n!==this.ownerDocument;n=n.parentNode)if(n.nodeType===Node.ELEMENT_NODE&&n.hasStyleClass(e))return n;return null},Element.prototype.query=function(e){return this.ownerDocument.evaluate(e,this,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue},Element.prototype.removeChildren=function(){this.firstChild&&(this.textContent="")},Element.prototype.isInsertionCaretInside=function(){var e=window.getSelection();if(!e.rangeCount||!e.isCollapsed)return!1;var t=e.getRangeAt(0);return t.startContainer.isSelfOrDescendant(this)},Element.prototype.createChild=function(e,t){var n=this.ownerDocument.createElement(e);return t&&(n.className=t),this.appendChild(n),n},DocumentFragment.prototype.createChild=Element.prototype.createChild,Element.prototype.createTextChild=function(e){var t=this.ownerDocument.createTextNode(e);return this.appendChild(t),t},DocumentFragment.prototype.createTextChild=Element.prototype.createTextChild,Element.prototype.totalOffsetLeft=function(){return this.totalOffset().left},Element.prototype.totalOffsetTop=function(){return this.totalOffset().top},Element.prototype.totalOffset=function(){for(var e=0,t=0,n=this;n;n=n.offsetParent)e+=n.offsetLeft,t+=n.offsetTop;return{left:e,top:t}},Element.prototype.scrollOffset=function(){for(var e=0,t=0,n=this;n;n=n.scrollParent)e+=n.scrollLeft,t+=n.scrollTop;return{left:e,top:t}},Element.prototype.offsetRelativeToWindow=function(e){for(var t=new AnchorBox,n=this,s=this.ownerDocument.defaultView;s&&n&&(t.x+=n.totalOffsetLeft(),t.y+=n.totalOffsetTop(),s!==e);)n=s.frameElement,s=s.parent;return t},Element.prototype.boxInWindow=function(e){e=e||this.ownerDocument.defaultView;var t=this.offsetRelativeToWindow(window);return t.width=Math.min(this.offsetWidth,window.innerWidth-t.x),t.height=Math.min(this.offsetHeight,window.innerHeight-t.y),t},Element.prototype.setTextAndTitle=function(e){this.textContent=e,this.title=e},KeyboardEvent.prototype.__defineGetter__("data",function(){switch(this.type){case"keypress":return this.ctrlKey||this.metaKey?"":String.fromCharCode(this.charCode);case"keydown":case"keyup":return this.ctrlKey||this.metaKey||this.altKey?"":String.fromCharCode(this.which)}}),Event.prototype.consume=function(e){this.stopImmediatePropagation(),e&&this.preventDefault(),this.handled=!0},Text.prototype.select=function(e,t){e=e||0,t=t||this.textContent.length,0>e&&(e=t+e);var n=this.ownerDocument.defaultView.getSelection();n.removeAllRanges();var s=this.ownerDocument.createRange();return s.setStart(this,e),s.setEnd(this,t),n.addRange(s),this},Element.prototype.selectionLeftOffset=function(){var e=window.getSelection();if(!e.containsNode(this,!0))return null;for(var t=e.anchorOffset,n=e.anchorNode;n!==this;){for(;n.previousSibling;)n=n.previousSibling,t+=n.textContent.length;n=n.parentNode}return t},Node.prototype.isAncestor=function(e){if(!e)return!1;for(var t=e.parentNode;t;){if(this===t)return!0;t=t.parentNode}return!1},Node.prototype.isDescendant=function(e){return!!e&&e.isAncestor(this)},Node.prototype.isSelfOrAncestor=function(e){return!!e&&(e===this||this.isAncestor(e))},Node.prototype.isSelfOrDescendant=function(e){return!!e&&(e===this||this.isDescendant(e))},Node.prototype.traverseNextNode=function(e){var t=this.firstChild;if(t)return t;if(e&&this===e)return null;if(t=this.nextSibling)return t;for(t=this;!(!t||t.nextSibling||e&&t.parentNode&&t.parentNode===e);)t=t.parentNode;return t?t.nextSibling:null},Node.prototype.traversePreviousNode=function(e){if(e&&this===e)return null;for(var t=this.previousSibling;t&&t.lastChild;)t=t.lastChild;return t?t:this.parentNode},NonLeakingMutationObserver._instances=[],NonLeakingMutationObserver.prototype={observe:function(e,t){this._observer&&this._observer.observe(e,t)},disconnect:function(){this._observer&&this._observer.disconnect(),NonLeakingMutationObserver._instances.remove(this),delete this._observer}},TreeOutline.prototype.setFocusable=function(e){e?this._childrenListNode.setAttribute("tabIndex",0):this._childrenListNode.removeAttribute("tabIndex")},TreeOutline.prototype.appendChild=function(e){var t;t=this.treeOutline.comparator?insertionIndexForObjectInListSortedByFunction(e,this.children,this.treeOutline.comparator):this.children.length,this.insertChild(e,t)},TreeOutline.prototype.insertChild=function(e,t){if(!e)throw"child can't be undefined or null";var n=t>0?this.children[t-1]:null;n?(n.nextSibling=e,e.previousSibling=n):e.previousSibling=null;var s=this.children[t];s?(s.previousSibling=e,e.nextSibling=s):e.nextSibling=null,this.children.splice(t,0,e),this.hasChildren=!0,e.parent=this,e.treeOutline=this.treeOutline,e.treeOutline._rememberTreeElement(e);for(var i=e.children[0];i;)i.treeOutline=this.treeOutline,i.treeOutline._rememberTreeElement(i),i=i.traverseNextTreeElement(!1,e,!0);e.hasChildren&&"undefined"!=typeof e.treeOutline._expandedStateMap.get(e.representedObject)&&(e.expanded=e.treeOutline._expandedStateMap.get(e.representedObject)),this._childrenListNode||(this._childrenListNode=this.treeOutline._childrenListNode.ownerDocument.createElement("ol"),this._childrenListNode.parentTreeElement=this,this._childrenListNode.classList.add("children"),this.hidden&&this._childrenListNode.classList.add("hidden")),e._attach()},TreeOutline.prototype.removeChildAtIndex=function(e){if(0>e||e>=this.children.length)throw"childIndex out of range";var t=this.children[e];this.children.splice(e,1);var n=t.parent;t.deselect()&&(t.previousSibling?t.previousSibling.select():t.nextSibling?t.nextSibling.select():n.select()),t.previousSibling&&(t.previousSibling.nextSibling=t.nextSibling),t.nextSibling&&(t.nextSibling.previousSibling=t.previousSibling),t.treeOutline&&(t.treeOutline._forgetTreeElement(t),t.treeOutline._forgetChildrenRecursive(t)),t._detach(),t.treeOutline=null,t.parent=null,t.nextSibling=null,t.previousSibling=null},TreeOutline.prototype.removeChild=function(e){if(!e)throw"child can't be undefined or null";var t=this.children.indexOf(e);if(-1===t)throw"child not found in this node's children";this.removeChildAtIndex.call(this,t)},TreeOutline.prototype.removeChildren=function(){for(var e=0;e<this.children.length;++e){var t=this.children[e];t.deselect(),t.treeOutline&&(t.treeOutline._forgetTreeElement(t),t.treeOutline._forgetChildrenRecursive(t)),t._detach(),t.treeOutline=null,t.parent=null,t.nextSibling=null,t.previousSibling=null}this.children=[]},TreeOutline.prototype._rememberTreeElement=function(e){this._treeElementsMap.get(e.representedObject)||this._treeElementsMap.put(e.representedObject,[]);var t=this._treeElementsMap.get(e.representedObject);-1===t.indexOf(e)&&t.push(e)},TreeOutline.prototype._forgetTreeElement=function(e){if(this._treeElementsMap.get(e.representedObject)){var t=this._treeElementsMap.get(e.representedObject);t.remove(e,!0),t.length||this._treeElementsMap.remove(e.representedObject)}},TreeOutline.prototype._forgetChildrenRecursive=function(e){for(var t=e.children[0];t;)this._forgetTreeElement(t),t=t.traverseNextTreeElement(!1,e,!0)},TreeOutline.prototype.getCachedTreeElement=function(e){if(!e)return null;var t=this._treeElementsMap.get(e);return t&&t.length?t[0]:null},TreeOutline.prototype.findTreeElement=function(e,t,n){if(!e)return null;var s=this.getCachedTreeElement(e);if(s)return s;for(var i=[],r=n(e);r&&(i.push(r),!this.getCachedTreeElement(r));r=n(r));if(!r)return null;for(var a=i.length-1;a>=0;--a){var o=this.getCachedTreeElement(i[a]);o&&o.onpopulate()}return this.getCachedTreeElement(e)},TreeOutline.prototype.treeElementFromPoint=function(e,t){var n=this._childrenListNode.ownerDocument.elementFromPoint(e,t);if(!n)return null;var s=n.enclosingNodeOrSelfWithNodeNameInArray(["ol","li"]);return s?s.parentTreeElement||s.treeElement:null},TreeOutline.prototype._treeKeyPress=function(e){if(this.searchable&&!WebInspector.isBeingEdited(this._childrenListNode)){var t=String.fromCharCode(e.charCode);t.trim()===t&&(this._startSearch(t),e.consume(!0))}},TreeOutline.prototype._treeKeyDown=function(e){if(e.target===this._childrenListNode&&this.selectedTreeElement&&!e.shiftKey&&!e.metaKey&&!e.ctrlKey){var t,n=!1;if("Up"!==e.keyIdentifier||e.altKey)if("Down"!==e.keyIdentifier||e.altKey)if("Left"===e.keyIdentifier){if(this.selectedTreeElement.expanded)e.altKey?this.selectedTreeElement.collapseRecursively():this.selectedTreeElement.collapse(),n=!0;else if(this.selectedTreeElement.parent&&!this.selectedTreeElement.parent.root)if(n=!0,this.selectedTreeElement.parent.selectable){for(t=this.selectedTreeElement.parent;t&&!t.selectable;)t=t.parent;n=t?!0:!1}else this.selectedTreeElement.parent&&this.selectedTreeElement.parent.collapse()}else if("Right"===e.keyIdentifier)if(this.selectedTreeElement.revealed()){if(this.selectedTreeElement.hasChildren)if(n=!0,this.selectedTreeElement.expanded){for(t=this.selectedTreeElement.children[0];t&&!t.selectable;)t=t.nextSibling;n=t?!0:!1}else e.altKey?this.selectedTreeElement.expandRecursively():this.selectedTreeElement.expand()}else this.selectedTreeElement.reveal(),n=!0;else 8===e.keyCode||46===e.keyCode?n=this.selectedTreeElement.ondelete():isEnterKey(e)?n=this.selectedTreeElement.onenter():e.keyCode===WebInspector.KeyboardShortcut.Keys.Space.code&&(n=this.selectedTreeElement.onspace());else{for(t=this.selectedTreeElement.traverseNextTreeElement(!0);t&&!t.selectable;)t=t.traverseNextTreeElement(!this.expandTreeElementsWhenArrowing);n=t?!0:!1}else{for(t=this.selectedTreeElement.traversePreviousTreeElement(!0);t&&!t.selectable;)t=t.traversePreviousTreeElement(!this.expandTreeElementsWhenArrowing);n=t?!0:!1}t&&(t.reveal(),t.select(!1,!0)),n&&e.consume(!0)}},TreeOutline.prototype.expand=function(){},TreeOutline.prototype.collapse=function(){},TreeOutline.prototype.revealed=function(){return!0},TreeOutline.prototype.reveal=function(){},TreeOutline.prototype.select=function(){},TreeOutline.prototype.revealAndSelect=function(){},TreeOutline.prototype._startSearch=function(e){function t(){this.searchInputElement.focus()}this.searchInputElement&&this.searchable&&(this._searching=!0,this.searchStarted&&this.searchStarted(),this.searchInputElement.value=e,window.setTimeout(t.bind(this),0),this._searchTextChanged(),this._boundSearchTextChanged=this._searchTextChanged.bind(this),this.searchInputElement.addEventListener("paste",this._boundSearchTextChanged),this.searchInputElement.addEventListener("cut",this._boundSearchTextChanged),this.searchInputElement.addEventListener("keypress",this._boundSearchTextChanged),this._boundSearchInputKeyDown=this._searchInputKeyDown.bind(this),this.searchInputElement.addEventListener("keydown",this._boundSearchInputKeyDown),this._boundSearchInputBlur=this._searchInputBlur.bind(this),this.searchInputElement.addEventListener("blur",this._boundSearchInputBlur))},TreeOutline.prototype._searchTextChanged=function(){function e(){var e=this._nextSearchMatch(this.searchInputElement.value,this.selectedTreeElement,!1);e||(e=this._nextSearchMatch(this.searchInputElement.value,this.children[0],!1)),this._showSearchMatchElement(e)}window.setTimeout(e.bind(this),0)},TreeOutline.prototype._showSearchMatchElement=function(e){this._currentSearchMatchElement=e,e?(this._childrenListNode.classList.add("search-match-found"),this._childrenListNode.classList.remove("search-match-not-found"),e.revealAndSelect(!0)):(this._childrenListNode.classList.remove("search-match-found"),this._childrenListNode.classList.add("search-match-not-found"))},TreeOutline.prototype._searchInputKeyDown=function(e){if(!(e.shiftKey||e.metaKey||e.ctrlKey||e.altKey)){var t,n=!1;if("Down"===e.keyIdentifier)t=this._nextSearchMatch(this.searchInputElement.value,this.selectedTreeElement,!0),n=!0;else if("Up"===e.keyIdentifier)t=this._previousSearchMatch(this.searchInputElement.value,this.selectedTreeElement),n=!0;else if(27===e.keyCode)this._searchFinished(),n=!0;else if(isEnterKey(e)){var s=this._currentSearchMatchElement;this._searchFinished(),s.onenter(),n=!0}t&&this._showSearchMatchElement(t),n?e.consume(!0):window.setTimeout(this._boundSearchTextChanged,0)}},TreeOutline.prototype._nextSearchMatch=function(e,t,n){for(var s=t,i=n;s&&(i||!s.matchesSearchText||!s.matchesSearchText(e));)s=s.traverseNextTreeElement(!0,null,!0),i=!1;return s},TreeOutline.prototype._previousSearchMatch=function(e,t){for(var n=t,s=!0;n&&(s||!n.matchesSearchText||!n.matchesSearchText(e));)n=n.traversePreviousTreeElement(!0,!0),s=!1;return n},TreeOutline.prototype._searchInputBlur=function(){this._searchFinished()},TreeOutline.prototype._searchFinished=function(){this._searching&&(delete this._searching,this._childrenListNode.classList.remove("search-match-found"),this._childrenListNode.classList.remove("search-match-not-found"),delete this._currentSearchMatchElement,this.searchInputElement.value="",this.searchInputElement.removeEventListener("paste",this._boundSearchTextChanged),this.searchInputElement.removeEventListener("cut",this._boundSearchTextChanged),delete this._boundSearchTextChanged,this.searchInputElement.removeEventListener("keydown",this._boundSearchInputKeyDown),delete this._boundSearchInputKeyDown,this.searchInputElement.removeEventListener("blur",this._boundSearchInputBlur),delete this._boundSearchInputBlur,this.searchFinished&&this.searchFinished(),this.treeOutline._childrenListNode.focus())},TreeOutline.prototype.stopSearch=function(){this._searchFinished()},TreeElement.prototype={arrowToggleWidth:10,get selectable(){return this._hidden?!1:this._selectable},set selectable(e){this._selectable=e},get listItemElement(){return this._listItemNode},get childrenListElement(){return this._childrenListNode},get title(){return this._title},set title(e){this._title=e,this._setListItemNodeContent()},get tooltip(){return this._tooltip},set tooltip(e){this._tooltip=e,this._listItemNode&&(this._listItemNode.title=e?e:"")},get hasChildren(){return this._hasChildren},set hasChildren(e){this._hasChildren!==e&&(this._hasChildren=e,this._listItemNode&&(e?this._listItemNode.classList.add("parent"):(this._listItemNode.classList.remove("parent"),this.collapse())))},get hidden(){return this._hidden},set hidden(e){this._hidden!==e&&(this._hidden=e,e?(this._listItemNode&&this._listItemNode.classList.add("hidden"),this._childrenListNode&&this._childrenListNode.classList.add("hidden")):(this._listItemNode&&this._listItemNode.classList.remove("hidden"),this._childrenListNode&&this._childrenListNode.classList.remove("hidden")))},get shouldRefreshChildren(){return this._shouldRefreshChildren},set shouldRefreshChildren(e){this._shouldRefreshChildren=e,e&&this.expanded&&this.expand()},_setListItemNodeContent:function(){this._listItemNode&&("string"==typeof this._title?this._listItemNode.textContent=this._title:(this._listItemNode.removeChildren(),this._title&&this._listItemNode.appendChild(this._title)))
}},TreeElement.prototype.appendChild=TreeOutline.prototype.appendChild,TreeElement.prototype.insertChild=TreeOutline.prototype.insertChild,TreeElement.prototype.removeChild=TreeOutline.prototype.removeChild,TreeElement.prototype.removeChildAtIndex=TreeOutline.prototype.removeChildAtIndex,TreeElement.prototype.removeChildren=TreeOutline.prototype.removeChildren,TreeElement.prototype._attach=function(){(!this._listItemNode||this.parent._shouldRefreshChildren)&&(this._listItemNode&&this._listItemNode.parentNode&&this._listItemNode.parentNode.removeChild(this._listItemNode),this._listItemNode=this.treeOutline._childrenListNode.ownerDocument.createElement("li"),this._listItemNode.treeElement=this,this._setListItemNodeContent(),this._listItemNode.title=this._tooltip?this._tooltip:"",this.hidden&&this._listItemNode.classList.add("hidden"),this.hasChildren&&this._listItemNode.classList.add("parent"),this.expanded&&this._listItemNode.classList.add("expanded"),this.selected&&this._listItemNode.classList.add("selected"),this._listItemNode.addEventListener("mousedown",TreeElement.treeElementMouseDown,!1),this._listItemNode.addEventListener("click",TreeElement.treeElementToggled,!1),this._listItemNode.addEventListener("dblclick",TreeElement.treeElementDoubleClicked,!1),this.onattach());var e=null;this.nextSibling&&this.nextSibling._listItemNode&&this.nextSibling._listItemNode.parentNode===this.parent._childrenListNode&&(e=this.nextSibling._listItemNode),this.parent._childrenListNode.insertBefore(this._listItemNode,e),this._childrenListNode&&this.parent._childrenListNode.insertBefore(this._childrenListNode,this._listItemNode.nextSibling),this.selected&&this.select(),this.expanded&&this.expand()},TreeElement.prototype._detach=function(){this._listItemNode&&this._listItemNode.parentNode&&this._listItemNode.parentNode.removeChild(this._listItemNode),this._childrenListNode&&this._childrenListNode.parentNode&&this._childrenListNode.parentNode.removeChild(this._childrenListNode)},TreeElement.treeElementMouseDown=function(e){var t=e.currentTarget;t&&t.treeElement&&t.treeElement.selectable&&(t.treeElement.isEventWithinDisclosureTriangle(e)||t.treeElement.selectOnMouseDown(e))},TreeElement.treeElementToggled=function(e){var t=e.currentTarget;if(t&&t.treeElement){var n=t.treeElement.toggleOnClick&&!t.treeElement.selectable,s=t.treeElement.isEventWithinDisclosureTriangle(e);(n||s)&&(t.treeElement.expanded?e.altKey?t.treeElement.collapseRecursively():t.treeElement.collapse():e.altKey?t.treeElement.expandRecursively():t.treeElement.expand(),e.consume())}},TreeElement.treeElementDoubleClicked=function(e){var t=e.currentTarget;if(t&&t.treeElement){var n=t.treeElement.ondblclick.call(t.treeElement,e);n||t.treeElement.hasChildren&&!t.treeElement.expanded&&t.treeElement.expand()}},TreeElement.prototype.collapse=function(){this._listItemNode&&this._listItemNode.classList.remove("expanded"),this._childrenListNode&&this._childrenListNode.classList.remove("expanded"),this.expanded=!1,this.treeOutline&&this.treeOutline._expandedStateMap.put(this.representedObject,!1),this.oncollapse()},TreeElement.prototype.collapseRecursively=function(){for(var e=this;e;)e.expanded&&e.collapse(),e=e.traverseNextTreeElement(!1,this,!0)},TreeElement.prototype.expand=function(){if(this.hasChildren&&(!this.expanded||this._shouldRefreshChildren||!this._childrenListNode)){if(this.expanded=!0,this.treeOutline&&this.treeOutline._expandedStateMap.put(this.representedObject,!0),this.treeOutline&&(!this._childrenListNode||this._shouldRefreshChildren)){this._childrenListNode&&this._childrenListNode.parentNode&&this._childrenListNode.parentNode.removeChild(this._childrenListNode),this._childrenListNode=this.treeOutline._childrenListNode.ownerDocument.createElement("ol"),this._childrenListNode.parentTreeElement=this,this._childrenListNode.classList.add("children"),this.hidden&&this._childrenListNode.classList.add("hidden"),this.onpopulate();for(var e=0;e<this.children.length;++e)this.children[e]._attach();delete this._shouldRefreshChildren}this._listItemNode&&(this._listItemNode.classList.add("expanded"),this._childrenListNode&&this._childrenListNode.parentNode!=this._listItemNode.parentNode&&this.parent._childrenListNode.insertBefore(this._childrenListNode,this._listItemNode.nextSibling)),this._childrenListNode&&this._childrenListNode.classList.add("expanded"),this.onexpand()}},TreeElement.prototype.expandRecursively=function(e){var t=this,n={},s=0;for(isNaN(e)&&(e=3);t;)e>s&&t.expand(),t=t.traverseNextTreeElement(!1,this,s>=e,n),s+=n.depthChange},TreeElement.prototype.hasAncestor=function(e){if(!e)return!1;for(var t=this.parent;t;){if(e===t)return!0;t=t.parent}return!1},TreeElement.prototype.reveal=function(){for(var e=this.parent;e&&!e.root;)e.expanded||e.expand(),e=e.parent;this.onreveal(this)},TreeElement.prototype.revealed=function(){for(var e=this.parent;e&&!e.root;){if(!e.expanded)return!1;e=e.parent}return!0},TreeElement.prototype.selectOnMouseDown=function(e){this.select(!1,!0)&&e.consume(!0)},TreeElement.prototype.select=function(e,t){return this.treeOutline&&this.selectable&&!this.selected?(this.treeOutline.selectedTreeElement&&this.treeOutline.selectedTreeElement.deselect(),this.selected=!0,e||this.treeOutline._childrenListNode.focus(),this.treeOutline?(this.treeOutline.selectedTreeElement=this,this._listItemNode&&this._listItemNode.classList.add("selected"),this.onselect(t)):!1):!1},TreeElement.prototype.revealAndSelect=function(e){this.reveal(),this.select(e)},TreeElement.prototype.deselect=function(){return this.treeOutline&&this.treeOutline.selectedTreeElement===this&&this.selected?(this.selected=!1,this.treeOutline.selectedTreeElement=null,this._listItemNode&&this._listItemNode.classList.remove("selected"),!0):!1},TreeElement.prototype.onpopulate=function(){},TreeElement.prototype.onenter=function(){},TreeElement.prototype.ondelete=function(){},TreeElement.prototype.onspace=function(){},TreeElement.prototype.onattach=function(){},TreeElement.prototype.onexpand=function(){},TreeElement.prototype.oncollapse=function(){},TreeElement.prototype.ondblclick=function(){},TreeElement.prototype.onreveal=function(){},TreeElement.prototype.onselect=function(){},TreeElement.prototype.traverseNextTreeElement=function(e,t,n,s){!n&&this.hasChildren&&this.onpopulate(),s&&(s.depthChange=0);var i=e?this.revealed()?this.children[0]:null:this.children[0];if(i&&(!e||e&&this.expanded))return s&&(s.depthChange=1),i;if(this===t)return null;if(i=e?this.revealed()?this.nextSibling:null:this.nextSibling)return i;for(i=this;i&&!i.root&&!(e?i.revealed()?i.nextSibling:null:i.nextSibling)&&i.parent!==t;)s&&(s.depthChange-=1),i=i.parent;return i?e?i.revealed()?i.nextSibling:null:i.nextSibling:null},TreeElement.prototype.traversePreviousTreeElement=function(e,t){var n=e?this.revealed()?this.previousSibling:null:this.previousSibling;for(!t&&n&&n.hasChildren&&n.onpopulate();n&&(e?n.revealed()&&n.expanded?n.children[n.children.length-1]:null:n.children[n.children.length-1]);)!t&&n.hasChildren&&n.onpopulate(),n=e?n.revealed()&&n.expanded?n.children[n.children.length-1]:null:n.children[n.children.length-1];return n?n:!this.parent||this.parent.root?null:this.parent},TreeElement.prototype.isEventWithinDisclosureTriangle=function(e){var t=window.getComputedStyle(this._listItemNode).getPropertyCSSValue("padding-left"),n=t?t.getFloatValue(CSSPrimitiveValue.CSS_PX):0,s=this._listItemNode.totalOffsetLeft()+n;return e.pageX>=s&&e.pageX<=s+this.arrowToggleWidth&&this.hasChildren};var WebInspector={platform:function(){if(!WebInspector._platform){var e=navigator.userAgent.match(/Windows NT/);e?WebInspector._platform="windows":(e=navigator.userAgent.match(/Mac OS X/),WebInspector._platform=e?"mac":"linux")}return WebInspector._platform},PlatformFlavor:{WindowsVista:"windows-vista",MacTiger:"mac-tiger",MacLeopard:"mac-leopard",MacSnowLeopard:"mac-snowleopard",MacLion:"mac-lion",MacMountainLion:"mac-mountain-lion"},detectFlavor:function(){var e=navigator.userAgent;if("windows"===WebInspector.platform()){var t=e.match(/Windows NT (\d+)\.(?:\d+)/);return t&&t[1]>=6?this.PlatformFlavor.WindowsVista:null}if("mac"===WebInspector.platform()){var t=e.match(/Mac OS X\s*(?:(\d+)_(\d+))?/);if(!t||10!==t[1])return WebInspector.PlatformFlavor.MacSnowLeopard;switch(Number(t[2])){case 4:return WebInspector.PlatformFlavor.MacTiger;case 5:return WebInspector.PlatformFlavor.MacLeopard;case 6:return WebInspector.PlatformFlavor.MacSnowLeopard;case 7:return WebInspector.PlatformFlavor.MacLion;case 8:return WebInspector.PlatformFlavor.MacMountainLion;default:return""}}},port:function(){return WebInspector._port||(WebInspector._port="unknown"),WebInspector._port},isMac:function(){return"undefined"==typeof WebInspector._isMac&&(WebInspector._isMac="mac"===WebInspector.platform()),WebInspector._isMac},isWin:function(){return"undefined"==typeof WebInspector._isWin&&(WebInspector._isWin="windows"===WebInspector.platform()),WebInspector._isWin},installPortStyles:function(){var e=WebInspector.platform();document.body.addStyleClass("platform-"+e);var t=WebInspector.platformFlavor();t&&document.body.addStyleClass("platform-"+t);var n=WebInspector.port();document.body.addStyleClass("port-"+n)},_elementDragStart:function(e,t,n,s,i){if(!(i.button||WebInspector.isMac()&&i.ctrlKey||WebInspector._elementDraggingEventListener||e&&!e(i))){WebInspector._elementDraggingGlassPane&&(WebInspector._elementDraggingGlassPane.dispose(),delete WebInspector._elementDraggingGlassPane);var r=i.target.ownerDocument;WebInspector._elementDraggingEventListener=t,WebInspector._elementEndDraggingEventListener=n,WebInspector._mouseOutWhileDraggingTargetDocument=r,r.addEventListener("mousemove",WebInspector._elementDragMove,!0),r.addEventListener("mouseup",WebInspector._elementDragEnd,!0),r.addEventListener("mouseout",WebInspector._mouseOutWhileDragging,!0),r.body.style.cursor=s,i.preventDefault()}},_mouseOutWhileDragging:function(){WebInspector._unregisterMouseOutWhileDragging(),WebInspector._elementDraggingGlassPane=new WebInspector.GlassPane},_unregisterMouseOutWhileDragging:function(){WebInspector._mouseOutWhileDraggingTargetDocument&&(WebInspector._mouseOutWhileDraggingTargetDocument.removeEventListener("mouseout",WebInspector._mouseOutWhileDragging,!0),delete WebInspector._mouseOutWhileDraggingTargetDocument)},_elementDragMove:function(e){WebInspector._elementDraggingEventListener(e)&&WebInspector._cancelDragEvents(e)},_cancelDragEvents:function(e){var t=e.target.ownerDocument;t.removeEventListener("mousemove",WebInspector._elementDragMove,!0),t.removeEventListener("mouseup",WebInspector._elementDragEnd,!0),WebInspector._unregisterMouseOutWhileDragging(),t.body.style.removeProperty("cursor"),WebInspector._elementDraggingGlassPane&&WebInspector._elementDraggingGlassPane.dispose(),delete WebInspector._elementDraggingGlassPane,delete WebInspector._elementDraggingEventListener,delete WebInspector._elementEndDraggingEventListener},_elementDragEnd:function(e){var t=WebInspector._elementEndDraggingEventListener;WebInspector._cancelDragEvents(e),e.preventDefault(),t&&t(e)}};WebInspector.GlassPane=function(){if(WebInspector._glassPane){var e=WebInspector._glassPane.element;return e.parentElement&&e.parentElement===document.body||document.body.appendChild(e),WebInspector._glassPane}this.element=document.createElement("div"),this.element.style.cssText="position:absolute;top:0;bottom:0;left:0;right:0;background-color:transparent;z-index:1000;",this.element.id="glass-pane-for-drag",document.body.appendChild(this.element),WebInspector._glassPane=this},WebInspector.GlassPane.prototype={dispose:function(){delete WebInspector._glassPane,this.element.parentElement&&this.element.parentElement.removeChild(this.element)}},WebInspector.View=function(e){this.element=e||document.createElement("div"),this.element.__view=this,this._visible=!0,this._isRoot=!1,this._isShowing=!1,this._children=[],this._hideOnDetach=!0,this._notificationDepth=0},WebInspector.View.prototype={doResize:function(){this.onResize()},show:function(e,t){if(this.element.parentElement!==e)this.element.parentElement&&this.detach();else if(this._visible)return;this._visible=!0,this.element.addStyleClass("visible"),this.element.parentElement!==e&&(t?e.insertBefore(this.element,t):e.appendChild(this.element))},detach:function(e){var t=this.element.parentElement;if(t)return this._hideOnDetach&&!e?(this.element.removeStyleClass("visible"),this._visible=!1,void 0):(this._visible=!1,void 0)}},WaspUI={},WaspUI.BYPASS_TYPE_HIDE="hide",WaspUI.BYPASS_TYPE_BLOCK="block",WaspUI.BYPASS_TYPE_OVERRIDE="override",WaspUI.BYPASS_TAB_TRACKED="0tracked",WaspUI.BYPASS_TAB_ALL="0all",WaspUI.BYPASS_DURATION_NEVER=0,WaspUI.BYPASS_DURATION_WINDOW=1,WaspUI.BYPASS_DURATION_SESSION=2,WaspUI.BYPASS_DURATION_ALWAYS=4,WaspUI.BYPASS_SCOPE_PAGE=1,WaspUI.BYPASS_SCOPE_DOMAIN=2,WaspUI.BYPASS_SCOPE_ALL=4,WaspUI.BYPASS_OVERRIDE_FILE="file",WaspUI.BYPASS_OVERRIDE_URL="url",WaspUI.FATAL_ERROR=!1,WaspUI.cql=new CSSql,WaspUI.chron=new Chron;try{WaspUI.displayType=localStorage.userType||"Implementer",WaspUI.settings=new function(){this.get=function(e,t){if(void 0===e)return t;var n=window.localStorage.getItem("WaspUI."+e);return void 0!==t&&null===n?(this.set(e,t),t):n},this.set=function(e,t){void 0!==e&&window.localStorage.setItem("WaspUI."+e,t)},this.has=function(e){return!(null===window.localStorage.getItem("WaspUI."+e))},this.remove=function(e){window.localStorage.removeItemItem("WaspUI"+e)}},WaspUI.cql.load("bypass"),WaspUI.cql.append("bypass",CSSql.SCOPE_LOCAL,"session"),WaspUI.cql.append("bypass",CSSql.SCOPE_LOCAL,"always")}catch(e){if("SecurityError"!=e.name)throw e;WaspUI.FATAL_ERROR={title:"Error: 3rd party cookies and local storage are disabled and preventing WASP from working.",fix:"http://support.webanalyticssolutionprofiler.com/knowledgebase/articles/321072-wasp-chrome-3rd-party-tags-blocking-known-issue",details:e}}WaspUI.addBypass=function(e,t,n,s,i,r,a,o,l){var c={type:e,url:t.split(/#|\?/)[0],tab:a||WaspUI.BYPASS_TAB_TRACKED,isDomain:n,duration:s,scope:i,scopeUrl:r.split(/#|\?/)[0],override:o||"",overrideUrl:(l||"").split(/#|\?/)[0]};if(WaspUI.cql.insert("bypass",c),s===WaspUI.BYPASS_DURATION_SESSION?WaspUI.cql.save("bypass",CSSql.SCOPE_LOCAL,"duration="+WaspUI.BYPASS_DURATION_SESSION,"session"):s===WaspUI.BYPASS_DURATION_ALWAYS&&WaspUI.cql.save("bypass",CSSql.SCOPE_LOCAL,"duration="+WaspUI.BYPASS_DURATION_ALWAYS,"always"),e!==WaspUI.BYPASS_TYPE_HIDE){var d={"msg-type":"bypass",bypassData:[c],action:"append"};WaspUI.messages.port.postMessage(d)}},WaspUI.clearBypass=function(e,t,n,s,i){var r="type="+e+',url="'+t+'"';r+=n===WaspUI.BYPASS_SCOPE_ALL?",scope="+n:',scopeUrl="'+n+'"',e===WaspUI.BYPASS_TYPE_OVERRIDE&&(r+=',overrideUrl="'+i+'"'),WaspUI.cql.delete("bypass",r)},WaspUI.getBypasses=function(e,t,n,s,i){var r="";e&&(r="type="+e),t&&(r+=r.length?",":"",r+='url="'+t.split(/#|\?/)[0]+'"'),n&&(r+=r.length?",":"",r+="scope="+n),s&&(r+=r.length?",":"",r+='scopeUrl="'+s.split(/#|\?/)[0]+'"'),i&&(r+=r.length?",":"",r+='overrideUrl="'+i.split(/#|\?/)[0]+'"');var a=WaspUI.cql.select("bypass",r);return a},WaspUI.saveBypasses=function(e){e!==WaspUI.BYPASS_DURATION_ALWAYS&&WaspUI.cql.save("bypass",CSSql.SCOPE_LOCAL,"duration="+WaspUI.BYPASS_DURATION_SESSION,"session"),e!==WaspUI.BYPASS_DURATION_SESSION&&WaspUI.cql.save("bypass",CSSql.SCOPE_LOCAL,"duration="+WaspUI.BYPASS_DURATION_ALWAYS,"always");var t={"msg-type":"bypass",bypassData:WaspUI.cql.select("bypass","type=block||type=override"),action:"override"};WaspUI.messages.port.postMessage(t)},WaspUI.connections=function(){return WaspUI.cql.load("connection"),{}}(),WaspUI.connections.panels=[],WaspUI.connections.findUrl=function(e,t){t||(t=WaspUI.mainPanel.currentContent);var n=t.handle;return WaspUI.cql.select("connection",'from="'+e+'",panel='+n+'||to="'+e+'",panel='+n)},WaspUI.connections.clearPanelConnections=function(e){var t=WaspUI.connections.panels.indexOf(e.handle);return-1!==t&&(WaspUI.scriptinfo.clearPanel(e),WaspUI.cql.delete("connection","panel="+t),WaspUI.connections.panels.splice(t,1),e.onRemove=null),e},WaspUI.connections.add=function(e,t,n){n||(n=WaspUI.mainPanel.currentContent),-1===this.panels.indexOf(n.handle)&&(this.panels.push(n.handle),n.onRemove=WaspUI.connections.clearPanelConnections),e=String(e).split("#")[0],t=String(t).split("#")[0];var s='from="'+e+'",to="'+t+'",panel='+n.handle,i=(WaspUI.cql.select("connection",s)||[!1])[0];return i?(i.count++,WaspUI.cql.update("connection","count="+i.count,s)):(i=new WaspUI.connectionItem(e,t,n),WaspUI.cql.insert("connection",i)),i},WaspUI.connectionItem=function(e,t,n){n||(n=WaspUI.mainPanel.currentContent),this.from=e,this.to=t,this.panel=n.handle,this.count=1,this.connected=!1},WaspUI.findConnections=function(e,t){return WaspUI.connections.findUrl(e,t)},WaspUI.scriptinfo=function(){return WaspUI.cql.load("scriptinfo"),{}}(),WaspUI.scriptinfo.get=function(e,t){e=e.split("#")[0],t||(t=WaspUI.mainPanel.currentContent);var n='src="'+e+'",panel="'+t.handle+'"';return WaspUI.cql.select("scriptinfo",n)[0]},WaspUI.scriptinfo.set=function(e,t,n,s,i){if(t){i||(i=WaspUI.mainPanel.currentContent);var r='src="'+t+'",panel="'+i.handle+'"';WaspUI.cql.count("scriptinfo",r)?e&&WaspUI.cql.update("scriptinfo",{src:t,panel:i.handle,location:n,async:s},r):WaspUI.cql.insert("scriptinfo",{src:t,panel:i.handle,location:n,async:s})}},WaspUI.scriptinfo.clearPanel=function(e){e||(e=WaspUI.mainPanel.currentContent),WaspUI.cql.delete("scriptinfo","panel="+e.handle)},WaspUI.findNodeFromUrl=function(e,t,n){return t||(t=WaspUI.mainPanel.currentContent),n?t.element.querySelector('li[data-url=^"'+e+'"]'):t.element.querySelector('li[data-url="'+e+'"]')},WaspUI.findNodelistFromUrl=function(e,t,n){return t||(t=WaspUI.mainPanel.currentContent),n?t.element.querySelectorAll('li[data-url^="'+e+'"]'):t.element.querySelectorAll('li[data-url="'+e+'"]')},WaspUI.findDomainNodes=function(e,t){return t||(t=WaspUI.mainPanel.currentContent),t.element.querySelectorAll('li.domain[data-domain="'+e+'"]')},WaspUI.viewController=void 0,WaspUI.sidebarPanel=void 0,WaspUI.mainPanel=void 0,WaspUI.devtoolsExtension=void 0,WaspUI.messages=new MessageDeligate,WaspUI.initiatePanel=function(e){WaspUI.devtoolsExtension=e,e.onSearch.addListener(WaspUI.doSearchAction),WaspUI.currentTab=chrome.devtools.inspectedWindow.tabId;var t=WaspUI.viewController=new WaspUI.SplitView(!0),n=WaspUI.sidebarPanel=t.sidebarElement,s=n.toolbar;s.detailsButton=t.createButtonAndRegisterShortcuts("sidebar-view-details","View Details",WaspUI.displayNodeDetails.bind(s),""),s.detailsButton.toggled=1,s.appendChild(s.detailsButton.element),s.contentButton=t.createButtonAndRegisterShortcuts("sidebar-view-content","View Content",WaspUI.displayNodeContent.bind(s),""),s.contentButton.toggled=0,s.appendChild(s.contentButton.element),s.settingsButton=t.createButtonAndRegisterShortcuts("sidebar-view-settings","Settings",WaspUI.diplaySettingsMenu.bind(s),""),s.appendChild(s.settingsButton.element),WaspUI.mainPanel=t.mainElement,WaspUI.messages.addListener("initiator",function(e){var t=WaspUI.connections.add(e["initiator-from"],e["initiator-to"]),n=WaspUI.findNodeFromUrl(t.to),s=WaspUI.findNodeFromUrl(t.from);n&&s&&(s.addCalls(n.id),n.addCalledBy(s.id),t.connected=!0)}),WaspUI.messages.addListener("connection",function(e){e["new-session"]===!0&&(WaspUI.cql.delete("bypass","duration="+WaspUI.BYPASS_DURATION_SESSION),WaspUI.saveBypasses(WaspUI.BYPASS_DURATION_SESSION))}),WaspUI.messages.addListener("set-friendly",function(e){for(var t=e["set-friendly"],n=t.length;n--;)WaspUI.friendly.setGroup(t[n])}),WaspUI.messages.port=chrome.runtime.connect({name:"WASP.devtool-"+WaspUI.currentTab}),WaspUI.messages.port.onMessage.addListener(function(e){e["msg-type"]?WaspUI.messages.fireListener(e["msg-type"],e):console.log("unexpected message",e)}),WaspUI.messages.port.postMessage({"msg-type":"get-friendly","get-friendly":!0,response:function(e){WaspUI.friendly=e}})},WaspUI.doSearchAction=function(e,t){switch(WaspUI.doSearchAction.styles||(WaspUI.doSearchAction.styles=new Stylomatic),e){case WaspUI.doSearchAction.actions.PerformSearch:var n,s=t,i="name",r="",a="";return s.length&&(n=document.querySelectorAll("li[data-"+i+'*="'+s+'"] > span')).length?(n[0].scrollIntoView(),r="li[data-"+i+"]:not([data-"+i+'*="'+s+'"]):not(.connected):not(.selected):not(:hover) > span { width:36px !important;}',a="li[data-"+i+'*="'+s+'"] > span { background-color:lightgreen !important; }',console.info("found ",r,a),WaspUI.doSearchAction.styles.replace("find",a),WaspUI.doSearchAction.styles.replace("filter",r)):(WaspUI.doSearchAction.styles.remove("find"),WaspUI.doSearchAction.styles.remove("filter")),WaspUI.doSearchAction.results=n,WaspUI.doSearchAction.resultPosition=-1,el.length;case WaspUI.doSearchAction.actions.NextSearchResult:var n=WaspUI.doSearchAction.results;n&&n.length&&(WaspUI.doSearchAction.resultPosition++,WaspUI.doSearchAction.resultPosition>=n.length&&(WaspUI.doSearchAction.resultPosition=0),n[WaspUI.doSearchAction.resultPosition].scrollIntoView(),n[WaspUI.doSearchAction.resultPosition].click());break;case WaspUI.doSearchAction.actions.PreviousSearchResult:var n=WaspUI.doSearchAction.results;n&&n.length&&(WaspUI.doSearchAction.resultPosition--,WaspUI.doSearchAction.resultPosition<0&&(WaspUI.doSearchAction.resultPosition=n.length-1),n[WaspUI.doSearchAction.resultPosition].scrollIntoView(),n[WaspUI.doSearchAction.resultPosition].click());break;case WaspUI.doSearchAction.actions.CancelSearch:WaspUI.doSearchAction.styles.remove("find"),WaspUI.doSearchAction.styles.remove("filter");break;default:console.log("unknown search action",e,t)}},WaspUI.doSearchAction.styles=null,WaspUI.doSearchAction.results=null,WaspUI.doSearchAction.resultPosition=-1,WaspUI.doSearchAction.actions=chrome.devtools.panels.SearchAction,WaspUI.displayNodeDetails=function(){WaspUI.sidebarPanel.detailStack.element.classList.remove("hidden"),this.detailsButton.toggled=1,WaspUI.sidebarPanel.contentStack.element.classList.add("hidden"),this.contentButton.toggled=0},WaspUI.displayNodeContent=function(){WaspUI.sidebarPanel.detailStack.element.classList.add("hidden"),this.detailsButton.toggled=0,WaspUI.sidebarPanel.contentStack.element.classList.remove("hidden"),this.contentButton.toggled=1},WaspUI.diplaySettingsMenu=function(e){function t(){new WaspUI.BypassNodeDialog(this,WaspUI.BYPASS_TYPE_HIDE,this.dataset.url,!1)}function n(){new WaspUI.BypassNodeDialog(this,WaspUI.BYPASS_TYPE_HIDE,this.dataset.domain,!0)}function s(){new WaspUI.BypassNodeDialog(this,WaspUI.BYPASS_TYPE_BLOCK,this.dataset.url,!1)}function i(){new WaspUI.BypassNodeDialog(this,WaspUI.BYPASS_TYPE_OVERRIDE,this.dataset.url,!1)}function r(){new WaspUI.ManageBypassesDialog}function a(){WaspUI.messages.port.postMessage({"msg-type":"open-tab",uri:"/options.html"})}function o(){WaspUI.messages.port.postMessage({"msg-type":"open-tab",uri:"http://support.webanalyticssolutionprofiler.com?utm_source=plugin&utm_medium=chrome&utm_campaign=wasp"})}function l(){WaspUI.messages.port.postMessage({"msg-type":"open-tab",uri:"about.html"})}function c(){chrome.runtime.sendMessage("fdogdfpioiggoomoobmfkgckbkheckik",{name:"launch"},function(e){e||WaspUI.messages.port.postMessage({"msg-type":"open-tab",uri:"http://webanalyticssolutionprofiler.com/chrome/crawler/"})})}var d,h=new WebInspector.ContextMenu(e);if(h.appendItem("WASP Options",a),h.appendItem("WASP Support",o),h.appendItem("About WASP",l),h.appendItem("Launch Crawler",c),h.appendSeparator(),WaspUI.events&&WaspUI.events.selectedNode&&(d=WaspUI.events.selectedNode,WaspUI.mainPanel&&WaspUI.mainPanel.currentContent&&WaspUI.mainPanel.currentContent.pageNode&&WaspUI.mainPanel.currentContent.pageNode!==d)){var p=0==d.id.indexOf("tags")?"tag":"script";h.appendItem("Hide this "+p,t.bind(d)),-1!==d.id.indexOf("blocked")||d.classList.contains("blocked")||d.classList.contains("override")||(h.appendItem("Block this "+p,s.bind(d)),"script"==p&&h.appendItem("Override this script",i.bind(d))),"script"==p&&h.appendItem("Override this script",i.bind(d)),h.appendSeparator(),h.appendItem("Hide this domain",n.bind(d))}h.appendItem("Manage bypasses",r),h.show()},WaspUI.addTreeNodeController=function(e){var t=e.querySelector("span");e.removeChild(t);var n=document.createElement("input");n.type="checkbox",n.id="ux-node-"+e.id,n.setAttribute("checked","checked");var s=document.createElement("label");s.style.cssText=t.style.cssText,t.style.cssText="",s.setAttribute("for",n.id),s.appendChild(t),e.appendChild(n),e.appendChild(s),Object.defineProperties(n,{check:{enumerable:!0,value:function(e,t){if(!this.checked){if(this.checked=!0,e)for(var n=this.parentElement.querySelectorAll("ul input[type=checkbox][id^=ux-node-]"),s=n.length;s--;){var i=n[s];i.checked=!0}if(!t){var r=document.createEvent("Event");r.initEvent("change",!0,!1),this.dispatchEvent(r)}}}},uncheck:{enumerable:!0,value:function(e,t){if(this.checked){if(this.checked=!1,e)for(var n=this.parentElement.querySelectorAll("ul input[type=checkbox][id^=ux-node-]"),s=n.length;s--;){var i=n[s];i.checked=!1}if(!t){var r=document.createEvent("Event");r.initEvent("change",!0,!1),this.dispatchEvent(r)}}}},toggle:{enumerable:!0,value:function(e,t){var n=this.checked=!this.checked;if(e)for(var s=this.parentElement.querySelectorAll("ul input[type=checkbox][id^=ux-node-]"),i=s.length;i--;){var r=s[i];r.checked=n}if(!t){var a=document.createEvent("Event");a.initEvent("change",!0,!1),this.dispatchEvent(a)}}}}),n.addEventListener("change",function(){WaspUI.chron.doUntil(WaspUI.sizeConnectors,!1)})},WaspUI.addTreeNode=function(e,t,n,s,i){for(var r=document.createElement("li"),a=e;!a.classList.contains("tree")&&"li"!==a.tagName.toLowerCase();a=a.parentNode);r.id=a.id.length?a.id+"-"+t:t;var o=document.createElement("span");if(o.innerHTML=n,r.appendChild(o),i&&i.parentNode===e)e.insertBefore(r,i);else if(!s&&e.children.length){var l=insertionIndexForObjectInListSortedByFunction(r,e.children,function(e,t){return e.innerText<t.innerText?-1:e.innerText>t.innerText?1:0});l<e.children.length?e.insertBefore(r,e.children[l]):e.appendChild(r)}else e.appendChild(r);var c=e.label.dataset;return c.childcount=c.childcount?Number(c.childcount)+1:1,r.branchParent=null,Object.defineProperties(r,{rootNode:{enumerable:!0,get:function(){for(var e=this.parentNode;!e.classList.contains("tree");e=e.parentNode);return e}},controller:{enumerable:!0,get:function(){for(var e=null,t=this.parentNode;!t.classList.contains("tree");t=t.parentNode)if("li"===t.tagName.toLowerCase()){e=t.querySelector("input[type=checkbox][id^=ux-node-]");break}return e}},visible:{enumerable:!0,get:function(){var e=this.controller,t=e?e.checked:!0;if(t)for(var n=this.parentNode;!n.classList.contains("tree");n=n.parentNode)if("li"===n.tagName.toLowerCase()){t=n.visible;break}return t}},show:{enumerable:!0,value:function(){var e=this.controller;e&&e.check();for(var t=this.parentNode;!t.classList.contains("tree");t=t.parentNode)if("li"===t.tagName.toLowerCase()){v=t.show();break}}},addBranch:{enumerable:!0,value:function(e,t,n){this.branchElement||(WaspUI.addTreeNodeController(this),this.branchElement=document.createElement("ul"),this.branchElement.label=this.querySelector("label"),this.branchElement.label.dataset.childcount=0,this.branches={},this.branchIds=[],this.appendChild(this.branchElement));for(var s=e,i=1;this.branches[s];)s=e+"-"+i++;var r=WaspUI.addTreeNode(this.branchElement,s,t,!!n);return r.branchParent=this,this.branches[s]=r,this.branchIds.push(s),r}},showConnections:{enumerable:!0,value:function(e){if(e)for(var t=document.querySelectorAll(".connect"),n=t.length;n--;){var s=t[n];document.querySelector("#"+s.dataset.to).classList.remove("connected"),document.querySelector("#"+s.dataset.from).classList.remove("connected"),s.parentElement.removeChild(s)}for(var i=this.dataset.url,r=WaspUI.findConnections(i)||[],n=-1,a=r.length;++n<a;){var o,l=r[n];l.from==i?(o=WaspUI.findNodeFromUrl(l.to))&&(l.connected=!0,o.show(),WaspUI.addConnector(o.id,this.id)):l.to==i&&(o=WaspUI.findNodeFromUrl(l.from))&&(l.connected=!0,o.show(),WaspUI.addConnector(this.id,o.id))}}},hideConnections:{enumerable:!0,value:function(){var e,t=document.querySelector('[data-to="'+this.id+'"], [data-from="'+this.id+'"]');for(e=t.length;e--;)t[e].parentElement&&(document.querySelector("#"+t[e].dataset.to).classList.remove("connected"),document.querySelector("#"+t[e].dataset.from).classList.remove("connected"),t[e].parentElement.removeChild(t[e]))}},addCalls:{enumerable:!0,value:function(e){e&&e===e+""&&(this.dataset.calls?-1==this.dataset.calls.indexOf(e)&&(this.dataset.calls+=" "+e):this.dataset.calls=e)}},addCalledBy:{enumerable:!0,value:function(e){e&&e===e+""&&(this.dataset.calledby?-1==this.dataset.calledby.indexOf(e)&&(this.dataset.calls+=" "+e):this.dataset.calledby=e)}}}),r},WaspUI.addConnector=function(e,t,n){if(!document.querySelector('.connect[data-to="'+e+'"][data-from="'+t+'"]')){var s=document.createElement("div");s.appendChild(document.createElement("span")),s.appendChild(document.createElement("span")),s.dataset.to=e,s.dataset.from=t,s.dataset.cCount=n,s.className="connect",WaspUI.mainPanel.currentContent.element.insertBefore(s,WaspUI.mainPanel.currentContent.firstChild),WaspUI.chron.doUntil(WaspUI.sizeConnectors,!1)}},WaspUI.sizeConnectors=function(){var e=document.querySelectorAll(".connect"),t=[];if(!e.length)return!1;for(var n=e.length;n--;t.unshift(e[n]));var s=t[0].parentElement.totalOffset();for(n=t.length;n--;){var i=t[n];i.fr||(i.fr=document.querySelector("#"+i.dataset.from)),i.fr.classList.add("connected"),i.to||(i.to=document.querySelector("#"+i.dataset.to)),i.to.classList.add("connected");if(i.fr.visible&&i.to.visible){var r=7*n,a=i.fr.totalOffset(),o=a.left+i.fr.offsetWidth>>0,l=a.top+.5*i.fr.offsetHeight>>0,c=i.to.totalOffset(),d=c.left+i.to.offsetWidth>>0,h=c.top+.5*i.to.offsetHeight>>0,p=Math.min(o,d)-s.left,u=Math.min(l,h)-s.top,m="left: "+p+"px; ";if(m+="top: "+u+"px; ",m+="width: "+(Math.max(o+r,d+r)-s.left-p)+"px; ",m+="height: "+(Math.max(l,h)-s.top-u)+"px; ",m!=i.getAttribute("style")){i.stable=0;var f="connect";if(f+=h>l?" st bl tl":" sb bl tl",f!=i.className){i.className=f;{i.querySelector("span:first-child")}}i.setAttribute("style",m)}else++i.stable>25&&(i.stable=0,t.splice(n,1))}else i.parentElement&&i.fr.classList.remove("connected"),i.to.classList.remove("connected"),i.parentElement.removeChild(i),t.splice(n,1)}return t.length?!0:!1},WaspUI.addTree=function(e){var t=document.createElement("ul");return e.appendChild(t),t.className="tree",t.branches={},t.branchIds=[],t.label=document.createElement("label"),Object.defineProperties(t,{addBranch:{enumerable:!0,value:function(e,t,n,s){var i=WaspUI.addTreeNode(this,e,t,!0,s);return i.className=n?"asc":"desc",this.branches[e]=i,this.branchIds.push(e),i}},prune:{eunmerable:!0,value:function(){for(var e=this.children,t=e.length;t--;)this.removeChild(e[t])}}}),t},WaspUI.hideTreeNode=function(e,t,n){(e.classList.contains("selected")||e.querySelector(".selected"))&&WaspUI.mainPanel&&WaspUI.mainPanel.currentContent&&WaspUI.mainPanel.currentContent.pageNode&&WaspUI.mainPanel.currentContent.pageNode.click();var s=document.createElement("template");s.id=e.id+"-hide",s.dataset[n]=t,e.parentNode.insertBefore(s,e),s.content.appendChild(e)},WaspUI.unhideTreeNode=function(e,t){var n=document.querySelector("template[data-"+t+'="'+e+'"]');return n?(n.parentNode.insertBefore(n.content.firstChild,n),n.parentNode.removeChild(n),!0):!1},WaspUI.friendly=[],WaspUI.friendly.groups={},WaspUI.friendly.cookieGroups={},WaspUI.friendly.tests={},WaspUI.friendly.testKeys=[],WaspUI.friendly.setGroup=function(e){var t=WaspUI.friendly;WaspUI.cql.exists("friendly")||WaspUI.cql.define("friendly","host,file,id"),(e.id&&e.id===e.id+""&&e.use&&e.use===e.use+""||e.title&&e.title===e.title+""&&e.tags)&&(e.id in t.groups?(t[t.groups[e.id]]=e,e.host.length&&e.file.length?WaspUI.cql.update("friendly",{host:e.host.join(" "),file:e.file.join(" ")},"id="+e.id):e.host.length?WaspUI.cql.update("friendly",{host:e.host.join(" "),file:"*"},"id="+e.id):e.file.length?WaspUI.cql.update("friendly",{host:"*",file:e.file.join(" ")},"id="+e.id):e.test&&e.test.length&&(WaspUI.friendly.tests[e.use||e.id]=new RegExp(e.test),WaspUI.friendly.testKeys=Object.keys(WaspUI.friendly.tests))):(t.groups[e.id]=t.length,t.push(e),e.host.length&&e.file.length?WaspUI.cql.insert("friendly",{host:e.host.join(" "),file:e.file.join(" "),id:e.id}):e.host.length?WaspUI.cql.insert("friendly",{host:e.host.join(" "),file:"*",id:e.id}):e.file.length?WaspUI.cql.insert("friendly",{host:"*",file:e.file.join(" "),id:e.id}):e.test&&e.test.length&&(WaspUI.friendly.tests[e.use||e.id]=new RegExp(e.test),WaspUI.friendly.testKeys=Object.keys(WaspUI.friendly.tests))),e.test&&e.test.length&&(e.test=new RegExp(e.test)),e.cookies&&Object.keys(e.cookies).length&&(WaspUI.friendly.cookieGroups[e.id]=e))
},WaspUI.friendly.intersectTags=function(e,t,n,s,r){var a,o,l,c,d,h=[];if(!e||!Object.keys(e).length)return h;for(a=t.length;a--;)if(o=t[a],c=o[n].replace(/\d+/g,"*"),i=o[n].match(/\d+/g),c in e){if(l=e[c],"skip"!==l.group){try{d=decodeURIComponent(o[s])}catch(p){try{d=unescape(o[s])}catch(p){d=o[s]}}if(label=l.label,group=l.group,i)for(var u=0,m=i.length;m>u;u++)label=/\!/.test(label)?label.replace(/\!/,""):label.replace(/\*/,i[u]),group=group.replace(/\*/,i[u]);h.push({name:label+" ("+o[n]+")",value:d,group:group,help:l.help})}}else if(r){try{d=decodeURIComponent(o[s])}catch(p){try{d=unescape(o[s])}catch(p){d=o[s]}}h.push({name:"("+o[n]+")",value:d,group:"{Unknown Variables}"})}return h},WaspUI.friendly.findGroup=function(e,t,n){var s=WaspUI.cql.select("friendly",'host~="'+e+'",file~="'+t+'"||host~="'+e+'",file="*"||host="*",file~="'+t+'"'),i=s&&s.length?s[0].use||s[0].id:null;if(!i){s=WaspUI.friendly;for(var r=s.testKeys.length;r--;)if(s.tests[s.testKeys[r]].test(n)){i=s.testKeys[r];break}}return this.getGroup(i)},WaspUI.friendly.getGroup=function(e){var t=WaspUI.friendly;return e&&e in t.groups?t[t.groups[e]]:{id:e,title:"",version:0,host:[],file:[],tags:{},cookies:{}}},WebInspector.SoftContextMenu=function(e,t){this._items=e,this._parentMenu=t},WebInspector.SoftContextMenu.prototype={show:function(e,t){this._x=e.x,this._y=e.y,this._time=(new Date).getTime();for(var n=e.pageX,s=e.pageY,i=e.target;i&&window!==i.ownerDocument.defaultView;){var r=i.ownerDocument.defaultView.frameElement;s+=r.totalOffsetTop(),n+=r.totalOffsetLeft(),i=r}var a;this._contextMenuElement=document.createElement("div"),this._contextMenuElement.className="soft-context-menu",this._contextMenuElement.tabIndex=0,t&&(a=e.currentTarget.getBoundingClientRect(),n=a.left,s=a.bottom),this._contextMenuElement.style.top=s+"px",this._contextMenuElement.style.left=n+"px",this._contextMenuElement.addEventListener("mouseup",consumeEvent,!1),this._contextMenuElement.addEventListener("keydown",this._menuKeyDown.bind(this),!1);for(var o=0;o<this._items.length;++o)this._contextMenuElement.appendChild(this._createMenuItem(this._items[o]));this._parentMenu?this._parentMenu._parentGlassPaneElement().appendChild(this._contextMenuElement):(this._glassPaneElement=document.createElement("div"),this._glassPaneElement.className="soft-context-menu-glass-pane",this._glassPaneElement.tabIndex=0,this._glassPaneElement.addEventListener("mouseup",this._glassPaneMouseUp.bind(this),!1),this._glassPaneElement.appendChild(this._contextMenuElement),document.body.appendChild(this._glassPaneElement),this._focus()),document.body.offsetWidth<this._contextMenuElement.offsetLeft+this._contextMenuElement.offsetWidth&&(this._contextMenuElement.style.left=t?Math.max(0,a.right-this._contextMenuElement.offsetWidth)+"px":n-this._contextMenuElement.offsetWidth+"px"),document.body.offsetHeight<this._contextMenuElement.offsetTop+this._contextMenuElement.offsetHeight&&(this._contextMenuElement.style.top=t?Math.max(0,a.top-this._contextMenuElement.offsetHeight)+"px":document.body.offsetHeight-this._contextMenuElement.offsetHeight+"px"),e.consume(!0)},_parentGlassPaneElement:function(){return this._glassPaneElement?this._glassPaneElement:this._parentMenu?this._parentMenu._parentGlassPaneElement():null},_createMenuItem:function(e){if("separator"===e.type)return this._createSeparator();if("subMenu"===e.type)return this._createSubMenu(e);var t=document.createElement("div");t.className="soft-context-menu-item";var n=document.createElement("span");return n.textContent="✓ ",n.className="soft-context-menu-item-checkmark",e.checked||(n.style.opacity="0"),t.appendChild(n),t.appendChild(document.createTextNode(e.label)),t.addEventListener("mousedown",this._menuItemMouseDown.bind(this),!1),t.addEventListener("mouseup",this._menuItemMouseUp.bind(this),!1),t.addEventListener("mouseover",this._menuItemMouseOver.bind(this),!1),t.addEventListener("mouseout",this._menuItemMouseOut.bind(this),!1),t._actionId=e.id,t},_createSubMenu:function(e){var t=document.createElement("div");t.className="soft-context-menu-item",t._subItems=e.subItems;var n=document.createElement("span");n.textContent="✓ ",n.className="soft-context-menu-item-checkmark",n.style.opacity="0",t.appendChild(n);var s=document.createElement("span");return s.textContent="▶",s.className="soft-context-menu-item-submenu-arrow",t.appendChild(document.createTextNode(e.label)),t.appendChild(s),t.addEventListener("mousedown",this._menuItemMouseDown.bind(this),!1),t.addEventListener("mouseup",this._menuItemMouseUp.bind(this),!1),t.addEventListener("mouseover",this._menuItemMouseOver.bind(this),!1),t.addEventListener("mouseout",this._menuItemMouseOut.bind(this),!1),t},_createSeparator:function(){var e=document.createElement("div");return e.className="soft-context-menu-separator",e._isSeparator=!0,e.addEventListener("mouseover",this._hideSubMenu.bind(this),!1),e.createChild("div","separator-line"),e},_menuItemMouseDown:function(e){e.consume(!0)},_menuItemMouseUp:function(e){this._triggerAction(e.target,e),e.consume()},_focus:function(){this._contextMenuElement.focus()},_triggerAction:function(e,t){return e._subItems?(this._showSubMenu(e,t),t.consume(),void 0):(this._discardMenu(!0,t),"undefined"!=typeof e._actionId&&(WebInspector.contextMenuItemSelected(e._actionId),delete e._actionId),void 0)},_showSubMenu:function(e){e._subMenuTimer&&(clearTimeout(e._subMenuTimer),delete e._subMenuTimer),this._subMenu||(this._subMenu=new WebInspector.SoftContextMenu(e._subItems,this),this._subMenu.show(this._buildMouseEventForSubMenu(e)))},_buildMouseEventForSubMenu:function(e){var t={x:e.offsetWidth-3,y:e.offsetTop-1},n=this._x+t.x,s=this._y+t.y,i=parseInt(this._contextMenuElement.style.left,10)+t.x,r=parseInt(this._contextMenuElement.style.top,10)+t.y;return{x:n,y:s,pageX:i,pageY:r,consume:function(){}}},_hideSubMenu:function(){this._subMenu&&(this._subMenu._discardSubMenus(),this._focus())},_menuItemMouseOver:function(e){this._highlightMenuItem(e.target)},_menuItemMouseOut:function(e){if(!this._subMenu||!e.relatedTarget)return this._highlightMenuItem(null),void 0;var t=e.relatedTarget;(this._contextMenuElement.isSelfOrAncestor(t)||t.hasStyleClass("soft-context-menu-glass-pane"))&&this._highlightMenuItem(null)},_highlightMenuItem:function(e){this._highlightedMenuItemElement!==e&&(this._hideSubMenu(),this._highlightedMenuItemElement&&(this._highlightedMenuItemElement.removeStyleClass("soft-context-menu-item-mouse-over"),this._highlightedMenuItemElement._subItems&&this._highlightedMenuItemElement._subMenuTimer&&(clearTimeout(this._highlightedMenuItemElement._subMenuTimer),delete this._highlightedMenuItemElement._subMenuTimer)),this._highlightedMenuItemElement=e,this._highlightedMenuItemElement&&(this._highlightedMenuItemElement.addStyleClass("soft-context-menu-item-mouse-over"),this._contextMenuElement.focus(),this._highlightedMenuItemElement._subItems&&!this._highlightedMenuItemElement._subMenuTimer&&(this._highlightedMenuItemElement._subMenuTimer=setTimeout(this._showSubMenu.bind(this,this._highlightedMenuItemElement,this._buildMouseEventForSubMenu(this._highlightedMenuItemElement)),150))))},_highlightPrevious:function(){for(var e=this._highlightedMenuItemElement?this._highlightedMenuItemElement.previousSibling:this._contextMenuElement.lastChild;e&&e._isSeparator;)e=e.previousSibling;e&&this._highlightMenuItem(e)},_highlightNext:function(){for(var e=this._highlightedMenuItemElement?this._highlightedMenuItemElement.nextSibling:this._contextMenuElement.firstChild;e&&e._isSeparator;)e=e.nextSibling;e&&this._highlightMenuItem(e)},_menuKeyDown:function(e){switch(e.keyIdentifier){case"Up":this._highlightPrevious();break;case"Down":this._highlightNext();break;case"Left":this._parentMenu&&(this._highlightMenuItem(null),this._parentMenu._focus());break;case"Right":if(!this._highlightedMenuItemElement)break;this._highlightedMenuItemElement._subItems&&(this._showSubMenu(this._highlightedMenuItemElement,this._buildMouseEventForSubMenu(this._highlightedMenuItemElement)),this._subMenu._focus(),this._subMenu._highlightNext());break;case"U+001B":this._discardMenu(!0,e);break;case"Enter":if(!isEnterKey(e))break;case"U+0020":this._highlightedMenuItemElement&&this._triggerAction(this._highlightedMenuItemElement,e)}e.consume(!0)},_glassPaneMouseUp:function(e){e.x===this._x&&e.y===this._y&&(new Date).getTime()-this._time<300||(this._discardMenu(!0,e),e.consume())},_discardMenu:function(e,t){if(!this._subMenu||e)if(this._glassPaneElement){var n=this._glassPaneElement;delete this._glassPaneElement,document.body.removeChild(n),this._parentMenu&&(delete this._parentMenu._subMenu,e&&this._parentMenu._discardMenu(e,t)),t&&t.consume(!0)}else this._parentMenu&&this._contextMenuElement.parentElement&&(this._discardSubMenus(),e&&this._parentMenu._discardMenu(e,t),t&&t.consume(!0))},_discardSubMenus:function(){this._subMenu&&this._subMenu._discardSubMenus(),this._contextMenuElement.parentElement&&this._contextMenuElement.parentElement.removeChild(this._contextMenuElement),this._parentMenu&&delete this._parentMenu._subMenu}},WebInspector.ContextMenuItem=function(e,t,n,s,i){this._type=t,this._label=n,this._disabled=s,this._checked=i,this._contextMenu=e,("item"===t||"checkbox"===t)&&(this._id=e.nextId())},WebInspector.ContextMenuItem.prototype={id:function(){return this._id},type:function(){return this._type},isEnabled:function(){return!this._disabled},setEnabled:function(e){this._disabled=!e},_buildDescriptor:function(){switch(this._type){case"item":return{type:"item",id:this._id,label:this._label,enabled:!this._disabled};case"separator":return{type:"separator"};case"checkbox":return{type:"checkbox",id:this._id,label:this._label,checked:!!this._checked,enabled:!this._disabled}}}},WebInspector.ContextSubMenuItem=function(e,t,n){WebInspector.ContextMenuItem.call(this,e,"subMenu",t,n),this._items=[]},WebInspector.ContextSubMenuItem.prototype={appendItem:function(e,t,n){var s=new WebInspector.ContextMenuItem(this._contextMenu,"item",e,n);return this._pushItem(s),this._contextMenu._setHandler(s.id(),t),s},appendSubMenuItem:function(e,t){var n=new WebInspector.ContextSubMenuItem(this._contextMenu,e,t);return this._pushItem(n),n},appendCheckboxItem:function(e,t,n,s){var i=new WebInspector.ContextMenuItem(this._contextMenu,"checkbox",e,s,n);return this._pushItem(i),this._contextMenu._setHandler(i.id(),t),i},appendSeparator:function(){this._items.length&&(this._pendingSeparator=!0)},_pushItem:function(e){this._pendingSeparator&&(this._items.push(new WebInspector.ContextMenuItem(this._contextMenu,"separator")),delete this._pendingSeparator),this._items.push(e)},isEmpty:function(){return!this._items.length},_buildDescriptor:function(){for(var e={type:"subMenu",label:this._label,enabled:!this._disabled,subItems:[]},t=0;t<this._items.length;++t)e.subItems.push(this._items[t]._buildDescriptor());return e},__proto__:WebInspector.ContextMenuItem.prototype},WebInspector.ContextMenu=function(e){WebInspector.ContextSubMenuItem.call(this,this,""),this._event=e,this._handlers={},this._id=0},WebInspector.ContextMenu.prototype={nextId:function(){return this._id++},show:function(){var e=this._buildDescriptor();if(e.length){WebInspector._contextMenu=this;var t=new WebInspector.SoftContextMenu(e);t.show(this._event,!0),this._event.consume()}},showSoftMenu:function(){var e=this._buildDescriptor();if(e.length){WebInspector._contextMenu=this;var t=new WebInspector.SoftContextMenu(e);t.show(this._event,!0)}this._event.consume()},_setHandler:function(e,t){t&&(this._handlers[e]=t)},_buildDescriptor:function(){for(var e=[],t=0;t<this._items.length;++t)e.push(this._items[t]._buildDescriptor());return e},_itemSelected:function(e){this._handlers[e]&&this._handlers[e].call(this)},appendApplicableItems:function(e){for(var t=0;t<WebInspector.ContextMenu._providers.length;++t){var n=WebInspector.ContextMenu._providers[t];this.appendSeparator(),n.appendApplicableItems(this._event,this,e),this.appendSeparator()}},__proto__:WebInspector.ContextSubMenuItem.prototype},WebInspector.ContextMenu.Provider=function(){},WebInspector.ContextMenu.Provider.prototype={appendApplicableItems:function(){}},WebInspector.ContextMenu.registerProvider=function(e){WebInspector.ContextMenu._providers.push(e)},WebInspector.ContextMenu._providers=[],WebInspector.contextMenuItemSelected=function(e){WebInspector._contextMenu&&WebInspector._contextMenu._itemSelected(e)},WebInspector.contextMenuCleared=function(){},WaspUI.BypassNodeDialog=function(e,t,n,s){this.node=e,this.gp=new WebInspector.GlassPane;for(var i=document.querySelector("#bypass-node-template").content.cloneNode(!0),r=0;1!=i.childNodes[r].nodeType;)r++;this.element=i.childNodes[r],this.durationSet=i.querySelector("#bypass-node-duration"),this.scopeSet=i.querySelector("#bypass-node-scope"),this.overrideSet=this.overrideFile=this.overrideUrl=null,i.querySelector(".node-value").innerText=this.actionUrl=n.split(/#|\?/)[0],this.domain=s;for(var a=i.querySelectorAll("input[name='duration']"),r=a.length;r--;)a[r].addEventListener("click",this.events.onDurationClick.bind(this));for(a=i.querySelectorAll(".node-type-long"),r=a.length;r--;)a[r].innerText=s?"a domain":"a file or tag";var o="",l=this.manageAction=i.querySelector("#action-manage");switch(l.addEventListener("click",this.events.onManageClick.bind(this)),l=this.cancelAction=i.querySelector("#action-cancel"),l.addEventListener("click",this.events.onCancelClick.bind(this)),l=this.applyAction=i.querySelector("#action-apply"),t){case WaspUI.BYPASS_TYPE_HIDE:l.addEventListener("click",this.events.onApplyHideClick.bind(this)),i.querySelector("#bypass-node-occurrence").classList.add("hidden"),o="Hide",l=i.querySelector("#bypass-node-override"),l.parentNode.removeChild(l);break;case WaspUI.BYPASS_TYPE_BLOCK:l.addEventListener("click",this.events.onApplyBlockClick.bind(this)),o="Block",l=i.querySelector("#bypass-node-override"),l.parentNode.removeChild(l);break;case WaspUI.BYPASS_TYPE_OVERRIDE:l.addEventListener("click",this.events.onApplyOverrideClick.bind(this)),o="Override",this.overrideSet=l=i.querySelector("#bypass-node-override"),this.overrideUrl=i.querySelector("#bypass-node-override-url"),l.classList.remove("hidden")}for(a=i.querySelectorAll(".bypass-type"),r=a.length;r--;)a[r].innerText=o;l=this.element;var c=this.gp.element;c.appendChild(l)},WaspUI.BypassNodeDialog.prototype={events:{onManageClick:function(e){this.events.onCancelClick.call(this,e,!0);new WaspUI.ManageBypassesDialog},onCancelClick:function(e,t){this.element.parentElement.removeChild(this.element),!t&&this.gp&&(this.gp.dispose(),delete this.gp)},onApplyHideClick:function(e){var t,n,s,i,r,a,o,l,c=this.element;if(!c.querySelector("#bypass-node-duration-never").checked)if(t=WaspUI.mainPanel.currentContent,n=4,r=WaspUI.BYPASS_TAB_TRACKED,c.querySelector("#bypass-node-duration-window").checked?(n=1,r=WaspUI.currentTab):c.querySelector("#bypass-node-duration-session").checked&&(n=2),s=4,i="",c.querySelector("#bypass-node-scope-page").checked?(s=1,i=t.url):c.querySelector("#bypass-node-scope-domain").checked&&(s=2,i=t.domain),WaspUI.addBypass(WaspUI.BYPASS_TYPE_HIDE,this.actionUrl,this.domain,n,s,i,r),this.domain){for(o=WaspUI.mainPanel.contentPanels.length;o--;)if(t=WaspUI.mainPanel.contentPanels[o],4===s||2===s&&t.domain===i||1===s&&t.url===i)for(a=WaspUI.findDomainNodes(this.actionUrl,t),l=a.length;l--;WaspUI.hideTreeNode(a[l],this.actionUrl,"domain"));WaspUI.sizeConnectors()}else for(o=WaspUI.mainPanel.contentPanels.length;o--;)if(t=WaspUI.mainPanel.contentPanels[o],4===s||2===s&&t.domain===i||1===s&&t.url===i)for(a=WaspUI.findNodelistFromUrl(this.actionUrl,t,!0),l=a.length;l--;WaspUI.hideTreeNode(a[l],this.actionUrl,"url"));this.events.onCancelClick.call(this,e)},onApplyBlockClick:function(e){var t,n,s,i,r,o=this.element;if(!o.querySelector("#bypass-node-duration-never").checked)for(t=WaspUI.mainPanel.currentContent,s=o.querySelector("#bypass-node-always").checked?WaspUI.BYPASS_TAB_ALL:WaspUI.BYPASS_TAB_TRACKED,n=4,o.querySelector("#bypass-node-duration-window").checked?(n=1,s=WaspUI.currentTab):o.querySelector("#bypass-node-duration-session").checked&&(n=2),i=4,r="",o.querySelector("#bypass-node-scope-page").checked?(i=1,r=t.url):o.querySelector("#bypass-node-scope-domain").checked&&(i=2,r=t.domain),WaspUI.addBypass(WaspUI.BYPASS_TYPE_BLOCK,this.actionUrl,this.domain,n,i,r,s),a=WaspUI.mainPanel.contentPanels.length;a--;)if(t=WaspUI.mainPanel.contentPanels[a],4===i||2===i&&t.domain===r||1===i&&t.url===r)for(nl=WaspUI.findNodelistFromUrl(this.actionUrl,t,!0),b=nl.length;b--;nl[b].classList.add("blocked"));this.events.onCancelClick.call(this,e)},onApplyOverrideClick:function(e){var t,n,s,i,r,o,l,c=this.element;if(!c.querySelector("#bypass-node-duration-never").checked){if(o=WaspUI.BYPASS_OVERRIDE_URL,l=c.querySelector("#bypass-node-override-url").value,!l)return t=c.querySelector(".error"),t.innerText="Please supply an override script url.",t.classList.add("popup"),c.querySelector("#bypass-node-override-url").focus(),window.setTimeout(function(){t.classList.remove("popup")},2e3),void 0;if(l!==l.parseUrl().href)return t=c.querySelector(".error"),t.innerText="Please supply a valid override script url.",t.classList.add("popup"),c.querySelector("#bypass-node-override-url").focus(),window.setTimeout(function(){t.classList.remove("popup")},2e3),void 0;for(t=WaspUI.mainPanel.currentContent,s=c.querySelector("#bypass-node-always").checked?WaspUI.BYPASS_TAB_ALL:WaspUI.BYPASS_TAB_TRACKED,n=4,c.querySelector("#bypass-node-duration-window").checked?(n=1,s=WaspUI.currentTab):c.querySelector("#bypass-node-duration-session").checked&&(n=2),i=4,r="",c.querySelector("#bypass-node-scope-page").checked?(i=1,r=t.url):c.querySelector("#bypass-node-scope-domain").checked&&(i=2,r=t.domain),WaspUI.addBypass(WaspUI.BYPASS_TYPE_OVERRIDE,this.actionUrl,this.domain,n,i,r,s,o,l),a=WaspUI.mainPanel.contentPanels.length;a--;)if(t=WaspUI.mainPanel.contentPanels[a],4===i||2===i&&t.domain===r||1===i&&t.url===r)for(nl=WaspUI.findNodelistFromUrl(this.actionUrl,t,!0),b=nl.length;b--;nl[b].classList.add("override"));}this.events.onCancelClick.call(this,e)},onDurationClick:function(e){"0"===e.target.value?this.scopeSet.disabled=!0:"1"===e.target.value?(this.scopeSet.disabled=!1,this.element.querySelector("#bypass-node-occurrence").classList.add("disabled"),this.element.querySelector("#bypass-node-always").disabled=!0):(this.scopeSet.disabled=!1,this.element.querySelector("#bypass-node-occurrence").classList.remove("disabled"),this.element.querySelector("#bypass-node-always").disabled=!1),this.overrideSet&&(this.overrideSet.disabled=this.scopeSet.disabled)},onOverrideTypeChange:function(e){var t=this.overrideFile,n=this.overrideUrl;e.target.value==WaspUI.BYPASS_OVERRIDE_FILE?(t.classList.remove("hidden"),t.disabled=!1,n.classList.add("hidden"),n.disabled=!0):(n.classList.remove("hidden"),n.disabled=!1,t.classList.add("hidden"),t.disabled=!0)}}},WaspUI.ManageBypassesDialog=function(){ga("send","pageview",{page:"/bypass.htm",title:"Manage Bypasses"}),this.gp=new WebInspector.GlassPane;for(var e=document.querySelector("#manage-bypass-template").content.cloneNode(!0),t=0;1!==e.childNodes[t].nodeType;)t++;this.element=e.childNodes[t],this.toggleStyles=new Stylomatic(e.querySelector("style").sheet);var n=this.domainToggle=e.querySelector("#manage-bypasses-view-domain");n.addEventListener("click",this.events.onDomainToggleClick.bind(this)),n=this.scriptToggle=e.querySelector("#manage-bypasses-view-script"),n.addEventListener("click",this.events.onScriptToggleClick.bind(this)),n=this.hideToggle=e.querySelector("#manage-bypasses-view-hide"),n.addEventListener("click",this.events.onHideToggleClick.bind(this)),n=this.blockToggle=e.querySelector("#manage-bypasses-view-block"),n.addEventListener("click",this.events.onBlockToggleClick.bind(this)),n=this.overrideToggle=e.querySelector("#manage-bypasses-view-override"),n.addEventListener("click",this.events.onOverrideToggleClick.bind(this)),n=this.cancelAction=e.querySelector("#action-cancel"),n.addEventListener("click",this.events.onCancelClick.bind(this)),n=this.applyAction=e.querySelector("#action-apply"),n.addEventListener("click",this.events.onApplyClick.bind(this)),n=e.querySelector("#manage-bypasses-elements"),this.loadBypasses(n,WaspUI.cql.select("bypass","*","isDomain [true|false],url,type [hide|block|override],scope desc")),n=this.element;var s=this.gp.element;s.appendChild(n)},WaspUI.ManageBypassesDialog.prototype={loadBypasses:function(e,t){var n,s,i,r,a,o,l,c,d,h,p,u=0,m=0,f="";for(s=-1,i=t.length;++s<i;){if(r=t[s],p=e.querySelector("template").content.cloneNode(!0),f!==r.url){f=r.url,n=e,a=p.querySelector("fieldset"),u++,m=0;var d="-"+u;a.id=a.id.replace("-e",d),"true"===r.isDomain?(a.classList.add("domain"),p.querySelector(".node-type").innerText="Domain"):(a.classList.add("script"),p.querySelector(".node-type").innerText="File"),p.querySelector(".node-value").innerText=r.url,a=p.querySelector("#manage-bypasses-e-r")}else p=a=p.querySelector("#manage-bypasses-e-r"),n=e.querySelector("fieldset:last-of-type");for(m++,h=d+"-"+m,a.id=a.id.replace("-e-r",h),a.classList.add(r.type),a=p.querySelector(".bypass-type"),a.innerText=r.type.substring(0,1).toUpperCase()+r.type.substring(1),"hide"!==r.type?p.querySelector("#manage-bypasses-e-r-occurrence").classList.remove("hidden"):(l=p.querySelector("#manage-bypasses-e-r-occurrence"),l.parentNode.removeChild(l)),"override"===r.type?p.querySelector("#manage-bypasses-e-r-override").classList.remove("hidden"):(l=p.querySelector("#manage-bypasses-e-r-override"),l.parentNode.removeChild(l)),o=p.querySelectorAll("input[name],select[name]"),c=o.length;c--;)l=o[c],l.name in r&&("duration"===l.name?(l.value=r[l.name],l.addEventListener("change",this.events.onDurationChange.bind(l)),this.events.onDurationChange.call(l)):"always"===l.name?l.checked=r.tab===WaspUI.BYPASS_TAB_ALL:l.value=r[l.name]);for(o=p.querySelectorAll('[id^="manage-bypasses-e-r-"]'),c=o.length;c--;)l=o[c],l.id=l.id.replace("-e-r",h);"1"===r.scope?(p.querySelector(".scope-type").innerText="this Page: ",p.querySelector(".scope-value").innerText=r.scopeUrl):"2"===r.scope?(p.querySelector(".scope-type").innerText="this Domain: ",p.querySelector(".scope-value").innerText=r.scopeUrl):p.querySelector(".scope-type").innerText="all sites.",n.appendChild(p)}},events:{onCancelClick:function(){this.element.parentElement.removeChild(this.element),this.gp.dispose(),delete this.gp},onDomainToggleClick:function(){"on"===this.domainToggle.value?(this.toggleStyles.add("domain","fieldset.domain { display:none; }"),this.domainToggle.value="off"):(this.toggleStyles.remove("domain"),this.domainToggle.value="on")},onScriptToggleClick:function(){"on"===this.scriptToggle.value?(this.toggleStyles.add("script","fieldset.script { display:none; }"),this.scriptToggle.value="off"):(this.toggleStyles.remove("script"),this.scriptToggle.value="on")},onHideToggleClick:function(){"on"===this.hideToggle.value?(this.toggleStyles.add("hide",".rule.hide { display:none; }"),this.hideToggle.value="off"):(this.toggleStyles.remove("hide"),this.hideToggle.value="on")},onBlockToggleClick:function(){"on"===this.blockToggle.value?(this.toggleStyles.add("block",".rule.block { display:none; }"),this.blockToggle.value="off"):(this.toggleStyles.remove("block"),this.blockToggle.value="on")},onOverrideToggleClick:function(){"on"===this.overrideToggle.value?(this.toggleStyles.add("override",".rule.override { display:none; }"),this.overrideToggle.value="off"):(this.toggleStyles.remove("override"),this.overrideToggle.value="on")},onApplyClick:function(e){var t,n,s,i,r,a,o,l,c=this.element;for(t=c.querySelectorAll('.rule[id^="manage-bypasses-"]'),WaspUI.cql.delete("bypass","*"),s=t.length;s--;){for(n=WaspUI.cql.defaultValues("bypass"),i=t[s].querySelectorAll("input[name],select[name]"),r=i.length;r--;)a=i[r],"always"===a.name?n.tab=a.checked?WaspUI.BYPASS_TAB_ALL:WaspUI.BYPASS_TAB_TRACKED:a.name in n&&(n[a.name]=a.value);if("1"===n.duration&&(n.tab=WaspUI.currentTab),"0"!==n.duration)WaspUI.addBypass(n.type,n.url,n.isDomain,n.duration,n.scope,n.scopeUrl,n.tab,n.override,n.overrideUrl);else if("hide"===n.type)if("true"===n.isDomain){for(o=WaspUI.mainPanel.contentPanels.length;o--;)if(l=WaspUI.mainPanel.contentPanels[o],"4"===n.scope||"2"===n.scope&&l.domain===n.scopeUrl||"1"===n.scope&&l.url===n.scopeUrl)for(;WaspUI.unhideTreeNode(n.url,"domain"););}else for(o=WaspUI.mainPanel.contentPanels.length;o--;)if(l=WaspUI.mainPanel.contentPanels[o],"4"===n.scope||"2"===n.scope&&l.domain===n.scopeUrl||"1"===n.scope&&l.url===n.scopeUrl)for(;WaspUI.unhideTreeNode(n.url,"url"););}WaspUI.saveBypasses(),WaspUI.sizeConnectors(),this.events.onCancelClick.call(this,e)},onDurationChange:function(){var e=this.parentNode,t=e.querySelector('[name="always"]');if(t){var n=t.parentNode,s=e.querySelector('[name="overrideUrl"]');"0"==this.value?(t.disabled=!0,n.classList.add("disabled"),s&&(s.disabled=!0)):"1"==this.value?(t.disabled=!0,n.classList.add("disabled"),s&&(s.disabled=!1)):(t.disabled=!1,n.classList.remove("disabled"),s&&(s.disabled=!1))}}}},WebInspector.StatusBarItem=function(e){this.element=e,this._enabled=!0},WebInspector.StatusBarItem.prototype={setEnabled:function(e){this._enabled!==e&&(this._enabled=e,this._applyEnabledState())},_applyEnabledState:function(){this.element.disabled=!this._enabled},__proto__:Object.prototype},WebInspector.StatusBarButton=function(e,t,n){WebInspector.StatusBarItem.call(this,document.createElement("button")),this.element.className=t+" status-bar-item",this.element.addEventListener("click",this._clicked.bind(this),!1),this.glyph=document.createElement("div"),this.glyph.className="glyph",this.element.appendChild(this.glyph),this.states=n,n||(this.states=2),this._state=2==n?!1:0,this.title=e,this.className=t,this._visible=!0},WebInspector.StatusBarButton.prototype={_clicked:function(){this.dispatchEventToListeners("click"),this._showOptionsTimer&&clearTimeout(this._showOptionsTimer)},enabled:function(){return this._enabled},get title(){return this._title},set title(e){this._title!==e&&(this._title=e,this.element.title=e)},get state(){return this._state},set state(e){this._state!==e&&(2===this.states?this.element.enableStyleClass("toggled-on",e):(this.element.removeStyleClass("toggled-"+this._state),0!==e&&this.element.addStyleClass("toggled-"+e)),this._state=e)},get toggled(){if(2!==this.states)throw"Only used toggled when there are 2 states, otherwise, use state";return this.state},set toggled(e){if(2!==this.states)throw"Only used toggled when there are 2 states, otherwise, use state";this.state=e},get visible(){return this._visible},set visible(e){this._visible!==e&&(this.element.enableStyleClass("hidden",!e),this._visible=e)},makeLongClickEnabled:function(e){function t(t){1===t.which&&(this._showOptionsTimer=setTimeout(this._showOptions.bind(this,e),200))}function n(e){1===e.which&&this._showOptionsTimer&&clearTimeout(this._showOptionsTimer)}this.longClickGlyph=document.createElement("div"),this.longClickGlyph.className="fill long-click-glyph",this.element.appendChild(this.longClickGlyph),this.longClickGlyphShadow=document.createElement("div"),this.longClickGlyphShadow.className="fill long-click-glyph shadow",this.element.appendChild(this.longClickGlyphShadow),this.element.addEventListener("mousedown",t.bind(this),!1),this.element.addEventListener("mouseout",n.bind(this),!1),this.element.addEventListener("mouseup",n.bind(this),!1)},_showOptions:function(e){function t(e){if(1===e.which){var t=e.target.enclosingNodeOrSelfWithClass("status-bar-item");t.addStyleClass("emulate-active")}}function n(e){if(1===e.which){var t=e.target.enclosingNodeOrSelfWithClass("status-bar-item");t.removeStyleClass("emulate-active")}}function s(e){if(1===e.which){o.dispose(),document.documentElement.removeEventListener("mouseup",a,!1);for(var t=0;t<i.length;++t)i[t].element.hasStyleClass("emulate-active")&&i[t]._clicked()}}var i=e(),r=new WebInspector.StatusBarButton(this.title,this.className,this.states);r.addEventListener("click",this._clicked,this),r.state=this.state,i.push(r);var a=s.bind(this);document.documentElement.addEventListener("mouseup",a,!1);var o=new WebInspector.GlassPane,l=o.element.createChild("div","alternate-status-bar-buttons-bar");const c=24;l.style.height=c*i.length+"px",l.style.left=this.element.offsetLeft+1+"px";for(var d=t.bind(this),h=n.bind(this),p=0;p<i.length;++p)i[p].element.addEventListener("mousemove",d,!1),i[p].element.addEventListener("mouseout",h,!1),l.appendChild(i[p].element);i[i.length-1].element.addStyleClass("emulate-active")},__proto__:WebInspector.StatusBarItem.prototype},WebInspector.StatusBarComboBox=function(e,t){WebInspector.StatusBarItem.call(this,document.createElement("span")),this.element.className="status-bar-select-container",this._selectElement=this.element.createChild("select","status-bar-item"),e&&this._selectElement.addEventListener("change",e,!1),t&&this._selectElement.addStyleClass(t)},WebInspector.StatusBarComboBox.prototype={size:function(){return this._selectElement.childElementCount},addOption:function(e){this._selectElement.appendChild(e)},createOption:function(e,t,n){var s=this._selectElement.createChild("option");return s.text=e,t&&(s.title=t),"undefined"!=typeof n&&(s.value=n),s},_applyEnabledState:function(){this._selectElement.disabled=!this._enabled},removeOption:function(e){this._selectElement.removeChild(e)},removeOptions:function(){this._selectElement.removeChildren()},selectedOption:function(){return this._selectElement.selectedIndex>=0?this._selectElement[this._selectElement.selectedIndex]:null},select:function(e){this._selectElement.selectedIndex=Array.prototype.indexOf.call(this._selectElement,e)},__proto__:WebInspector.StatusBarItem.prototype},WebInspector.SplitView=function(e,t,n,s){WebInspector.View.call(this,document.querySelector(".split-view")),this._firstElement=document.querySelector(".split-view-contents-first"),this._secondElement=document.querySelector(".split-view-contents-second"),this._resizerElement=document.querySelector(".split-view-resizer"),this.installResizer(this._resizerElement),this._resizable=!0,this._savedSidebarWidth=n||200,this._savedSidebarHeight=s||this._savedSidebarWidth,0<this._savedSidebarWidth&&this._savedSidebarWidth<1&&0<this._savedSidebarHeight&&this._savedSidebarHeight<1&&(this._useFraction=!0),this._sidebarSizeSettingName=t,this.setSecondIsSidebar(!0),this._innerSetVertical(e),this._updateLayout()},WebInspector.SplitView.prototype={isVertical:function(){return this._isVertical},setVertical:function(e){this._isVertical!==e&&(this._innerSetVertical(e),this.isShowing()&&this._updateLayout())},_innerSetVertical:function(e){this.element.removeStyleClass(this._isVertical?"split-view-vertical":"split-view-horizontal"),this._isVertical=e,this.element.addStyleClass(this._isVertical?"split-view-vertical":"split-view-horizontal")},_updateLayout:function(){this._updateTotalSize(),delete this._sidebarSize,this.setSidebarSize(this._lastSidebarSize())},firstElement:function(){return this._firstElement},secondElement:function(){return this._secondElement},get mainElement(){return this.isSidebarSecond()?this.firstElement():this.secondElement()},get sidebarElement(){return this.isSidebarSecond()?this.secondElement():this.firstElement()},isSidebarSecond:function(){return this._secondIsSidebar},setSecondIsSidebar:function(e){this.sidebarElement.removeStyleClass("split-view-sidebar"),this._secondIsSidebar=e,this.sidebarElement.addStyleClass("split-view-sidebar")},resizerElement:function(){return this._resizerElement},showOnlyFirst:function(){this._showOnly(this._firstElement,this._secondElement)},showOnlySecond:function(){this._showOnly(this._secondElement,this._firstElement)},_showOnly:function(e,t){e.removeStyleClass("hidden"),e.addStyleClass("maximized"),t.addStyleClass("hidden"),t.removeStyleClass("maximized"),this._removeAllLayoutProperties(),this._isShowingOne=!0,this.setResizable(!1),this.doResize()
},_removeAllLayoutProperties:function(){this._firstElement.style.removeProperty("right"),this._firstElement.style.removeProperty("bottom"),this._firstElement.style.removeProperty("width"),this._firstElement.style.removeProperty("height"),this._secondElement.style.removeProperty("left"),this._secondElement.style.removeProperty("top"),this._secondElement.style.removeProperty("width"),this._secondElement.style.removeProperty("height"),this._resizerElement.style.removeProperty("left"),this._resizerElement.style.removeProperty("right"),this._resizerElement.style.removeProperty("top"),this._resizerElement.style.removeProperty("bottom"),this._resizerElement.style.removeProperty("margin-left"),this._resizerElement.style.removeProperty("margin-right"),this._resizerElement.style.removeProperty("margin-top"),this._resizerElement.style.removeProperty("margin-bottom")},showBoth:function(){this._isShowingOne=!1,this._firstElement.removeStyleClass("hidden"),this._firstElement.removeStyleClass("maximized"),this._secondElement.removeStyleClass("hidden"),this._secondElement.removeStyleClass("maximized"),this._updateLayout(),this.setResizable(!0),this.doResize()},setResizable:function(e){this._resizable!==e&&(this._resizable=e,e?this._resizerElement.removeStyleClass("hidden"):this._resizerElement.addStyleClass("hidden"))},setSidebarSize:function(e){if(this._sidebarSize!==e){if(e=this.applyConstraints(e),0>e)return this._sidebarSize=e,void 0;this._innerSetSidebarSize(e),this._saveSidebarSize(e)}},sidebarSize:function(){return this._sidebarSize},totalSize:function(){return this._totalSize},_updateTotalSize:function(){this._totalSize=this._isVertical?this.element.offsetWidth:this.element.offsetHeight,this._useFraction&&(this._sidebarSize=this._lastSidebarSize())},_innerSetSidebarSize:function(e){if(!this._isShowingOne){this._removeAllLayoutProperties();var t;if(t=this._useFraction?e/this._totalSize*100+"%":e+"px",this._isVertical){var n=this._resizerElement.offsetWidth;this._secondIsSidebar?(this._firstElement.style.right=t,this._secondElement.style.width=t,this._resizerElement.style.right=t,this._resizerElement.style.marginRight=-n/2+"px"):(this._firstElement.style.width=t,this._secondElement.style.left=t,this._resizerElement.style.left=t,this._resizerElement.style.marginLeft=-n/2+"px")}else{var s=this._resizerElement.offsetHeight;this._secondIsSidebar?(this._firstElement.style.bottom=t,this._secondElement.style.height=t,this._resizerElement.style.bottom=t,this._resizerElement.style.marginBottom=-s/2+"px"):(this._firstElement.style.height=t,this._secondElement.style.top=t,this._resizerElement.style.top=t,this._resizerElement.style.marginTop=-s/2+"px")}this._sidebarSize=e,this.doResize()}},applyConstraints:function(e){const t=20;return e=Math.max(e,t),this._totalSize-e<t&&(e=this._totalSize-t),t>e?-1:e},wasShown:function(){this._updateLayout()},onResize:function(){this._sidebarSize<0?this._updateLayout():this._updateTotalSize()},_startResizerDragging:function(e){return this._resizable?(this._dragOffset=(this._secondIsSidebar?this._totalSize-this._sidebarSize:this._sidebarSize)-(this._isVertical?e.pageX:e.pageY),!0):!1},_resizerDragging:function(e){var t=(this._isVertical?e.pageX:e.pageY)+this._dragOffset,n=this._secondIsSidebar?this._totalSize-t:t;this.setSidebarSize(n),e.preventDefault()},_endResizerDragging:function(){delete this._dragOffset},installResizer:function(e){e.addEventListener("mousedown",this._onDragStart.bind(this),!1)},_onDragStart:function(e){WebInspector._elementDragStart(this._startResizerDragging.bind(this),this._resizerDragging.bind(this),this._endResizerDragging.bind(this),this._isVertical?"ew-resize":"ns-resize",e)},_sizeSetting:function(){if(!this._sidebarSizeSettingName)return null;var e=this._sidebarSizeSettingName+(this._isVertical?"":"H");return WebInspector.settings[e]||(WebInspector.settings[e]=WebInspector.settings.createSetting(e,void 0)),WebInspector.settings[e]},_lastSidebarSize:function(){var e=this._sizeSetting(),t=e?e.get():0;return t||(t=this._isVertical?this._savedSidebarWidth:this._savedSidebarHeight),this._useFraction&&(t*=this._totalSize),t},_saveSidebarSize:function(e){this._useFraction&&(e/=this._totalSize),this._isVertical?this._savedSidebarWidth=e:this._savedSidebarHeight=e;var t=this._sizeSetting();t&&t.set(e)},createButtonAndRegisterShortcuts:function(e,t,n,s){var i=new WebInspector.StatusBarButton(t,e);return i.element.addEventListener("click",n,!1),i.shortcuts=s,i},_updateButtonTitle:function(e,t){var n=e.shortcuts&&e.shortcuts.length;e.title=n?String.vsprintf(t,[e.shortcuts[0].name]):t},_shortcuts:{},registerShortcuts:function(e,t){for(var n=0;n<e.length;++n)this._shortcuts[e[n].key]=t},__proto__:WebInspector.View.prototype},WaspUI.SplitView=function(e,t,n,s){WebInspector.SplitView.call(this,e,t,n,s);var i=this.sidebarElement,r=i.toolbar=document.createElement("div");r.className="sidebar-pane-toolbar status-bar",r.id="wasp-sidebar-toolbar",i.appendChild(r),i.detailStack=new WebInspector.SidebarPaneStack("details"),i.contentStack=new WebInspector.SidebarPaneStack("content hidden"),i.appendChild(i.detailStack.element),i.appendChild(i.contentStack.element);var a=this.mainElement;a.contentPanels=[],a.currentContent=a.contentPanels[0]=new WaspUI.ContentPanel(a);for(var o=a.currentContent.element;a.firstElementChild;)o.appendChild(a.removeChild(a.firstElementChild));r=a.toolbar=document.createElement("div"),r.className="main-pane-toolbar tabbed-pane-toolbar status-bar",r.id="wasp-main-toolbar",r.resizeThumb=document.createElement("div"),r.resizeThumb.id="WASP-sidebar-resizer-widget",this.installResizer(r.resizeThumb),r.appendChild(r.resizeThumb),a.appendChild(r),a.appendChild(o),a.tabBar=new WaspUI.TabBar(r),a.getNewContentPane=function(e){var t=this.tabBar.tabs.length,n=e.parseUrl(),s=n.pathname.split("/"),i=s.pop();""===i&&(i+=s.pop()+"/"),t?(this.currentContent=new WaspUI.ContentPanel(this,e),this.contentPanels.push(this.currentContent),this.appendChild(this.currentContent.element)):this.currentContent.url=e;var r=this.tabBar.addTab(i,e,this.currentContent);return r.focused=!0,this.currentContent}.bind(a)},WaspUI.SplitView.prototype={__proto__:WebInspector.SplitView.prototype},WaspUI.ContentPanel=function(e,t,n){this.mainPanel=e,this.tab=n,n&&(n.panel=this),this.element=document.createElement("div"),this.element.className="main-pane-content tabbed-pane-content",this.url=t,this.handle=WaspUI.ContentPanel.handle++,this.onRemove=function(e){return e},this.pageNode=void 0},WaspUI.ContentPanel.handle=1,WaspUI.ContentPanel.prototype={get url(){return this.element.dataset.url},set url(e){e+="";var t=e.parseUrl(),n=t.hostname,s=t.hostname.split(".").reverse();this.element.dataset.url=e.split(/#|\?/)[0],s=n.match(/(?:[0-9]{1,3}\.){3}[0-9]{1,3}/)?n.split("."):2==s[0].length&&s[1].length<=3?s.slice(0,3).reverse():s.slice(0,2).reverse(),this.element.dataset.domain=s.join(".")},get domain(){return this.element.dataset.domain},remove:function(e){if(this.mainPanel){var t=this.mainPanel.contentPanels,n=t.indexOf(this);-1!=n&&(t.splice(n,1),this.element&&this.element.parentElement&&this.element.parentElement.removeChild(this.element),delete this.element,delete this.mainPanel,e||this.tab.remove(!0),delete this.tab,this.onRemove(this))}},get focused(){return!this.element.classList.contains("hidden")},set focused(e){e=!!e,e!=!this.element.classList.contains("hidden")&&(e?(this.mainPanel.currentContent&&this.mainPanel.currentContent!=this&&(this.mainPanel.currentContent.focused=!1),this.element.classList.remove("hidden"),this.tab.focused=!0,this.mainPanel.currentContent=this,this.pageNode&&this.pageNode.click()):(this.element.classList.add("hidden"),this.tab.focused=!1,this.mainPanel.currentContent==this&&(this.mainPanel.currentContent=null)))},get nextPanel(){var e=this.mainPanel.contentPanels,t=e.indexOf(this);return++t?t==e.length?e[0]:e[t]:null},get previousPanel(){var e=this.mainPanel.contentPanels,t=e.indexOf(this);return-1!=t?0==t?e[e.length-1]:e[--t]:null}},WaspUI.Tab=function(e,t,n,s){this.tabBar=n,n.tabs.push(this),this.panel=s,s&&(s.tab=this);var i=this.element=document.createElement("li");i.addEventListener("click",this.eventHandlers.onClick.bind(this)),i.className="tab",i.innerText=e,i.title=t,n.innerElement.appendChild(this.element)},WaspUI.Tab.prototype={remove:function(e){if(this.tabBar){var t=this.tabBar.tabs,n=t.indexOf(this);-1!=n&&(t.splice(n,1),this.element&&this.element.parentElement&&this.element.parentElement.removeChild(this.element),delete this.tabBar,delete this.closeButton,delete this.element,e||this.panel.remove(!0),delete this.panel)}},eventHandlers:{onClick:function(){this.focused=!0},onClose:function(){this.remove()},onEnter:function(){this.highlighted=!0},onLeave:function(){this.highlighted=!1}},get highlighted(){return this.element.classList.contains("highlight")},set highlighted(e){e?this.element.classList.contains("highlight"):this.element.classList.remove("highlight")},get focused(){return this.element.classList.contains("focus")},set focused(e){e=!!e,e!=this.element.classList.contains("focus")&&(e?(this.tabBar.currentTab&&this.tabBar.currentTab!=this&&(this.tabBar.currentTab.focused=!1),this.element.classList.add("focus"),this.panel.focused=!0,this.tabBar.currentTab=this,this.scrollIntoView()):(this.element.classList.remove("focus"),this.panel.focused=!1,this.tabBar.currentTab==this&&(this.tabBar.currentTab=null)))},scrollIntoView:function(){this.tabBar.scrollTabsTo(this.element.offsetLeft,this.element.offsetWidth)},get nextTab(){var e=this.tabBar.tabs,t=e.indexOf(this);return++t?t==e.length?e[0]:e[t]:null},get previousTab(){var e=this.tabBar.tabs,t=e.indexOf(this);return-1!=t?0==t?e[e.length-1]:e[--t]:null}},WaspUI.TabBar=function(e){this.outerElement=document.createElement("div"),this.outerElement.className="tab-container-outer",this.innerElement=document.createElement("ul"),this.innerElement.className="tab-container-inner",this.innerElement.style.left="0px",this.outerElement.appendChild(this.innerElement),this.leftScroller=new WebInspector.StatusBarButton("Scroll Tabs","WASP-scroll-button-left",1),this.leftScroller.element.classList.add("hidden"),this.rightScroller=new WebInspector.StatusBarButton("Scroll Tabs","WASP-scroll-button-right",1),this.rightScroller.element.classList.add("hidden"),this.tabs=[],this.currentTab=null,e.appendChild(this.leftScroller.element),e.appendChild(this.outerElement),e.appendChild(this.rightScroller.element)},WaspUI.TabBar.prototype={addTab:function(e,t,n){for(;this.tabs.length>=5;)this.tabs[0].remove();return new WaspUI.Tab(e,t,this,n)},scrollTabsTo:function(e,t){if(!isNaN(e)){var n=this.viewport;t=isNaN(t)?0:Math.max(0,Math.min(t,n.offset)),e=Math.max(0,Math.min(e,n.right+n.offset-t));var s=e+t,i=-n.left;n.left-e<0?i+=e:n.offset&&s>n.right&&(i+=n.right-s),this.innerElement.style.left=(0>i?i:0)+"px"}},scrollTabsBy:function(e){if(!isNaN(e)&&e){var t=this.viewport,n=-t.left,s=0;0>e&&t.offest>0?s=Math.max(n+e,-t.offset):e>0&&t.left<0&&(s=Math.min(n+e,0)),this.innerElement.style.left=s+"px"}},get viewport(){var e=parseInt(this.innerElement.style.left),t=this.innerElement.offsetWidth,n=this.outerElement.offsetWidth,s=n-e;return{top:0,left:-e,right:t>s?s:t,bottom:this.innerElement.offsetHeight,offset:t>s?t-s:0}}},WebInspector.SidebarPane=function(e){WebInspector.View.call(this),this.element.className="sidebar-pane",this.titleElement=document.createElement("div"),this.titleElement.className="sidebar-pane-toolbar",this.bodyElement=this.element.createChild("div","body"),this._title=e,this._expandCallback=null},WebInspector.SidebarPane.EventTypes={wasShown:"wasShown"},WebInspector.SidebarPane.prototype={title:function(){return this._title},prepareContent:function(e){e&&e()},expand:function(){this.prepareContent(this.onContentReady.bind(this))},onContentReady:function(){this._expandCallback?this._expandCallback():this._expandPending=!0},setExpandCallback:function(e){this._expandCallback=e,this._expandPending&&(delete this._expandPending,this._expandCallback())},wasShown:function(){WebInspector.View.prototype.wasShown.call(this),this.dispatchEventToListeners(WebInspector.SidebarPane.EventTypes.wasShown)},__proto__:WebInspector.View.prototype},WebInspector.SidebarPaneTitle=function(e,t,n){this._pane=t,this.element=e.createChild("div","sidebar-pane-title"),this.element.textContent=t.title(),this.element.tabIndex=0,this.element.addEventListener("click",this._toggleExpanded.bind(this),!1),this._pane._onTitleClick&&this.element.addEventListener("click",this._pane._onTitleClick.bind(this._pane)),this.element.addEventListener("keydown",this._onTitleKeyDown.bind(this),!1),n&&[].indexOf.call(this.elements.childNodes,n)>-1?this.element.ionsertBefore(this._pane.titleElement,n):this.element.appendChild(this._pane.titleElement),this._pane.setExpandCallback(this._expand.bind(this))},WebInspector.SidebarPaneTitle.prototype={_expand:function(){this.element.addStyleClass("expanded"),this._pane.show(this.element.parentNode,this.element.nextSibling)},_collapse:function(){this.element.removeStyleClass("expanded"),this._pane.element.parentNode==this.element.parentNode&&this._pane.detach()},_toggleExpanded:function(){this.element.hasStyleClass("expanded")?this._collapse():this._pane.expand()},_onTitleKeyDown:function(e){(isEnterKey(e)||e.keyCode===WebInspector.KeyboardShortcut.Keys.Space.code)&&this._toggleExpanded()}},WebInspector.SidebarPaneStack=function(e){WebInspector.View.call(this),this.element.className="sidebar-pane-stack fill "+(e||""),this.panes=[]},WebInspector.SidebarPaneStack.prototype={addPane:function(e,t){return t&&t.titleElement?new WebInspector.SidebarPaneTitle(this.element,e,t):new WebInspector.SidebarPaneTitle(this.element,e),this.panes.push(e),this.panes.length-1},clearPanes:function(){for(var e=this.element,t=e.children.length;t--;)e.removeChild(e.children[t]);this.panes=[]},__proto__:WebInspector.View.prototype},WaspUI.SidebarPane=function(e,t,n){WebInspector.SidebarPane.call(this,e),this.element.id=t,this._expanded="true"===String(WaspUI.settings.get("pane-"+t+"-expanded",n)),this.titleElement.addEventListener("mouseup",this._onTitleClick.bind(this)),this._expanded&&this.expand()},WaspUI.SidebarPane.prototype={sections:[],_onTitleClick:function(){this._expanded=!this._expanded,WaspUI.settings.set("pane-"+this.element.id+"-expanded",this._expanded)},addPropertiesSection:function(e,t){var n=new WaspUI.PropertiesSection(e,t);return this.sections.push(n),this.bodyElement.appendChild(n.element),n},addPropertiesSectionsFromArray:function(e,t,n,s,i){for(var r,a="",o=-1,l=e.length;++o<l;){var c=e[o];c[t]!==a&&(a=c[t],r=this.addPropertiesSection(a,i)),r.addProperty(c[n],c[s])}},addCodeViewSection:function(e,t){var n=new WaspUI.CodeViewSection(e);return n.element.id=t,this.sections.push(n),this.bodyElement.appendChild(n.element),n},addEmptySection:function(e,t){var n=new WaspUI.EmptySection(e);return t&&(n.element.id=t),this.sections.push(n),this.bodyElement.appendChild(n.element),n},addImageSection:function(e,t){var n=new WaspUI.ImageSection(e);return t&&(n.element.id=t),this.sections.push(n),this.bodyElement.appendChild(n.element),n},__proto__:WebInspector.SidebarPane.prototype},WebInspector.Section=function(e,t){this.element=document.createElement("div"),this.element.className="section",this.element._section=this,this.headerElement=document.createElement("div"),this.headerElement.className="header",this.titleElement=document.createElement("div"),this.titleElement.className="title",this.subtitleElement=document.createElement("div"),this.subtitleElement.className="subtitle",this.headerElement.appendChild(this.subtitleElement),this.headerElement.appendChild(this.titleElement),this.headerElement.addEventListener("click",this.handleClick.bind(this),!1),this.element.appendChild(this.headerElement),this.title=e,this.subtitle=t,this._expanded=!1},WebInspector.Section.prototype={get title(){return this._title},set title(e){this._title!==e&&(this._title=e,e instanceof Node?(this.titleElement.removeChildren(),this.titleElement.appendChild(e)):this.titleElement.textContent=e)},get subtitle(){return this._subtitle},set subtitle(e){this._subtitle!==e&&(this._subtitle=e,this.subtitleElement.textContent=e)},get subtitleAsTextForTest(){var e=this.subtitleElement.textContent,t=this.subtitleElement.querySelector("[data-uncopyable]");if(t){var n=t.getAttribute("data-uncopyable");n&&(e+=n)}return e},get expanded(){return this._expanded},set expanded(e){e?this.expand():this.collapse()},get populated(){return this._populated},set populated(e){this._populated=e,!e&&this._expanded&&(this.onpopulate(),this._populated=!0)},onpopulate:function(){},get firstSibling(){var e=this.element.parentElement;if(!e)return null;for(var t=e.firstChild;t;){if(t._section)return t._section;t=t.nextSibling}return null},get lastSibling(){var e=this.element.parentElement;if(!e)return null;for(var t=e.lastChild;t;){if(t._section)return t._section;t=t.previousSibling}return null},get nextSibling(){var e=this.element;do e=e.nextSibling;while(e&&!e._section);return e?e._section:null},get previousSibling(){var e=this.element;do e=e.previousSibling;while(e&&!e._section);return e?e._section:null},expand:function(){this._expanded||(this._expanded=!0,this.element.addStyleClass("expanded"),this._populated||(this.onpopulate(),this._populated=!0))},collapse:function(){this._expanded&&(this._expanded=!1,this.element.removeStyleClass("expanded"))},toggleExpanded:function(){this.expanded=!this.expanded},handleClick:function(e){this.toggleExpanded(),e.consume()}},WaspUI.PropertiesSection=function(e,t){var n=t?0:"";WebInspector.Section.call(this,e,n),this.headerElement.addStyleClass("monospace"),this.propertiesElement=document.createElement("ol"),this.propertiesElement.className="properties properties-tree monospace",this.propertiesTreeOutline=new TreeOutline(this.propertiesElement,!0),this.propertiesTreeOutline.setFocusable(!1),this.propertiesTreeOutline.section=this,this.element.appendChild(this.propertiesElement),this.propertyCount=t?0:-1,this.copyText="",this.headerElement.addEventListener("contextmenu",this._onContextMenu.bind(this),!1)},WaspUI.PropertiesSection.prototype={addProperty:function(e,t,n,s){t=unescape(unescape(t));var i=new WaspUI.PropertyTreeElement(e,t,n);this.copyText+=e+"="+t+"\n",this.propertiesTreeOutline.appendChild(i),this.subtitle=this.propertyCount>=0?++this.propertyCount:"",s||this.expand()},addSimpleProperty:function(e,t,n){e=unescape(unescape(e));var s=new WaspUI.SimpleTreeElement(e,t);this.copyText+=e+"\n",this.propertiesTreeOutline.appendChild(s),this.subtitle=this.propertyCount>=0?++this.propertyCount:"",n||this.expand()},addPropertiesFromArray:function(e,t,n,s,i){for(var r=-1,a=e.length;++r<a;){var o=e[r];this.addProperty(o[t],o[n],s,i)}},addSimplePropertiesFromArray:function(e,t,n){for(var s=-1,i=e.length;++s<i;){var r=e[s];this.addSimpleProperty(r,t,n)}},addPropertiesFromQuerystring:function(e,t){if(e){0===e.indexOf("?")&&(e=e.substr(1));for(var n=e.split("&"),s=[],i=-1,r=n.length;++i<r;)s=n[i].split("="),2===s.length?this.addProperty(s[0],s[1],!1,t):this.addSimpleProperty(n[i],!0,t);n.length<=1&&s.length<=1&&this.addSimpleProperty("text",e,t)}},_onContextMenu:function(e){function t(){copyToClipboard(this.copyText)}if(this.copyText.length){var n=new WebInspector.ContextMenu(e);n.appendItem("Copy all to Clipboard",t.bind(this)),n.show()}},__proto__:WebInspector.Section.prototype},WaspUI.PropertyTreeElement=function(e,t,n){this.property={name:e,value:t,extended:!!n},TreeElement.call(this,"",null,!1),this.toggleOnClick=!0,this.selectable=!1},WaspUI.PropertyTreeElement.prototype={onattach:function(){this.update()},update:function(){this.nameElement=document.createElement("span"),this.nameElement.className="name",this.nameElement.textContent=this.property.name,this.property.enumerable||this.nameElement.addStyleClass("dimmed");var e=document.createElement("span");e.className="separator",e.textContent=": ",this.valueElement=document.createElement("span"),this.property.extended?(this.valueElement.className="value extended",this.valueElement.textContent="<br>"+this.property.value):(this.valueElement.className="value",this.valueElement.textContent=this.property.value),this.listItemElement.appendChild(this.nameElement),this.listItemElement.appendChild(e),this.listItemElement.appendChild(this.valueElement),this.hasChildren=this.property.value.hasChildren,this.listItemElement.addEventListener("contextmenu",this._onContextMenu.bind(this),!1)},_onContextMenu:function(e){function t(){copyToClipboard(this.property.name+"="+this.property.value)}var n=new WebInspector.ContextMenu(e);n.appendItem("Copy to Clipboard",t.bind(this)),n.show()},__proto__:TreeElement.prototype},WaspUI.SimpleTreeElement=function(e,t){this.property={value:e,extended:!!t},TreeElement.call(this,e,null,!1),this.toggleOnClick=!0,this.selectable=!1},WaspUI.SimpleTreeElement.prototype={onattach:function(){this.update()},update:function(){this.property.extended&&(this.listItemElement.classname+=" extended"),this.hasChildren=!1},__proto__:TreeElement.prototype},WaspUI.CodeViewSection=function(e){this.element=document.createElement("pre"),this.element.className="properties-code monospace",e&&this.appendContent(e)},WaspUI.CodeViewSection.prototype={appendContent:function(e){var t,n,s=e.split("\n"),i=this.element,r=document.createDocumentFragment();i.classList.remove("ldig"+i.childElementCount.toString().length);for(var a=-1,o=s.length;++a<o;)t=s[a],n=document.createElement("span"),n.textContent=t+" ",r.appendChild(n);i.appendChild(r),i.classList.add("ldig"+i.childElementCount.toString().length)},clearContent:function(){for(var e=this.codeElement;e.lastChild;)e.removeChild(e.lastChild)}},WaspUI.EmptySection=function(e){this.element=document.createElement("p"),this.element.className="properties-empty",e&&(this.element.innerHTML=e)},WaspUI.ImageSection=function(e){this.element=document.createElement("p"),this.element.className="properties-image",this.element.innerHTML='Image:<br><img src="'+e+'">'},WaspUI.addNodeFavicon=function(){try{var e=this.querySelector("label");e||(e=this.querySelector("span")),e.style.backgroundImage="url("+this.favicon.src+")"}catch(t){}},WaspUI.addDefaultFavicon=function(){try{var e=this.favicon=new Image;e.onload=WaspUI.addNodeFavicon.bind(this),e.src="http://"+this.outerHTML.match(/data-domain="([^"]+)"/)[1]+"/favicon.ico"}catch(t){}},WaspUI.addDomainInfo=function(){this.description="(no description available)",WaspUI.addDefaultFavicon.call(this)},WaspUI.createRequestNode=function(e,t,n,s){var i,r,a,o,l,c=e.hostname,d=e.href.split("#")[0],h=e.hostname.split(".").reverse(),p=WaspUI.mainPanel.currentContent;c?(h=c.match(/(?:[0-9]{1,3}\.){3}[0-9]{1,3}/)?c.split("."):2==h[0].length&&h[1].length<=3?h.slice(0,3).reverse():h.slice(0,2).reverse(),i=h.join("_"),e.hostname=h.join(".")):(c=h=e.hostname=e.protocol,i=h.split("").pop().join("")),t.branches&&t.branches[i]?r=t.branches[i]:(r=t.addBranch(i,e.hostname),r.classList.add("domain"),r.subdomains={},r.dataset.domain=r.hostname=e.hostname,(l=WaspUI.getBypasses(WaspUI.BYPASS_TYPE_HIDE,e.hostname,WaspUI.BYPASS_SCOPE_ALL)).length?WaspUI.hideTreeNode(r,e.hostname,"domain"):(l=WaspUI.getBypasses(WaspUI.BYPASS_TYPE_HIDE,e.hostname,WaspUI.BYPASS_SCOPE_DOMAIN,p.domain)).length?WaspUI.hideTreeNode(r,e.hostname,"domain"):(l=WaspUI.getBypasses(WaspUI.BYPASS_TYPE_HIDE,e.hostname,WaspUI.BYPASS_SCOPE_PAGE,p.url)).length&&WaspUI.hideTreeNode(r,e.hostname,"domain"),WaspUI.addDomainInfo.call(r)),r.subdomains[c]||(r.subdomains[c]=!0,r.setAttribute("title",(a=r.getAttribute("title"))?a+="\n"+c:c));var u=e.pathname.split("/"),o=u.pop();return""===o&&(o+=u.pop()+"/"),r=r.addBranch(e.pathname.replace(/[^a-zA-Z0-9]/g,"_"),o,!0),"Marketer"===WaspUI.displayType&&1==t.branches[i].branchIds.length?r.controller.uncheck():"Analyst"===WaspUI.displayType&&t.id.match(/^scripts/)&&1==t.branches[i].branchIds.length&&r.controller.uncheck(),r.setAttribute("title","right click for more options"),r.dataset.url=d,r.dataset.domain=e.hostname,r.dataset.name=o,(l=WaspUI.getBypasses(WaspUI.BYPASS_TYPE_HIDE,d,WaspUI.BYPASS_SCOPE_ALL)).length?WaspUI.hideTreeNode(r,d,"url"):(l=WaspUI.getBypasses(WaspUI.BYPASS_TYPE_HIDE,d,WaspUI.BYPASS_SCOPE_DOMAIN,p.domain)).length?WaspUI.hideTreeNode(r,d,"url"):(l=WaspUI.getBypasses(WaspUI.BYPASS_TYPE_HIDE,d,WaspUI.BYPASS_SCOPE_PAGE,p.url)).length&&WaspUI.hideTreeNode(r,d,"url"),r.addEventListener("click",n.bind(r),!1),s?r.addEventListener("contextmenu",s.bind(r),!1):r.addEventListener("contextmenu",WaspUI.events.onRequestNodeContextMenu.bind(r),!1),r.domainNode=t.branches[i],WaspUI.sizeConnectors(),r},WaspUI.makeNodeFriendly=function(e){var t=WaspUI.friendly.findGroup(e.dataset.domain,e.dataset.name,e.dataset.url),n=e.harObject;if(t.version){var s,i=t.classTag;if(i){for(var r=n.request.queryString.length;r--;)if(n.request.queryString[r].name==i){s=n.request.queryString[r].value,s=t.classMap?t.classMap[s]||s:s;break}s||(s=t.class)}else t.class&&(s=t.class);s?(e.classList.add("friendly-"+s),e.title=t.title+" ["+s+"]\n"+e.title):e.title=t.title+"\n"+e.title}},WaspUI.events||(WaspUI.events={}),WaspUI.events.selectedNode=void 0,WaspUI.events.buildGeneralProperties=function(e){var t=WaspUI.sidebarPanel.detailStack,n=new WaspUI.SidebarPane("General Properties","general",!0);t.addPane(n);var s=n.addPropertiesSection("SEO Info",!0);s.addProperty("Title",e.title||"(undefined)"),s.addProperty("Description",e.description||"(undefined)"),s.addProperty("Keywords",e.keywords||"(undefined)")},WaspUI.events.buildRequestProperties=function(e){var t,n=e.request,s=e.dataset?e.dataset.url:null,i=WaspUI.sidebarPanel.detailStack,r=this.selectedNode.dataset,a=WaspUI.friendly.findGroup(r.domain,r.name,r.url);if(a.version){if(n.queryString.length)t=WaspUI.friendly.intersectTags(a.tags,n.queryString,"name","value",!0);else if(n.postData)if(n.postData.params)t=WaspUI.friendly.intersectTags(a.tags,n.postData.params,"name","value",!0);else{for(var o=[],l=n.postData.text.split("&"),c=-1,d=l.length;++c<d;){var h=l[c].split("=");h.length>1&&o.push({name:h[0],value:h[1]})}t=WaspUI.friendly.intersectTags(a.tags,o,"name","value",!0)}if(t.length){t=t.multidimSort(["group","name"]);var p=new WaspUI.SidebarPane(a.title,"friendly-"+a.id,!0);p.addPropertiesSectionsFromArray(t,"group","name","value"),i.addPane(p)}}for(var u=Object.keys(WaspUI.friendly.cookieGroups),c=-1,d=u.length;++c<d;)if(a=WaspUI.friendly.cookieGroups[u[c]],t=WaspUI.friendly.intersectTags(a.cookies,n.cookies,"name","value"),t.length){t=t.multidimSort(["group","name"]);var p=new WaspUI.SidebarPane(a.title+" (cookies)","friendly-"+a.id+"-cookies",!0);p.addPropertiesSectionsFromArray(t,"group","name","value"),i.addPane(p)}var m=new WaspUI.SidebarPane("Request Properties","request",!0);if(i.addPane(m),s){var f=WaspUI.scriptinfo.get(s);if(f){var g=m.addPropertiesSection("Tag Details",!1);g.addProperty("Location",f.location),g.addProperty("Async",f.async)}}if(n.queryString.length){var v=m.addPropertiesSection("GET vars",!0);v.addPropertiesFromArray(n.queryString,"name","value")}if(n.postData){var b=m.addPropertiesSection("POST vars",!0);n.postData.params?b.addPropertiesFromArray(n.postData.params,"name","value"):b.addPropertiesFromQuerystring(n.postData.text)}var _=m.addPropertiesSection("COOKIE vars",!0);_.addPropertiesFromArray(n.cookies,"name","value");var y=m.addPropertiesSection("HEADER vars",!0);y.addPropertiesFromArray(n.headers,"name","value",!1,!0);for(var I=n.url.parseUrl(),S=[I.protocol+"//"+I.hostname],E=I.pathname.split("/"),c=0,d=E.length;++c<d;)d-c>=2&&"http"===E[c].substr(0,4)?S.push("/"+E[c]+"//"+E[c+=2]):S.push("/"+E[c]);I.hash&&S.push(I.hash);var W=m.addPropertiesSection("URL path",!0);W.addSimplePropertiesFromArray(S)},WaspUI.events.buildResponseProperties=function(e){var t=e.response,n=WaspUI.sidebarPanel.detailStack,s=new WaspUI.SidebarPane("Response Properties","response",!1);n.addPane(s);var i=s.addPropertiesSection("Details",!1);i.addProperty("Mime Type",t.content.mimeType),i.addProperty("Status",t.status+" "+t.statusText);var r=s.addPropertiesSection("COOKIE vars",!0);r.addPropertiesFromArray(t.cookies,"name","value");for(var a=s.addPropertiesSection("HEADER vars",!0),o=-1,l=t.headers.length;++o<l;){var c=t.headers[o];a.addProperty(c.name,c.value,!1,!0),"location"==c.name.toLowerCase()&&i.addProperty("Redirects To",c.value)}},WaspUI.events.buildContentSection=function(e){var t=e&&e.harContent,n=WaspUI.sidebarPanel.contentStack,s=new WaspUI.SidebarPane("Content","content",!0);if(n.addPane(s),t){var i=e.getAttribute("data-url")||e.harObject.request.url;s.addEmptySection('<a href="'+i+'" target="_blank">'+i+"</a>"),s.addCodeViewSection(t)}else s.addEmptySection("No content or binary file format")},WaspUI.events.contextMenuFunctions={hideNodeDialog:function(){new WaspUI.BypassNodeDialog(this,WaspUI.BYPASS_TYPE_HIDE,this.dataset.url,!1)},hideDomainDialog:function(){new WaspUI.BypassNodeDialog(this,WaspUI.BYPASS_TYPE_HIDE,this.dataset.domain,!0)},blockNodeDialog:function(){new WaspUI.BypassNodeDialog(this,WaspUI.BYPASS_TYPE_BLOCK,this.dataset.url,!1)},overrideNodeDialog:function(){new WaspUI.BypassNodeDialog(this,WaspUI.BYPASS_TYPE_OVERRIDE,this.dataset.url,!1)},manageBypassDialog:function(){new WaspUI.ManageBypassesDialog}},WaspUI.events.onRequestNodeContextMenu=function(e){var t=new WebInspector.ContextMenu(e),n=0===this.id.indexOf("tags")?"tag":"script",s=WaspUI.events.contextMenuFunctions;t.appendItem("Hide this "+n,s.hideNodeDialog.bind(this)),this.classList.contains("blocked")||this.classList.contains("override")||(t.appendItem("Block this "+n,s.blockNodeDialog.bind(this)),"script"===n&&t.appendItem("Override this script",s.overrideNodeDialog.bind(this))),t.appendSeparator(),t.appendItem("Hide this domain",s.hideDomainDialog.bind(this)),t.appendItem("Manage bypasses",s.manageBypassDialog.bind(this)),t.show()},WaspUI.events.onPageInfoClick=function(){this.showConnections(!0),WaspUI.events.selectedNode&&WaspUI.events.selectedNode.classList.remove("selected"),WaspUI.events.selectedNode=this,this.classList.add("selected");var e=this.harObject;ga("send","event","node","page",e.request.url.match(/https*:\/\/([^\/]+)/)[1]);var t=WaspUI.sidebarPanel.detailStack;t.clearPanes(),WaspUI.events.buildGeneralProperties(e),WaspUI.events.buildRequestProperties(e),WaspUI.events.buildResponseProperties(e),t=WaspUI.sidebarPanel.contentStack,t.clearPanes(),WaspUI.events.buildContentSection(this)},WaspUI.events.onTagNodeClick=function(){this.showConnections(!0),WaspUI.events.selectedNode&&WaspUI.events.selectedNode.classList.remove("selected"),WaspUI.events.selectedNode=this,this.classList.add("selected");var e=this.harObject;ga("send","event","node","tag",e.request.url.match(/https*:\/\/([^\/]+)/)[1]);var t=WaspUI.sidebarPanel.detailStack;t.clearPanes(),WaspUI.events.buildRequestProperties(e),WaspUI.events.buildResponseProperties(e),t=WaspUI.sidebarPanel.contentStack,t.clearPanes(),WaspUI.events.buildContentSection(this)},WaspUI.events.onScriptNodeClick=function(){this.showConnections(!0),WaspUI.events.selectedNode&&WaspUI.events.selectedNode.classList.remove("selected"),WaspUI.events.selectedNode=this,this.classList.add("selected");var e=this.harObject;ga("send","event","node","script",e.request.url.match(/https*:\/\/([^\/]+)/)[1]);var t=WaspUI.sidebarPanel.detailStack;t.clearPanes(),WaspUI.events.buildRequestProperties(e),WaspUI.events.buildResponseProperties(e),t=WaspUI.sidebarPanel.contentStack,t.clearPanes(),WaspUI.events.buildContentSection(this)},WaspUI.events.onBlockedNodeContextMenu=function(e){var t=new WebInspector.ContextMenu(e),n=WaspUI.events.contextMenuFunctions;t.appendItem("Hide this item",n.hideNodeDialog.bind(this)),t.appendItem("Hide this domain",n.hideDomainDialog.bind(this)),t.appendItem("Manage bypasses",n.manageBypassDialog.bind(this)),t.show()},WaspUI.events.onBlockedNodeClick=function(){var e=this.request;
this.showConnections(!0),WaspUI.events.selectedNode&&WaspUI.events.selectedNode.classList.remove("selected"),WaspUI.events.selectedNode=this,this.classList.add("selected");var t=WaspUI.sidebarPanel.detailStack;t.clearPanes();var n=new WaspUI.SidebarPane("Request Properties","request",!0);t.addPane(n);var s=n.addPropertiesSection("GET vars",!0);s.addPropertiesFromQuerystring(e.search);for(var i=[e.protocol+"//"+e.hostname],r=e.pathname.split("/"),a=0,o=r.length;++a<o;)o-a>=2&&"http"===r[a].substr(0,4)?i.push("/"+r[a]+"//"+r[a+=2]):i.push("/"+r[a]);e.hash&&i.push(e.hash);var l=n.addPropertiesSection("URL path",!0);l.addSimplePropertiesFromArray(i),t=WaspUI.sidebarPanel.contentStack,t.clearPanes(),WaspUI.events.buildContentSection(!1)},WaspUI.events.onDataLayerNodeClick=function(){this.showConnections(!0),WaspUI.events.selectedNode&&WaspUI.events.selectedNode.classList.remove("selected"),WaspUI.events.selectedNode=this,this.classList.add("selected");var e=WaspUI.sidebarPanel.detailStack;e.clearPanes();var t=new WaspUI.SidebarPane("dataLayer Item","datalayer",!0);e.addPane(t);var n=t.addPropertiesSection("Details",!0);n.addPropertiesFromArray(this.item,"name","value")},WaspUI.ContentChecker=function(e,t,n,s,i){this.r=e,this.root=t,this.event=n,this.altRoot=s,this.altEvent=i,this.i=WaspUI.ContentChecker.idgen++,WaspUI.ContentChecker.instances[this.i]=this},WaspUI.ContentChecker.instances={},WaspUI.ContentChecker.idgen=0,WaspUI.checkMainPageContent=function(e){var t=(this.r.request,this.root);t.addEventListener("click",this.event.bind(t)),t.harObject=this.r,t.harContent=e;var n=e.match(/<(?:title)[^>]*>([^<]+)/);n&&(this.r.title=n[1]);var s=e.match(/<(?:meta|link)[^>]*>/g);if(s){var i=document.createElement("head");i.insertAdjacentHTML("afterbegin",s.join(""));var n=i.querySelector('meta[name="description"]');n&&(this.r.description=t.description=n.getAttribute("content"));var n=i.querySelector('meta[name="keywords"]');if(n&&(this.r.keywords=t.keywords=n.getAttribute("content")),n=i.querySelector('link[rel*="icon"]'))if(t.favicon={},t.favicon=new Image,t.favicon.onerror=WaspUI.addDefaultFavicon.bind(this),t.favicon.onload=WaspUI.addNodeFavicon.bind(this),/^http/.test(n.getAttribute("href")))t.favicon.src=n.getAttribute("href");else{var r=document.createElement("A");r.href=t.harObject.request.url,t.favicon.src=r.origin+n.getAttribute("href")}else WaspUI.addDefaultFavicon.call(this)}this.event.call(t),delete WaspUI.ContentChecker.instances[this.i]},WaspUI.checkHTMLContent=function(e){var t=this.r.request;if(e){var n=e.match(/<(script|img|iframe)[^>]*>/g)||[];if(n.length){for(var s=n.length;s--;){var i=!!(n[s].match(/^<script/)||[]).length,r=(n[s].match(/src="([^"]+)"/i)||["",""])[1];if(r){var a=WaspUI.connections.add(t.url,r.parseUrl(t.url));i&&WaspUI.scriptinfo.set(!0,a.to,"IFRAME",!!n[s].match(/async/))}}var o=WaspUI.createRequestNode(t.url.parseUrl(),this.root,this.event);o.classList.add("html"),o.harObject=this.r,o.harContent=e,o.classList.add("status"+this.r.response.status),WaspUI.makeNodeFriendly(o)}else{var o=WaspUI.createRequestNode(t.url.parseUrl(),this.altRoot,this.altEvent);o.harObject=this.r,o.harContent=e,o.classList.add("other"),o.classList.add("status"+this.r.response.status),WaspUI.makeNodeFriendly(o)}}else{var o=WaspUI.createRequestNode(t.url.parseUrl(),this.altRoot,this.altEvent);o.harObject=this.r,o.classList.add("empty-html"),o.classList.add("status"+this.r.response.status),WaspUI.makeNodeFriendly(o)}delete WaspUI.ContentChecker.instances[this.i]},WaspUI.checkTextContent=function(e,t){var n=this.r.request,s=this.r.response.content.mimeType;if(e)if(s.match(/(?:javascript|json)/)||e.match(/function[^(]*\([^)]*\)/)){WaspUI.scriptinfo.set(!1,n.url.split(/(\?|#)/)[0],"INJECT","unknown");var i=WaspUI.createRequestNode(n.url.parseUrl(),this.root,this.event);i.classList.add(),i.harObject=this.r,i.harContent=e,i.classList.add("status"+this.r.response.status),WaspUI.makeNodeFriendly(i)}else if(e.match(/<(html|head|body)[^>]*>/))WaspUI.checkHTMLContent.call(this,e,t);else{var i=WaspUI.createRequestNode(n.url.parseUrl(),this.altRoot,this.altEvent);i.harObject=this.r,i.harContent=e,i.classList.add("other"),i.classList.add("status"+this.r.response.status),WaspUI.makeNodeFriendly(i)}else{var i=WaspUI.createRequestNode(n.url.parseUrl(),this.altRoot,this.altEvent);i.harObject=this.r,i.classList.add("empty-text"),i.classList.add("status"+this.r.response.status),WaspUI.makeNodeFriendly(i)}delete WaspUI.ContentChecker.instances[this.i]},WaspUI.insertRequestNode=function(e){var t=WaspUI.mainPanel.rootnode;if(t){var n=t.tags,s=t.scripts,i=e.request,r=e.response,a=r.content.mimeType;if(i.url==t.pageInfo.url&&!t.pageInfo.harObject)return e.getContent(WaspUI.checkMainPageContent.bind(new WaspUI.ContentChecker(e,t.pageInfo,WaspUI.events.onPageInfoClick))),void 0;var o=t.pageInfo.url.parseUrl().host,i=e.request,r=e.response,a=r.content.mimeType,l=i.url.parseUrl(),c=void 0,d=Number(r.status).toString();if(d.match(/30[12378]/)){for(var h=-1,p=r.headers.length;++h<p;){var u=r.headers[h];"location"==u.name.toLowerCase()&&WaspUI.connections.add(l.href,u.value)}c=WaspUI.createRequestNode(l,n,WaspUI.events.onTagNodeClick),c.classList.add("redirect")}else/(?:javascript|json)/.test(a)?s.querySelector('li[data-url="'+l.href+'"]')||e.getContent(WaspUI.checkTextContent.bind(new WaspUI.ContentChecker(e,s,WaspUI.events.onScriptNodeClick,n,WaspUI.events.onTagNodeClick))):/html/.test(a)?404!=Number(r.status)&&e.getContent(WaspUI.checkHTMLContent.bind(new WaspUI.ContentChecker(e,s,WaspUI.events.onScriptNodeClick,n,WaspUI.events.onTagNodeClick))):!/(css|javascript)/.test(a)&&l.host!==o&&("GET"===i.method&&i.queryString.length||"POST"===i.method||i.cookies.length)&&(/image/.test(a)?c=WaspUI.createRequestNode(l,n,WaspUI.events.onTagNodeClick):e.getContent(WaspUI.checkTextContent.bind(new WaspUI.ContentChecker(e,s,WaspUI.events.onScriptNodeClick,n,WaspUI.events.onTagNodeClick))));c&&(c.harObject=e,c.classList.add("status"+r.status),WaspUI.makeNodeFriendly(c))}},WaspUI.insertBlockedNode=function(e){e=e.parseUrl();var t=WaspUI.mainPanel.rootnode;t.blocked||(t.blocked=t.addBranch("blocked-"+WaspUI.mainPanel.currentContent.handle,"Blocked",!0,t.tags));var n=WaspUI.createRequestNode(e,t.blocked,WaspUI.events.onBlockedNodeClick,WaspUI.events.onBlockedNodeContextMenu);n.request=e},WaspUI.insertOverrideNode=function(e){e=e.parseUrl();var t=WaspUI.mainPanel.rootnode,n=WaspUI.createRequestNode(e,t.scripts,WaspUI.events.onBlockedNodeClick,WaspUI.events.onBlockedNodeContextMenu);n.classList.add("override"),n.request=e},WaspUI.insertDataLayerNode=function(e,t){var n=WaspUI.mainPanel.rootnode,s=!1;n.datalayer||(n.datalayer=n.addBranch("datalayer-"+WaspUI.mainPanel.currentContent.handle,t,!1,n.blocked||n.tags),"Marketer"===WaspUI.displayType&&WaspUI.hideTreeNode(n.datalayer,"tree","datalayer"),s=!0);for(var t="item",i=e.length;i--;)if(t=e[i].name,"event"==e[i].name){t=e[i].value;break}var r=n.datalayer.addBranch(Date.now(),t,!0);s&&r.controller.uncheck(),r.addEventListener("click",WaspUI.events.onDataLayerNodeClick.bind(r),!1),r.item=e},WaspUI.messages.addListener("url-override",function(e){WaspUI.insertOverrideNode(e.overrideCall,e.method,e.requestBody),WaspUI.connections.add(e.overrideCall,e["with"])}),WaspUI.messages.addListener("url-block",function(e){WaspUI.insertBlockedNode(e.blockedCall,e.method,e.requestBody)}),WaspUI.messages.addListener("datalayer",function(e){for(var t=-1,n=e.items.length;++t<n;)WaspUI.insertDataLayerNode(e.items[t],e.for)}),WaspUI.messages.addListener("script-info",function(e){for(var t=e["script-info"],n=t.length;n--;){var s=t[n];WaspUI.scriptinfo.set(!0,s.src,s.location,s.async)}}),WaspUI.buildUI=function(e){WaspUI.displayType=localStorage.userType,WaspUI.viewController||WaspUI.initiatePanel(),WaspUI.browserTab!==chrome.devtools.inspectedWindow.tabId&&(WaspUI.messages.port.postMessage({"msg-type":"tab-tracking",stopTabTracking:WaspUI.browserTab}),WaspUI.browserTab=chrome.devtools.inspectedWindow.tabId),WaspUI.messages.port.postMessage({"msg-type":"tab-tracking",startTabTracking:WaspUI.browserTab});var t=WaspUI.mainPanel.getNewContentPane(e),n=t.element;if(wtree=WaspUI.mainPanel.rootnode=n.querySelector(".tree"))wtree.prune();else{for(;n.firstChild;)n.removeChild(n.firstChild);WaspUI.mainPanel.rootnode=wtree=WaspUI.addTree(n)}t.pageNode=wtree.pageInfo=wtree.addBranch("page-info-"+t.handle,"Page Info"),wtree.pageInfo.url=e.split("#")[0],wtree.tags=wtree.addBranch("tags-"+t.handle,"Tags",!0),wtree.scripts=wtree.addBranch("scripts-"+t.handle,"Scripts",!1)},chrome.devtools.network.onNavigated.addListener(WaspUI.buildUI),chrome.devtools.network.onRequestFinished.addListener(WaspUI.insertRequestNode),document.onreadystatechange=function(){if("interactive"==document.readyState){if(ga("send","pageview",{page:"/panel.html",title:"Panel"}),document.querySelector("#reload-button").onclick=function(){chrome.devtools.inspectedWindow.reload()},WaspUI.FATAL_ERROR){var e=new WebInspector.GlassPane,t=document.createElement("div");if(t.className="fatal",t.innerText=WaspUI.FATAL_ERROR.title,WaspUI.FATAL_ERROR.fix){t.appendChild(document.createElement("br"));var n=document.createElement("a");n.href=WaspUI.FATAL_ERROR.fix,n.innerText="Visit the WASP knowledge base to solve this issue.",n.onclick=function(){return WaspUI.messages.port.postMessage({"msg-type":"open-tab",uri:this.href}),!1},t.appendChild(n)}return e.element.appendChild(t),void 0}var s="";localStorage.panelOption&&localStorage.panelOption.length&&(s="&"+localStorage.panelOption,localStorage.panelOption=""),loadXHR("https://webanalyticssolutionprofiler.com/panel?v="+chrome.runtime.getManifest().version+s,!0,function(e){document.querySelector("#default-msg").innerHTML=e,document.querySelector("#inner-reload-button").onclick=function(){chrome.devtools.inspectedWindow.reload()}})}};