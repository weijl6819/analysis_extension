var Chron=function(){function n(i,a){return this.constructor!==n?t||new n(i,a):t?t:(t=this,this.fps(i||25),e.running=!a,void 0)}var t,e={},i=n.prototype;return e.current=[],e.pending=[],e.doing={},e.funcs=[],e.handles=[],e.handleGen=0,e.active=!1,e.ticking=!1,e.running=null,e.fps=null,e.wait=null,e.startTick=function(){e.running&&!e.ticking&&(e.ticking=!0,e.interval=window.setTimeout(e.tick,e.wait))},e.tick=function(){if(!e.running)return e.ticking=!1,void 0;var n,t,i,a,c,r,u=e.current,s=e.pending,h=e.funcs,l=e.handles,f=e.doing;for(e.active=!0,n=Date.now(),t=n+e.wait;t>n&&u.length;n=Date.now())i=u.shift(),a=f[i],a&&(n<a.wait?s.push(i):(r=a.func(),a.repeat--?(a.wait=a.interval+t,s.push(i)):a.check&&r!==a.checkVal?(a.repeat=0,s.push(i)):(c=h.indexOf(a.func),h.splice(c,1),l.splice(c,1),delete f[i])));e.current=u=u.concat(s),e.pending=[],e.active=!1,u.length?e.interval=window.setTimeout(e.tick,Date.now()-t):e.ticking=!1},i.fps=function(n){return n&&(e.fps=Math.max(1,Math.min(60,isNaN(n)?25:n)),e.wait=1e3/e.fps>>0),e.fps},i.length=function(){return _funcs.length},i.running=function(){return _running},i.do=function(n,t,i,a){var c=e.funcs.indexOf(n),r=e.handles[c],u=isNaN(t)?0:Math.max(0,t),s=isNaN(i)?0:Math.max(0,i),h=isNaN(a)?0:Math.max(0,a);-1===c&&(c=e.funcs.length,r=++e.handleGen);var l={handle:r,wait:u+Date.now(),func:n,check:!1,repeat:s,interval:h};return e.funcs[c]=n,e.handles[c]=r,e.doing[r]=l,e.active?e.pending.push(r):e.current.push(r),e.startTick(),r},i.doUntil=function(n,t,i,a){var c=e.funcs.indexOf(n),r=e.handles[c],u=isNaN(i)?0:Math.max(0,i),s=isNaN(a)?0:Math.max(0,a);-1===c&&(c=e.funcs.length,r=++e.handleGen);var h={handle:r,wait:u+Date.now(),func:n,check:!0,checkVal:t,repeat:0,interval:s};return e.funcs[c]=n,e.handles[c]=r,e.doing[r]=h,e.active?e.pending.push(r):e.current.push(r),e.startTick(),r},i.getHandle=function(n){return e.handles[e.funcs.indexOf(n)]||null},i.clear=function(n){var t;!isNaN(n)&&(t=e.handles.indexOf(n))>-1&&(e.handles.splice(t,1),e.funcs.splice(t,1),delete e.doing[n])},i.stop=function(){e.running=!1},i.start=function(){e.running=!0,e.startTick()},n}();